webpackJsonp([1],{"+cgv":function(e,t){},"2qce":function(e,t){},"3f40":function(e,t){},"4dvx":function(e,t){},"4qOc":function(e,t){},"55QM":function(e,t){},"5UNP":function(e,t){},"5i3/":function(e,t){},"7ltE":function(e,t){},"7o1t":function(e,t){},"85uS":function(e,t){},"8bd0":function(e,t){},BCtq:function(e,t){},Dcuy:function(e,t){},Fr8O:function(e,t){},Jylj:function(e,t){},NHnr:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=a("7+uW"),r={name:"App",provide:function(){return{reload:this.reload}},data:function(){return{isRouterAlive:!0}},methods:{reload:function(){var e=this;console.log("reload"),this.isRouterAlive=!1,this.$nextTick(function(){e.isRouterAlive=!0})}}},o={render:function(){var e=this.$createElement,t=this._self._c||e;return this.isRouterAlive?t("div",{attrs:{id:"app"}},[t("keep-alive",[this.$route.meta.keepAlive?t("router-view"):this._e()],1),this._v(" "),this.$route.meta.keepAlive?this._e():t("router-view")],1):this._e()},staticRenderFns:[]};var i=a("VU/8")(r,o,!1,function(e){a("vyVH")},null,null).exports,n=a("/ocq"),s=a("mtWM"),c="http://10.81.19.208:8888",u={name:"Login",data:function(){return{params:{userName:"",password:"",roleId:"1"}}},methods:{getLogin:function(){var e=this,t=this.$loading({lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});this.params.roleId=parseInt(this.params.roleId),this.params.userName&&this.params.password&&this.params.roleId||(this.$message.error("请完善登录信息！"),t.close()),Object(s.a)({url:c+"/login/doLogin",method:"get",params:this.params}).then(function(a){t.close(),200==a.data.code?(t.close(),localStorage.setItem("roleId",e.params.roleId),localStorage.setItem("userName",e.params.userName),3==e.params.roleId?e.$router.push({path:"/technician/fault"}):1==e.params.roleId&"gongjuzu"!=e.params.userName?(e.$router.push({path:"/teams/faultcheck"}),console.log("banzu")):4==e.params.roleId?e.$router.push({path:"/manager/indexmaterial"}):1==e.params.roleId&"gongjuzu"==e.params.userName&&(e.$router.push({path:"/tool/metering"}),console.log("gjz"))):(e.$message.error("用户名/密码/角色错误"),t.close(),e.params.roleId="1")}).catch(function(a){console.log(a),t.close(),e.$message.error("请重新填写用户名/密码/角色 "),e.params.roleId="1"})}}},m={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"bg"},[a("div",{attrs:{id:"login_box"}},[a("h2",[e._v("LOGIN")]),e._v(" "),a("div",{attrs:{id:"form"}},[a("div",{attrs:{id:"input_box"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.params.userName,expression:"params.userName"}],attrs:{name:"username",id:"username",type:"text",autocomplete:"off",placeholder:"Username"},domProps:{value:e.params.userName},on:{input:function(t){t.target.composing||e.$set(e.params,"userName",t.target.value)}}})]),e._v(" "),a("div",{attrs:{id:"input_box"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.params.password,expression:"params.password"}],attrs:{name:"password",id:"password",type:"password",autocomplete:"off",placeholder:"Password"},domProps:{value:e.params.password},on:{input:function(t){t.target.composing||e.$set(e.params,"password",t.target.value)}}})]),e._v(" "),a("div",{attrs:{id:"input_box"}},[a("el-radio-group",{model:{value:e.params.roleId,callback:function(t){e.$set(e.params,"roleId",t)},expression:"params.roleId"}},[a("el-radio",{attrs:{label:"1"}},[e._v("班组")]),e._v(" "),a("el-radio",{attrs:{label:"3"}},[e._v("技术员")])],1)],1)]),e._v(" "),a("el-button",{attrs:{id:"sign_in"},on:{click:e.getLogin}},[e._v("登录")])],1)])},staticRenderFns:[]};var p=a("VU/8")(u,m,!1,function(e){a("jZWA")},"data-v-3f98835c",null).exports,d={name:"navcon",data:function(){return{userName:"",collapsed:!0,imgshow:a("gQKk"),imgsq:a("rWRm"),user:{},isDot:!1}},created:function(){this.userName=localStorage.getItem("userName")},methods:{exit:function(){var e=this;this.$confirm("退出登录, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){setTimeout(function(){localStorage.removeItem("roleId"),localStorage.removeItem("userName"),e.$router.push({path:"/"}),e.$message({type:"success",message:"已退出登录!"})},1e3)}).catch(function(){e.$message({type:"info",message:"已取消操作"})})},toggle:function(e){this.collapsed=!e},toRemind:function(){Date.now()>Date.parse("2023-11-10 00:00:00")&&(this.isDot=!0)}}},h={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-menu",{staticClass:"el-menu-demo",attrs:{router:!0,mode:"horizontal","background-color":"#334157","text-color":"#fff","active-text-color":"#fff"}},[a("el-submenu",{staticClass:"submenu",attrs:{index:"1"}},[a("template",{slot:"title"},[e._v("\n      "+e._s(e.userName)+"\n    ")]),e._v(" "),a("el-menu-item",{attrs:{index:e.$route.path},on:{click:function(t){return e.exit()}}},[e._v("退出")])],2),e._v(" "),a("el-menu-item",{attrs:{disabled:"",index:"2"}},[e._v("太原动车所")])],1)},staticRenderFns:[]};var g={name:"leftnav",data:function(){return{collapsed:!1,allmenu:[]}},created:function(){this.getRes()},methods:{getRes:function(){var e=localStorage.getItem("roleId"),t=localStorage.getItem("userName");if(1==e&"TEDS"!=t&"zhuanxiang"!=t&"shangbuzu"!=t&"gongjuzu"!=t)var a={success:!0,data:[{menuid:1,icon:"li-icon-xiangmuguanli",name:"班组查看",hasThird:null,url:null,menus:[{menuid:2,icon:"icon-cat-skuQuery",name:"班组列表",hasThird:"N",url:"teams/check",menus:null}]},{menuid:11,icon:"li-icon-xiangmuguanli",name:"故障查看",hasThird:null,url:null,menus:[{menuid:22,icon:"icon-cat-skuQuery",name:"故障列表",hasThird:"N",url:"teams/faultcheck",menus:null},{menuid:55,icon:"icon-cat-skuQuery",name:"车内装饰类故障列表",hasThird:"N",url:"teams/faultdecorationcheck",menus:null},{menuid:33,icon:"icon-cat-skuQuery",name:"高级修列表",hasThird:"N",url:"teams/seniorfaultcheck",menus:null},{menuid:44,icon:"icon-cat-skuQuery",name:"故障追踪列表",hasThird:"N",url:"teams/trackfaultcheck",menus:null}]}],msg:"success"};else if(1==e&"TEDS"==t)a={success:!0,data:[{menuid:1,icon:"li-icon-xiangmuguanli",name:"故障查看",hasThird:null,url:null,menus:[{menuid:2,icon:"icon-cat-skuQuery",name:"故障列表",hasThird:"N",url:"teams/faultcheck",menus:null},{menuid:3,icon:"icon-cat-skuQuery",name:"高级修列表",hasThird:"N",url:"teams/seniorfaultcheck",menus:null},{menuid:4,icon:"icon-cat-skuQuery",name:"故障追踪列表",hasThird:"N",url:"teams/trackfaultcheck",menus:null}]},{menuid:11,icon:"li-icon-xiangmuguanli",name:"TEDS故障管理",hasThird:null,url:null,menus:[{menuid:22,icon:"icon-cat-skuQuery",name:"故障列表",hasThird:"N",url:"tedsfault/fault",menus:null},{menuid:33,icon:"icon-cat-skuQuery",name:"高级修列表",hasThird:"N",url:"tedsfault/senior",menus:null}]}],msg:"success"};else if(3==e)a={success:!0,data:[{menuid:1,icon:"li-icon-xiangmuguanli",name:"班组管理",hasThird:null,url:null,menus:[{menuid:2,icon:"icon-cat-skuQuery",name:"班组列表",hasThird:"N",url:"teams/index",menus:null}]},{menuid:3,icon:"li-icon-xiangmuguanli",name:"故障管理",hasThird:null,url:null,menus:[{menuid:4,icon:"icon-cat-skuQuery",name:"故障库",hasThird:"N",url:"technician/faultcarnumber",menus:null},{menuid:5,icon:"icon-cat-skuQuery",name:"故障遗留列表",hasThird:"N",url:"technician/fault",menus:null},{menuid:8,icon:"icon-cat-skuQuery",name:"车内装饰类故障列表",hasThird:"N",url:"technician/faultdecoration",menus:null},{menuid:6,icon:"icon-cat-skuQuery",name:"高级修列表",hasThird:"N",url:"technician/senior",menus:null},{menuid:7,icon:"icon-cat-skuQuery",name:"故障追踪列表",hasThird:"N",url:"technician/track",menus:null}]},{menuid:11,icon:"li-icon-xiangmuguanli",name:"源头管理",hasThird:null,url:null,menus:[{menuid:22,icon:"icon-cat-skuQuery",name:"源头质量（四方）",hasThird:"N",url:"source/qualitysquare",menus:null},{menuid:33,icon:"icon-cat-skuQuery",name:"源头质量（长客）",hasThird:"N",url:"source/qualitylong",menus:null},{menuid:44,icon:"icon-cat-skuQuery",name:"源头质量（动集）",hasThird:"N",url:"source/qualityconcent",menus:null},{menuid:55,icon:"icon-cat-skuQuery",name:"技术改造（四方）",hasThird:"N",url:"source/technologysquare",menus:null},{menuid:66,icon:"icon-cat-skuQuery",name:"技术改造（长客）",hasThird:"N",url:"source/technologylong",menus:null},{menuid:77,icon:"icon-cat-skuQuery",name:"技术改造（动集）",hasThird:"N",url:"source/technologyconcent",menus:null}]}]};else if(4==e)a={success:!0,data:[{menuid:1,icon:"li-icon-xiangmuguanli",name:"材料管理",hasThird:null,url:null,menus:[{menuid:2,icon:"icon-cat-skuQuery",name:"材料签字",hasThird:"N",url:"manager/indexmaterial",menus:null}]}],msg:"success"};else if(1==e&"zhuanxiang"==t)a={success:!0,data:[{menuid:1,icon:"li-icon-xiangmuguanli",name:"专项管理",hasThird:null,url:null,menus:[{menuid:2,icon:"icon-cat-skuQuery",name:"专项提醒",hasThird:"N",url:"special/index",menus:null}]}]};else if(1==e&"shangbuzu"==t)a={success:!0,data:[{menuid:1,icon:"li-icon-xiangmuguanli",name:"班组查看",hasThird:null,url:null,menus:[{menuid:2,icon:"icon-cat-skuQuery",name:"班组列表",hasThird:"N",url:"teams/check",menus:null}]},{menuid:11,icon:"li-icon-xiangmuguanli",name:"故障查看",hasThird:null,url:null,menus:[{menuid:22,icon:"icon-cat-skuQuery",name:"故障列表",hasThird:"N",url:"teams/faultcheck",menus:null},{menuid:55,icon:"icon-cat-skuQuery",name:"车内装饰类故障列表",hasThird:"N",url:"teams/faultdecorationcheck",menus:null},{menuid:33,icon:"icon-cat-skuQuery",name:"高级修列表",hasThird:"N",url:"teams/seniorfaultcheck",menus:null},{menuid:44,icon:"icon-cat-skuQuery",name:"故障追踪列表",hasThird:"N",url:"teams/trackfaultcheck",menus:null}]}],msg:"success"};else if(1==e&"gongjuzu"==t)a={success:!0,data:[{menuid:1,icon:"li-icon-xiangmuguanli",name:"工具室台账",hasThird:null,url:null,menus:[{menuid:2,icon:"icon-cat-skuQuery",name:"计量用品台账",hasThird:"N",url:"tool/metering",menus:null},{menuid:3,icon:"icon-cat-skuQuery",name:"绝缘用品台账",hasThird:"N",url:"tool/insulation",menus:null},{menuid:4,icon:"icon-cat-skuQuery",name:"仪器用品台账",hasThird:"N",url:"tool/secure",menus:null}]}],msg:"success"};this.allmenu=a.data}}},f={render:function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("el-menu",{staticClass:"el-menu-vertical-demo",attrs:{collapse:e.collapsed,"collapse-transition":"",router:"","default-active":e.$route.path,router:!0,"unique-opened":!1,"background-color":"#334157","text-color":"#fff","active-text-color":"#ffd04b"}},[l("div",{staticClass:"logobox"},[l("img",{staticClass:"logoimg",attrs:{src:a("dLd/"),alt:""}})]),e._v(" "),e._l(e.allmenu,function(t){return l("el-submenu",{key:t.menuid,attrs:{index:t.name}},[l("template",{slot:"title"},[l("i",{staticClass:"iconfont",class:t.icon}),e._v(" "),l("span",[e._v(e._s(t.name))])]),e._v(" "),l("el-menu-item-group",e._l(t.menus,function(t){return l("el-menu-item",{key:t.menuid,attrs:{index:"/"+t.url}},[l("i",{staticClass:"iconfont",class:t.icon}),e._v(" "),l("span",[e._v(e._s(t.name))])])}),1)],2)})],2)},staticRenderFns:[]};var b={name:"index",data:function(){return{showclass:"asideshow",showtype:!1,isLogin:!0}},components:{navcon:a("VU/8")(d,h,!1,function(e){a("oudr")},"data-v-d91a98c0",null).exports,leftnav:a("VU/8")(g,f,!1,function(e){a("85uS")},null,null).exports},methods:{},created:function(){},beforeUpdate:function(){},beforeMount:function(){}},v={render:function(){var e=this.$createElement,t=this._self._c||e;return this.isLogin?t("el-container",{staticClass:"index-con"},[t("el-aside",{class:this.showclass},[t("leftnav")],1),this._v(" "),t("el-container",{staticClass:"main-con"},[t("el-header",{staticClass:"index-header"},[t("navcon")],1),this._v(" "),t("el-main",{attrs:{clss:"index-main"}},[t("router-view")],1)],1)],1):this._e()},staticRenderFns:[]};var _=a("VU/8")(b,v,!1,function(e){a("f/9h")},null,null).exports,y=a("mvHQ"),N=a.n(y),F=a("Dd8w"),w=a.n(F),k=a("bOdI"),x=a.n(k),$={name:"Pagination",props:["childMsg","total"],data:function(){return{pageparm:{pageNo:this.childMsg.pageNo,pageSize:this.childMsg.pageSize,total:this.childMsg.total}}},created:function(){},methods:{handleSizeChange:function(e){console.log("scroll"),this.pageparm.pageSize=e,document.querySelector(".el-main").scrollTo(0,0),this.$emit("callFather",this.pageparm)},handleCurrentChange:function(e){document.querySelector(".el-main").scrollTo(0,0),this.pageparm.pageNo=e,this.$emit("callFather",this.pageparm)}}},C={render:function(){var e=this,t=e.$createElement;return(e._self._c||t)("el-pagination",{attrs:{background:"","current-page":e.childMsg.pageNo,"page-sizes":[1e4],"page-size":e.childMsg.pageSize,layout:"total,sizes, prev, pager, next",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"update:currentPage":function(t){return e.$set(e.childMsg,"pageNo",t)},"update:current-page":function(t){return e.$set(e.childMsg,"pageNo",t)}}})},staticRenderFns:[]};var T=a("VU/8")($,C,!1,function(e){a("T93X")},null,null).exports,S=[{label:2217,value:2217},{label:2249,value:2249},{label:2250,value:2250},{label:2251,value:2251},{label:2256,value:2256},{label:2294,value:2294},{label:2295,value:2295},{label:2308,value:2308},{label:2309,value:2309},{label:2310,value:2310},{label:2311,value:2311},{label:2316,value:2316},{label:2317,value:2317},{label:2318,value:2318},{label:2319,value:2319},{label:2377,value:2377},{label:2378,value:2378},{label:2379,value:2379},{label:2380,value:2380},{label:2381,value:2381},{label:4122,value:4122},{label:4123,value:4123},{label:4124,value:4124},{label:4125,value:4125},{label:4126,value:4126},{label:4127,value:4127},{label:4128,value:4128},{label:4129,value:4129},{label:4130,value:4130},{label:4131,value:4131},{label:2641,value:2641},{label:2642,value:2642},{label:2648,value:2648},{label:2654,value:2654},{label:2663,value:2663},{label:2664,value:2664},{label:2668,value:2668},{label:2669,value:2669},{label:2674,value:2674},{label:2675,value:2675},{label:2676,value:2676},{label:2677,value:2677},{label:2678,value:2678},{label:2679,value:2679},{label:2689,value:2689},{label:2690,value:2690},{label:2721,value:2721},{label:2782,value:2782},{label:2798,value:2798},{label:2800,value:2800},{label:2814,value:2814},{label:2841,value:2841},{label:2845,value:2845},{label:2846,value:2846},{label:2847,value:2847},{label:2848,value:2848},{label:2861,value:2861},{label:2867,value:2867},{label:2879,value:2879},{label:2904,value:2904},{label:2908,value:2908},{label:2921,value:2921},{label:2922,value:2922},{label:2923,value:2923},{label:2924,value:2924},{label:2925,value:2925},{label:2931,value:2931},{label:2932,value:2932},{label:2933,value:2933},{label:2934,value:2934},{label:2935,value:2935},{label:2681,value:2681},{label:5025,value:5025},{label:5027,value:5027},{label:5031,value:5031},{label:5032,value:5032},{label:5034,value:5034},{label:5040,value:5040},{label:5058,value:5058},{label:5059,value:5059},{label:5060,value:5060},{label:5066,value:5066},{label:5075,value:5075},{label:5080,value:5080},{label:5083,value:5083},{label:5084,value:5084},{label:5085,value:5085},{label:5086,value:5086},{label:5087,value:5087},{label:5095,value:5095},{label:5098,value:5098},{label:5122,value:5122},{label:5133,value:5133},{label:5096,value:5096},{label:2048,value:2048},{label:2049,value:2049},{label:2050,value:2050}];function D(e,t){var a=this;Object(s.a)({method:"get",url:e,responseType:"blob"}).then(function(e){var a=new Blob([e.data],{type:e.headers["content-type"]}),l=document.createElement("a");l.href=window.URL.createObjectURL(a),l.download=t,l.click()}).catch(function(e){console.error("文件下载失败",e),a.$message.error("文件下载失败",e)})}var V={name:"Fault",components:{Pagination:T},data:function(){return{carNumbers:[],risks:[],carNumberList:S,baseURL:c,timeList:[],tableData:[],editFormVisible:!1,dialogTrackVisible:!1,title:"编辑",editForm:x()({code:"无",schedule:"无",respDepart:"无",review:"0"},"review",""),editTrackForm:{},risk:0,result:"",rules:{deliveryDate:[{required:!0,message:"请输入日期",trigger:"blur"}],carNumber:[{required:!0,message:"请输入车号",trigger:"blur"}],carBodyNumber:[{required:!0,message:"请输入车厢号",trigger:"blur"}],faultDescription:[{required:!0,message:"请输入故障描述",trigger:"blur"}],teamsGroups:[{required:!0,message:"请选择班组",trigger:"blur"}],funClass:[{required:!0,message:"请选择功能分类",trigger:"blur"}],handle:[{required:!0,message:"请选择处置分类",trigger:"blur"}],method:[{required:!0,message:"请输入处理方法",trigger:"blur"}],source:[{required:!0,message:"请输入故障来源",trigger:"blur"}],material:[{required:!0,message:"请选择到料情况",trigger:"blur"}]},trackRules:{trackPerson:[{required:!0,message:"请输入责任人",trigger:"blur"}],trackRequire:[{required:!0,message:"请输入追踪要求",trigger:"blur"}],feedback:[{required:!0,message:"请输入反馈实现",trigger:"blur"}]},pageparm:{pageNo:1,pageSize:1e4,result:"未处理",state:"0"},total:0,allList:[],loading:!0,teamsList:[],riskList:[{label:"⭐",value:1},{label:"⭐⭐",value:2},{label:"⭐⭐⭐",value:3}],id:0,uploadModalVisible:!1,fileList:[],dialogVisible:!1,attachmentList:[],previewDialogVisible:!1,previewFile:"",fault:{},deleteParams:{}}},created:function(){this.getFault(),this.getTeams()},computed:{indexMethod:function(){return(this.pageparm.pageNo-1)*this.pageparm.pageSize+1}},methods:{changeInput:function(e){this.$forceUpdate()},rowStyle:function(e){var t=e.row;return 1==t.dimension?{background:"antiquewhite"}:1==t.review?{background:"rgb(159 199 159)"}:void 0},changeUpdate:function(){this.$forceUpdate()},changeResultSelect:function(){"全部"==this.pageparm.result&&delete this.pageparm.result},resetForm:function(e){this.$refs[e].resetFields(),this.timeList=[],delete this.pageparm.startTime,delete this.pageparm.endTime,this.pageparm.carNumbers&&delete this.pageparm.carNumbers,this.carNumbers=[],this.pageparm.risks&&delete this.pageparm.risks,this.risks=[]},getTeams:function(){var e=this;Object(s.a)({url:c+"/teams/selectall"}).then(function(t){e.teamsList=t.data.data,e.loading=!1}).catch(function(e){console.log(e)})},search:function(){var e=this;this.carNumbers.length&&(this.pageparm.carNumbers=this.carNumbers),this.risks.length&&(this.pageparm.risks=this.risks),this.loading=!0,this.timeList.length&&(this.pageparm.startTime=this.getYMDHMS(new Date(this.timeList[0].toString())),this.pageparm.endTime=this.getYMDHMS(new Date(this.timeList[1].toString()))),this.pageparm.pageNo=1,Object(s.a)({method:"post",url:c+"/fault/screenfault",data:w()({},this.pageparm,{pageNo:this.pageparm.pageNo,pageSize:this.pageparm.pageSize})}).then(function(t){e.tableData=t.data.data.list,e.tableData=e.tableData.map(function(t){return t.deliveryDate=e.getYMDHMS(t.deliveryDate),t.risk="0"==t.risk?0:parseInt(t.risk),t.code="null"==t.code?"":t.code,t.schedule="null"==t.schedule?"":t.schedule,t.respDepart="null"==t.respDepart?"":t.respDepart,t.notes="null"==t.notes?"":t.notes,t}),e.total=t.data.data.size,e.loading=!1,e.$message.success("搜索成功")}).catch(function(t){e.initPage(),e.getFault(),e.$message.error("搜索失败")})},searchCurrent:function(){var e=this;this.carNumbers.length&&(this.pageparm.carNumbers=this.carNumbers),this.risks.length&&(this.pageparm.risks=this.risks),this.loading=!0,this.timeList.length&&(this.pageparm.startTime=this.getYMDHMS(new Date(this.timeList[0].toString())),this.pageparm.endTime=this.getYMDHMS(new Date(this.timeList[1].toString()))),this.pageparm.pageNo=1,this.pageparm.pageSize=1e4,Object(s.a)({method:"post",url:c+"/fault/screenfault",data:this.pageparm}).then(function(t){e.tableData=t.data.data.list,e.tableData=e.tableData.map(function(t){return t.deliveryDate=e.getYMDHMS(t.deliveryDate),t.risk="0"==t.risk?0:parseInt(t.risk),t.code="null"==t.code?"":t.code,t.schedule="null"==t.schedule?"":t.schedule,t.respDepart="null"==t.respDepart?"":t.respDepart,t.notes="null"==t.notes?"":t.notes,t}),e.total=t.data.data.size,e.loading=!1,e.$message.success("搜索成功")}).catch(function(t){e.initPage(),e.getFault(),e.$message.error("搜索失败")})},initPage:function(){this.pageparm={pageNo:1,pageSize:1e4,state:0,result:"未处理"}},getYMDHMS:function(e){var t=new Date(e);return t.getFullYear()+"-"+(t.getMonth()+1).toString().padStart(2,"0")+"-"+t.getDate().toString().padStart(2,"0")},exportExcel:function(){"全部"==this.pageparm.result&&delete this.pageparm.result,this.carNumbers.length&&(this.pageparm.carNumbers=this.carNumbers),this.timeList.length&&(this.pageparm.startTime=this.getYMDHMS(new Date(this.timeList[0].toString())),this.pageparm.endTime=this.getYMDHMS(new Date(this.timeList[1].toString()))),this.risks.length&&(this.pageparm.risks=this.risks);var e=c+"/fault/export?";for(var t in this.pageparm)this.pageparm[t]&&(e+=t+"="+this.pageparm[t]+"&");console.log(e),s.a.get(e).then(function(t){console.log(e),window.location.href=e})},callFather:function(e){this.pageparm.pageNo=e.pageNo,this.pageparm.pageSize=e.pageSize,this.searchCurrent(),document.querySelector(".el-main").scrollTo(0,0)},getFault:function(){var e=this;this.carNumbers.length&&(this.pageparm.carNumbers=this.carNumbers),Object(s.a)({method:"post",url:c+"/fault/screenfault",data:{result:"未处理",state:"0",pageNo:this.pageparm.pageNo,pageSize:this.pageparm.pageSize}}).then(function(t){e.tableData=t.data.data.list||[],e.tableData=e.tableData.map(function(t){return t.deliveryDate=e.getYMDHMS(t.deliveryDate),t.risk="0"==t.risk?parseInt(0):parseInt(t.risk),t.code="null"==t.code?"":t.code,t.schedule="null"==t.schedule?"":t.schedule,t.respDepart="null"==t.respDepart?"":t.respDepart,t.notes="null"==t.notes?"":t.notes,t}),e.total=t.data.data.size,e.loading=!1}).catch(function(e){console.log(e)})},deleteById:function(e){var t=this;this.$confirm("此操作将永久删除, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:c+"/fault/deletefaultid",params:{id:e.id}}).then(function(e){t.$message({message:"删除成功",type:"success"}),t.search()}).catch(function(e){console.log(e)})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},handleEdit:function(e,t){console.log(t),this.editFormVisible=!0,void 0!=t&&"undefined"!=t?(this.title="修改",this.editForm=t,"未处理"!=this.editForm.result&"长期跟踪"!=this.editForm.result?this.result="已处理":"未处理"==this.editForm.result?this.result="未处理":"长期跟踪"==this.editForm.result&&(this.result="长期跟踪"),this.risk=t.risk):(this.title="添加",this.editForm={review:"0",code:"无",schedule:"无",respDepart:"无",notes:"无"},this.result="")},changeResult:function(){this.editForm.result=""},handelFault:function(){var e=this;this.$refs.editForm.validate(function(t){if(!t)return console.log("提交失败"),!1;if("已处理"!=e.result&&(e.editForm.result=e.result),e.editForm.risk=e.risk,"添加"==e.title)e.editForm.result?(e.editForm.dimension="0",Object(s.a)({url:c+"/fault/insertfault",method:"post",data:e.editForm}).then(function(t){e.$message({message:e.title+"成功",type:"success"}),e.editFormVisible=!1,e.editForm={},e.risk=0,e.initPage(),e.search()}).catch(function(t){console.log(t),e.$message({message:e.title+"失败",type:"error"}),e.editFormVisible=!1,e.editForm={},e.risk=0,e.initPage(),e.search()})):e.$message.error("请选择处理结果");else{for(var a in e.editForm)!e.editForm[a]&"risk"!=a&&(e.editForm[a]="null");Object(s.a)({url:c+"/fault/updatefaultid",method:"post",data:e.editForm}).then(function(t){e.editFormVisible=!1,e.editForm={},e.risk=0,e.$message.success("修改成功")}).catch(function(t){console.log(t),e.$message.error("请重新提交")})}})},closeDialog:function(){this.editFormVisible=!1,this.editForm={},this.risk=0},handleUploadSuccess:function(e){this.uploadUrlPath=N()(e),this.loading.close()},handleBeforeUpload:function(){this.loading=this.$loading({lock:!0,text:"上传中",background:"rgba(0, 0, 0, 0.7)"})},handleUploadError:function(){this.$message({type:"error",message:"上传失败"}),this.loading.close()},handleRemove:function(e,t){console.log(e,t)},handlePreview:function(e){console.log(e)},handleExceed:function(e,t){this.$message.warning("当前限制选择文件个数，本次选择了 "+e.length+" 个文件，共选择了 "+(e.length+t.length)+" 个文件")},beforeRemove:function(e,t){return this.$confirm("确定移除 "+e.name+"？")},handleSuccess:function(){this.getFault(),this.$message.success("导入成功")},handleError:function(){this.getFault(),this.$message.error("导入格式错误，请修改后重新导入！")},resetRisk:function(){this.risk=0},changState:function(e,t){var a=this;this.$confirm("此操作将数据提交到高级修库, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:" "+c+"/fault/changestate",params:{id:e,state:1}}).then(function(e){a.$message.success("已转移到高级修库"),a.search()}).catch(function(e){a.$message.error("重新提交")})}).catch(function(){a.$message({type:"info",message:"已取消提交"})})},changStateDecoration:function(e,t){var a=this;this.$confirm("此操作将数据提交到车内装饰类故障列表, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:" "+c+"/fault/changestate",params:{id:e,state:4}}).then(function(e){a.$message.success("已转移到车内装饰类故障列表"),a.search()}).catch(function(e){a.$message.error("重新提交")})}).catch(function(){a.$message({type:"info",message:"已取消提交"})})},changeTrack:function(){var e=this;this.$refs.editTrackForm.validate(function(t){if(!t)return console.log("请输入责任人"),!1;e.$confirm("此操作将数据提交到故障追踪列表, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:" "+c+"/fault/changestate",params:{id:e.id,state:2,trackPerson:e.editTrackForm.trackPerson,trackRequire:e.editTrackForm.trackRequire,feedback:"请责任人填写"}}).then(function(t){e.$message.success("已转移到故障追踪列表"),e.search(),e.dialogTrackVisible=!1,e.editTrackForm={}}).catch(function(t){e.$message.error("请重新提交"),e.editTrackForm={}})}).catch(function(){e.$message({type:"info",message:"已取消提交"})})})},changeDimension:function(e,t){var a=this;this.$confirm("此操作将数据列为重点故障，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:" "+c+"/fault/changedimension",params:{id:e,dimension:t}}).then(function(e){a.$message.success("成功"),a.search()}).catch(function(e){a.$message.error("失败")})}).catch(function(){a.$message({type:"info",message:"已取消"})})},handleTrack:function(e){this.dialogTrackVisible=!0,this.id=e},handleClose:function(){this.editTrackForm={},this.dialogTrackVisible=!1},handleMethod:function(){"修改"==this.title&&(this.editForm.handle="")},showUploadModal:function(e){this.fault.id=e.id,this.uploadModalVisible=!0},beforeClose:function(e){e()},upload:function(){this.$refs.refName.clearFiles(),this.uploadModalVisible=!1},handleFileSuccess:function(e,t,a){200!==e.code?(this.$message.error(e.msg),this.$refs.refName.uploadFiles.splice(this.$refs.refName.uploadFiles.indexOf(t),1)):this.$message.success("上传成功")},handleFileError:function(e,t,a){this.$message.error("文件超出大小限制，上传失败，请联系管理员!"),this.$refs.refName.uploadFiles.splice(this.$refs.refName.uploadFiles.indexOf(t),1),this.$refs.refName.clearFiles()},showModal:function(e){var t=this;Object(s.a)({url:c+"/fault/fileList/"+e,method:"get"}).then(function(e){t.dialogVisible=!0,t.attachmentList=e.data.data||[]})},handleCloseFile:function(e){e()},downloadAttachment:function(e){console.log("下载附件",e),D(c+"/fault/download/"+e.faultFileMidId,e.fileName)},deleteAttachment:function(e){var t=this;console.log("删除附件",e),this.deleteParams={fileId:e.fileId,faultFileMidId:e.faultFileMidId},this.$confirm("点击后删除，是否确定？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:c+"/fault/deleteFile",method:"post",data:t.deleteParams}).then(function(a){console.log(a),200!==a.data.code?t.$message.error(a.data.msg):(t.$message.success("操作成功!"),t.showModal(e.faultId))}).catch(function(e){t.$message.error(e)})})},handleFileNameClick:function(e){var t=this;console.log("点击文件名",e),this.$confirm("点击后下载，是否确定？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:c+"/fault/getFileInfo/"+e.fileId,method:"get"}).then(function(a){console.log(a),200!==a.data.code&&(t.$message.error(a.data.msg),t.showModal(e.faultId)),D(c+"/fault/download/"+e.faultFileMidId,e.fileName)}).catch(function(e){t.$message.error(e)})})},handleSizeChange:function(e){this.pageparm.pageSize=e,this.getFault(),document.querySelector(".el-main").scrollTo(0,0),console.log("每页 "+e+" 条")},handleCurrentChange:function(e){this.pageparm.pageNo=e,this.getFault(),document.querySelector(".el-main").scrollTo(0,0),console.log("当前页: "+e)},goTeam:function(){this.$router.push({path:"/teams/index"})}}},L={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-upload",{staticClass:"upload-demo",attrs:{action:e.baseURL+"/fault/import","on-preview":e.handlePreview,"on-remove":e.handleRemove,"before-remove":e.beforeRemove,multiple:"","on-exceed":e.handleExceed,"on-success":e.handleSuccess,"on-error":e.handleError}},[a("el-button",{attrs:{size:"small",type:"warning",icon:"el-icon-star-on"}},[e._v("导入")])],1),e._v(" "),a("br"),a("br"),e._v(" "),a("el-form",{ref:"searchForm",staticClass:"user-search",attrs:{inline:!0,model:e.pageparm}},[a("el-form-item",{attrs:{label:"处理结果：",prop:"result"}},[a("el-select",{attrs:{placeholder:"请选择处理结果"},on:{change:e.changeResultSelect},model:{value:e.pageparm.result,callback:function(t){e.$set(e.pageparm,"result",t)},expression:"pageparm.result"}},[a("el-option",{attrs:{label:"全部",value:"全部"}}),e._v(" "),a("el-option",{attrs:{label:"未处理",value:"未处理"}}),e._v(" "),a("el-option",{attrs:{label:"已处理",value:"已处理"}}),e._v(" "),a("el-option",{attrs:{label:"长期跟踪",value:"长期跟踪"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"标注",prop:"dimension"}},[a("el-select",{attrs:{placeholder:"请选择"},on:{change:e.changeUpdate},model:{value:e.pageparm.dimension,callback:function(t){e.$set(e.pageparm,"dimension",t)},expression:"pageparm.dimension"}},[a("el-option",{attrs:{label:"非重点关注",value:"0"}}),e._v(" "),a("el-option",{attrs:{label:"重点关注",value:"1"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"到料",prop:"material"}},[a("el-select",{attrs:{placeholder:"请选择到料情况"},on:{change:function(t){return e.changeInput(t)}},model:{value:e.pageparm.material,callback:function(t){e.$set(e.pageparm,"material",t)},expression:"pageparm.material"}},[a("el-option",{attrs:{label:"无",value:"无"}}),e._v(" "),a("el-option",{attrs:{label:"否",value:"否"}}),e._v(" "),a("el-option",{attrs:{label:"是",value:"是"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"限制",prop:"review"}},[a("el-select",{attrs:{placeholder:"请选择"},on:{change:function(t){return e.changeInput(t)}},model:{value:e.pageparm.review,callback:function(t){e.$set(e.pageparm,"review",t)},expression:"pageparm.review"}},[a("el-option",{attrs:{label:"否",value:"0"}}),e._v(" "),a("el-option",{attrs:{label:"是",value:"1"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"车号",prop:"carNumber"}},[a("el-select",{attrs:{multiple:"",filterable:"",placeholder:"请选择车号"},on:{change:function(t){return e.changeInput(t)}},model:{value:e.carNumbers,callback:function(t){e.carNumbers=t},expression:"carNumbers"}},e._l(e.carNumberList,function(e){return a("el-option",{key:e.value,attrs:{label:e.value,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"车厢号",prop:"carBodyNumber"}},[a("el-input",{attrs:{size:"small",placeholder:"输入车厢号"},on:{input:function(t){return e.changeInput(t)}},model:{value:e.pageparm.carBodyNumber,callback:function(t){e.$set(e.pageparm,"carBodyNumber",t)},expression:"pageparm.carBodyNumber"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"交修日期"}},[a("el-col",{attrs:{span:11}},[a("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.timeList,callback:function(t){e.timeList=t},expression:"timeList"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"故障描述：",prop:"faultDescription"}},[a("el-input",{attrs:{size:"small",placeholder:"输入故障描述"},on:{input:function(t){return e.changeInput(t)}},model:{value:e.pageparm.faultDescription,callback:function(t){e.$set(e.pageparm,"faultDescription",t)},expression:"pageparm.faultDescription"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"故障来源：",prop:"source"}},[a("el-input",{attrs:{size:"small",placeholder:"输入故障来源"},on:{input:function(t){return e.changeInput(t)}},model:{value:e.pageparm.source,callback:function(t){e.$set(e.pageparm,"source",t)},expression:"pageparm.source"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"处理方法：",prop:"method"}},[a("el-input",{attrs:{size:"small",placeholder:"输入处理方法"},on:{input:function(t){return e.changeInput(t)}},model:{value:e.pageparm.method,callback:function(t){e.$set(e.pageparm,"method",t)},expression:"pageparm.method"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"处理班组",prop:"teamsGroups"}},[a("el-select",{attrs:{placeholder:"请选择处理班组"},on:{change:e.changeUpdate},model:{value:e.pageparm.teamsGroups,callback:function(t){e.$set(e.pageparm,"teamsGroups",t)},expression:"pageparm.teamsGroups"}},e._l(e.teamsList,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.name}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"功能分类",prop:"funClass"}},[a("el-select",{attrs:{placeholder:"请选择功能分类"},on:{change:e.changeUpdate},model:{value:e.pageparm.funClass,callback:function(t){e.$set(e.pageparm,"funClass",t)},expression:"pageparm.funClass"}},[a("el-option",{attrs:{label:"整车",value:"整车"}}),e._v(" "),a("el-option",{attrs:{label:"车体",value:"车体"}}),e._v(" "),a("el-option",{attrs:{label:"车端连接",value:"车端连接"}}),e._v(" "),a("el-option",{attrs:{label:"转向架及其辅助",value:"转向架及其辅助"}}),e._v(" "),a("el-option",{attrs:{label:"主供电",value:"主供电"}}),e._v(" "),a("el-option",{attrs:{label:"牵引",value:"牵引"}}),e._v(" "),a("el-option",{attrs:{label:"辅助电气",value:"辅助电气"}}),e._v(" "),a("el-option",{attrs:{label:"供风制动",value:"供风制动"}}),e._v(" "),a("el-option",{attrs:{label:"网络及辅助监控",value:"网络及辅助监控"}}),e._v(" "),a("el-option",{attrs:{label:"旅客信息",value:"旅客信息"}}),e._v(" "),a("el-option",{attrs:{label:"空调",value:"空调"}}),e._v(" "),a("el-option",{attrs:{label:"给排水卫生",value:"给排水卫生"}}),e._v(" "),a("el-option",{attrs:{label:"外门及车内设施",value:"外门及车内设施"}}),e._v(" "),a("el-option",{attrs:{label:"驾驶设施",value:"驾驶设施"}}),e._v(" "),a("el-option",{attrs:{label:"电务车载",value:"电务车载"}}),e._v(" "),a("el-option",{attrs:{label:"其他",value:"其他"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"处置分类",prop:"handle"}},[a("el-input",{attrs:{size:"small",placeholder:"输入处置分类"},on:{input:function(t){return e.changeInput(t)}},model:{value:e.pageparm.handle,callback:function(t){e.$set(e.pageparm,"handle",t)},expression:"pageparm.handle"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"风险等级",prop:"risk"}},[a("el-select",{attrs:{multiple:"",filterable:"",placeholder:"请选择风险等级"},on:{change:e.changeUpdate},model:{value:e.risks,callback:function(t){e.risks=t},expression:"risks"}},[a("el-option",{attrs:{label:"无风险",value:0}}),e._v(" "),e._l(e.riskList,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}},[a("span",{staticStyle:{float:"left"}},[a("el-rate",{attrs:{max:t.value,disabled:""},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}})],1)])})],2)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-search"},on:{click:function(t){return e.search()}}},[e._v("搜索")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-refresh-right"},on:{click:function(t){return e.resetForm("searchForm")}}},[e._v("重置")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-plus"},on:{click:function(t){return e.handleEdit()}}},[e._v("添加")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"warning",icon:"el-icon-star-off"},on:{click:function(t){return e.exportExcel()}}},[e._v("导出")])],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"",height:"600","row-style":e.rowStyle}},[a("el-table-column",{attrs:{type:"index",label:"序号",align:"center",width:"70",index:e.indexMethod,fixed:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"deliveryDate",label:"交修日期",width:"100",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"carNumber",label:"车号",width:"70",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"carBodyNumber",label:"车厢号",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"faultDescription",label:"故障描述",width:"180",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"teamsGroups",label:"处理班组",width:"100",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"result",label:"处理结果",width:"180",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s("null"==t.row.result?"":t.row.result)+"\n            ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"method",label:"处理方法",width:"200",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s("null"==t.row.method?"":t.row.method)+"\n            ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"material",label:"是否到料",width:"100",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"source",label:"故障来源",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s("null"==t.row.source?"":t.row.source)+"\n            ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"funClass",label:"功能分类",width:"130",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s("null"==t.row.funClass?"":t.row.funClass)+"\n            ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"risk",label:"风险等级",width:"180",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-rate",{attrs:{max:3,disabled:""},model:{value:t.row.risk,callback:function(a){e.$set(t.row,"risk",a)},expression:"scope.row.risk"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"handle",label:"处置分类",width:"150",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s("null"==t.row.handle?"":t.row.handle)+"\n            ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"notes",label:"备注",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s("null"==t.row.notes?"":t.row.notes)+"\n            ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"notes",label:"查看",align:"center",width:"130"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticClass:"icon-button",on:{click:function(a){return e.showModal(t.row.id)}}},[a("i",{staticClass:"el-icon-view"}),e._v("\n                    查看附件\n                ")])]}}])},[e._v(" "),a("el-dialog",{attrs:{title:"附件列表",visible:e.dialogVisible,width:"40%","before-close":e.handleCloseFile,"append-to-body":""},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.attachmentList}},[a("el-table-column",{attrs:{prop:"fileName",align:"center",label:"名称"},scopedSlots:e._u([{key:"default",fn:function(t){var l=t.row;return[a("el-link",{on:{click:function(t){return e.handleFileNameClick(l)}}},[e._v(e._s(l.fileName))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"fileType",align:"center",label:"类型"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var l=t.row;return[a("el-button",{attrs:{type:"primary",icon:"el-icon-download"},on:{click:function(t){return e.downloadAttachment(l)}}}),e._v(" "),a("el-button",{attrs:{type:"danger",icon:"el-icon-delete"},on:{click:function(t){return e.deleteAttachment(l)}}})]}}])})],1)],1)],1),e._v(" "),a("el-table-column",{attrs:{prop:"",label:"删除",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(a){return e.deleteById(t.row)}}})]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"",label:"附件",width:"120",align:"center",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticStyle:{"margin-top":"5px"}},[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(a){return e.showUploadModal(t.row)}}},[e._v("点击上传")])],1)]}}])}),e._v(" "),a("el-dialog",{attrs:{title:"文件上传",visible:e.uploadModalVisible,width:"650px","before-close":e.beforeClose,"append-to-body":"","show-close":!1,"close-on-click-modal":!1},on:{"update:visible":function(t){e.uploadModalVisible=t}}},[a("el-upload",{ref:"refName",staticClass:"uploadFile",attrs:{action:e.baseURL+"/fault/upload","on-success":e.handleFileSuccess,"on-error":e.handleFileError,"file-list":e.fileList,data:e.fault,drag:"",multiple:""}},[a("i",{staticClass:"el-icon-upload"}),e._v(" "),a("div",{staticClass:"el-upload__text"},[e._v("将文件拖到此处，或"),a("em",[e._v("点击上传")])])]),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.upload}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.upload}},[e._v("确 定")])],1)],1),e._v(" "),a("el-table-column",{attrs:{prop:"",label:"操作",width:"180",align:"center",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticStyle:{"margin-top":"5px"}},[a("el-button",{attrs:{type:"primary",icon:"el-icon-edit",circle:""},on:{click:function(a){return e.handleEdit(t.$index,t.row)}}}),e._v(" "),1==t.row.dimension?a("el-button",{attrs:{type:"warning",icon:"el-icon-warning",circle:""},on:{click:function(a){return e.changeDimension(t.row.id,0)}}}):a("el-button",{attrs:{icon:"el-icon-warning-outline",circle:""},on:{click:function(a){return e.changeDimension(t.row.id,1)}}})],1),e._v(" "),a("div",{staticStyle:{"margin-top":"5px"}},[a("el-tooltip",{attrs:{content:"移交高级修列表",placement:"top"}},[a("el-button",{attrs:{type:"success",icon:"el-icon-top",circle:""},on:{click:function(a){return e.changState(t.row.id,t.row.state)}}})],1),e._v(" "),a("el-tooltip",{attrs:{content:"移交追踪列表",placement:"top"}},[a("el-button",{attrs:{type:"success",icon:"el-icon-upload2",circle:""},on:{click:function(a){return e.handleTrack(t.row.id)}}})],1)],1),e._v(" "),a("div",{staticStyle:{"margin-top":"5px"}},[a("el-tooltip",{attrs:{content:"移交车内装饰类故障列表",placement:"top"}},[a("el-button",{attrs:{type:"success",icon:"el-icon-caret-top",circle:""},on:{click:function(a){return e.changStateDecoration(t.row.id)}}})],1)],1)]}}])})],1),e._v(" "),a("Pagination",{attrs:{"child-msg":e.pageparm,total:e.total},on:{callFather:e.callFather}}),e._v(" "),a("el-dialog",{attrs:{title:e.title,visible:e.editFormVisible,width:"50%","close-on-click-modal":!1},on:{"update:visible":function(t){e.editFormVisible=t}}},[a("el-form",{ref:"editForm",attrs:{"label-width":"120px",model:e.editForm,rules:e.rules}},[a("el-form-item",{attrs:{label:"交修日期",prop:"deliveryDate"}},[a("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",type:"date",placeholder:"选择日期"},model:{value:e.editForm.deliveryDate,callback:function(t){e.$set(e.editForm,"deliveryDate",t)},expression:"editForm.deliveryDate"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"车号",prop:"carNumber"}},[a("el-input",{attrs:{"auto-complete":"off",placeholder:"请输入车号"},model:{value:e.editForm.carNumber,callback:function(t){e.$set(e.editForm,"carNumber",t)},expression:"editForm.carNumber"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"车厢号",prop:"carBodyNumber"}},[a("el-input",{attrs:{min:1,label:"",placeholder:"请输入车箱号"},model:{value:e.editForm.carBodyNumber,callback:function(t){e.$set(e.editForm,"carBodyNumber",t)},expression:"editForm.carBodyNumber"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"故障描述",prop:"faultDescription"}},[a("el-input",{attrs:{type:"textarea",label:"",placeholder:"请输入故障描述"},model:{value:e.editForm.faultDescription,callback:function(t){e.$set(e.editForm,"faultDescription",t)},expression:"editForm.faultDescription"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"处理班组",prop:"teamsGroups"}},[a("el-select",{attrs:{placeholder:"请选择处理班组"},model:{value:e.editForm.teamsGroups,callback:function(t){e.$set(e.editForm,"teamsGroups",t)},expression:"editForm.teamsGroups"}},e._l(e.teamsList,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.name}})}),1),e._v(" "),a("el-button",{attrs:{type:"text",underline:!1},on:{click:function(t){return e.goTeam()}}},[e._v("添加班组")])],1),e._v(" "),a("el-form-item",{attrs:{label:"处理结果",prop:"result"}},[a("label",{attrs:{slot:"label"},slot:"label"},[a("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v(" 处理结果")]),e._v(" "),a("el-radio-group",{on:{change:e.changeResult},model:{value:e.result,callback:function(t){e.result=t},expression:"result"}},[a("el-radio",{staticClass:"radio",attrs:{label:"未处理"}},[e._v("未处理")]),e._v(" "),a("el-radio",{staticClass:"radio",attrs:{label:"长期跟踪"}},[e._v("长期跟踪")]),e._v(" "),a("el-radio",{staticClass:"radio",attrs:{label:"已处理"}},[e._v("已处理(填写处理时间)")])],1),e._v(" "),"已处理"==e.result?a("el-input",{attrs:{label:"",placeholder:"请输入处理结果",size:"mini"},model:{value:e.editForm.result,callback:function(t){e.$set(e.editForm,"result",t)},expression:"editForm.result"}}):e._e()],1),e._v(" "),a("el-form-item",{attrs:{label:"处置分类",prop:"handle"}},[a("el-select",{attrs:{placeholder:"请选择处置分类"},model:{value:e.editForm.handle,callback:function(t){e.$set(e.editForm,"handle",t)},expression:"editForm.handle"}},[a("el-option",{attrs:{label:"已处理",value:"已处理"}}),e._v(" "),a("el-option",{attrs:{label:"待处理",value:"待处理"}}),e._v(" "),a("el-option",{attrs:{label:"待一级修",value:"待一级修"}}),e._v(" "),a("el-option",{attrs:{label:"待二级修",value:"待二级修"}}),e._v(" "),a("el-option",{attrs:{label:"待扣修",value:"待扣修"}}),e._v(" "),a("el-option",{attrs:{label:"待高级修",value:"待高级修"}}),e._v(" "),a("el-option",{attrs:{label:"待集中处理",value:"待集中处理"}}),e._v(" "),a("el-option",{attrs:{label:"待售后处理",value:"待售后处理"}}),e._v(" "),a("el-option",{attrs:{label:"待料",value:"待料"}}),e._v(" "),a("el-option",{attrs:{label:"短期跟踪",value:"短期跟踪"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"功能分类",prop:"funClass"}},[a("el-select",{attrs:{placeholder:"请选择功能分类"},model:{value:e.editForm.funClass,callback:function(t){e.$set(e.editForm,"funClass",t)},expression:"editForm.funClass"}},[a("el-option",{attrs:{label:"整车",value:"整车"}}),e._v(" "),a("el-option",{attrs:{label:"车体",value:"车体"}}),e._v(" "),a("el-option",{attrs:{label:"车端连接",value:"车端连接"}}),e._v(" "),a("el-option",{attrs:{label:"转向架及其辅助",value:"转向架及其辅助"}}),e._v(" "),a("el-option",{attrs:{label:"主供电",value:"主供电"}}),e._v(" "),a("el-option",{attrs:{label:"牵引",value:"牵引"}}),e._v(" "),a("el-option",{attrs:{label:"辅助电气",value:"辅助电气"}}),e._v(" "),a("el-option",{attrs:{label:"供风制动",value:"供风制动"}}),e._v(" "),a("el-option",{attrs:{label:"网络及辅助监控",value:"网络及辅助监控"}}),e._v(" "),a("el-option",{attrs:{label:"旅客信息",value:"旅客信息"}}),e._v(" "),a("el-option",{attrs:{label:"空调",value:"空调"}}),e._v(" "),a("el-option",{attrs:{label:"给排水卫生",value:"给排水卫生"}}),e._v(" "),a("el-option",{attrs:{label:"外门及车内设施",value:"外门及车内设施"}}),e._v(" "),a("el-option",{attrs:{label:"驾驶设施",value:"驾驶设施"}}),e._v(" "),a("el-option",{attrs:{label:"电务车载",value:"电务车载"}}),e._v(" "),a("el-option",{attrs:{label:"其他",value:"其他"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"到料",prop:"material"}},[a("label",{attrs:{slot:"label"},slot:"label"},[e._v("到料 \n                    "),a("span",{staticStyle:{color:"red","font-size":"10px",float:"left",width:"300px","line-height":"0"}},[a("br"),e._v("（无需提料）    （待料）       （到料）\n                    ")])]),e._v(" "),a("el-radio-group",{on:{change:e.handleMethod},model:{value:e.editForm.material,callback:function(t){e.$set(e.editForm,"material",t)},expression:"editForm.material"}},[a("el-radio",{attrs:{label:"无",value:"无"}}),e._v(" "),a("el-radio",{attrs:{label:"否",value:"否"}}),e._v(" "),a("el-radio",{attrs:{label:"是",value:"是"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"处理方法",prop:"method"}},[a("el-input",{attrs:{type:"textarea",size:"small","auto-complete":"off",placeholder:"请输入遗留原因；处理方法；物料情况；跟踪周期。"},on:{input:e.handleMethod},model:{value:e.editForm.method,callback:function(t){e.$set(e.editForm,"method",t)},expression:"editForm.method"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"限制",prop:"review"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.editForm.review,callback:function(t){e.$set(e.editForm,"review",t)},expression:"editForm.review"}},[a("el-option",{attrs:{label:"否",value:"0"}}),e._v(" "),a("el-option",{attrs:{label:"是",value:"1"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{hidden:"",label:"物料编码",prop:"code"}},[a("el-input",{attrs:{size:"small","auto-complete":"off",placeholder:"请输入物料编码"},model:{value:e.editForm.code,callback:function(t){e.$set(e.editForm,"code",t)},expression:"editForm.code"}})],1),e._v(" "),a("el-form-item",{attrs:{hidden:"",label:"影响进度原因",prop:"schedule"}},[a("el-input",{attrs:{size:"small","auto-complete":"off",placeholder:"请输入影响进度原因"},model:{value:e.editForm.schedule,callback:function(t){e.$set(e.editForm,"schedule",t)},expression:"editForm.schedule"}})],1),e._v(" "),a("el-form-item",{attrs:{hidden:"",label:"责任部门（待料）",prop:"respDepart"}},[a("el-input",{attrs:{label:"",placeholder:"请输入责任部门（待料）"},model:{value:e.editForm.respDepart,callback:function(t){e.$set(e.editForm,"respDepart",t)},expression:"editForm.respDepart"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"故障来源",prop:"source"}},[a("el-input",{attrs:{label:"",placeholder:"请输入故障来源"},model:{value:e.editForm.source,callback:function(t){e.$set(e.editForm,"source",t)},expression:"editForm.source"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"风险等级",prop:"risk"}},[a("div",{staticClass:"rate_wrap"},[a("el-rate",{attrs:{max:3},model:{value:e.risk,callback:function(t){e.risk=t},expression:"risk"}}),e._v(" "),a("el-button",{attrs:{size:"mini",icon:"el-icon-refresh-right",circle:""},on:{click:e.resetRisk}})],1)]),e._v(" "),a("el-form-item",{attrs:{label:"备注",prop:"node"}},[a("el-input",{attrs:{size:"small","auto-complete":"off",placeholder:"备注"},model:{value:e.editForm.notes,callback:function(t){e.$set(e.editForm,"notes",t)},expression:"editForm.notes"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){return e.closeDialog("editForm")}}},[e._v("取消")]),e._v(" "),a("el-button",{staticClass:"title",attrs:{size:"small",type:"primary"},on:{click:function(t){return e.handelFault("editForm")}}},[e._v("保存")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"移交追踪列表",visible:e.dialogTrackVisible,width:"45%","before-close":e.handleClose},on:{"update:visible":function(t){e.dialogTrackVisible=t}}},[a("el-form",{ref:"editTrackForm",attrs:{"label-width":"120px",model:e.editTrackForm,rules:e.trackRules}},[a("el-form-item",{attrs:{label:"责任人",prop:"trackPerson"}},[a("el-input",{attrs:{"auto-complete":"off",placeholder:"请输入责任人"},model:{value:e.editTrackForm.trackPerson,callback:function(t){e.$set(e.editTrackForm,"trackPerson",t)},expression:"editTrackForm.trackPerson"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"追踪要求",prop:"trackRequire"}},[a("el-input",{attrs:{type:"textarea","auto-complete":"off",placeholder:"请输入追踪要求"},model:{value:e.editTrackForm.trackRequire,callback:function(t){e.$set(e.editTrackForm,"trackRequire",t)},expression:"editTrackForm.trackRequire"}})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogTrackVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.changeTrack}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var B=a("VU/8")(V,L,!1,function(e){a("dyro")},"data-v-424f1b52",null).exports,I={name:"Fault",components:{Pagination:T},data:function(){return{carNumbers:[],carNumberList:S,baseURL:c,timeList:[],tableData:[],editFormVisible:!1,title:"编辑",editForm:{risk:0,state:1},risk:0,result:"",rules:{deliveryDate:[{required:!0,message:"请输入日期",trigger:"blur"}],carNumber:[{required:!0,message:"请输入车号",trigger:"blur"}],carBodyNumber:[{required:!0,message:"请输入车厢号",trigger:"blur"}],faultDescription:[{required:!0,message:"请输入故障描述",trigger:"blur"}],teamsGroups:[{required:!0,message:"请选择班组",trigger:"blur"}],funClass:[{required:!0,message:"请选择功能分类",trigger:"blur"}],handle:[{required:!0,message:"请选择处置分类",trigger:"blur"}]},pageparm:{pageNo:1,pageSize:1e4,state:1},total:0,allList:[],headers:"'Content-Type': 'multipart/form-data'",loading:!0,teamsList:[],uploadModalVisible:!1,fileList:[],dialogVisible:!1,attachmentList:[],previewDialogVisible:!1,previewFile:"",fault:{},deleteParams:{}}},created:function(){this.getFault(),this.getTeams()},computed:{indexMethod:function(){return(this.pageparm.pageNo-1)*this.pageparm.pageSize+1}},methods:{changeInput:function(e){this.$forceUpdate()},resetForm:function(e){this.$refs[e].resetFields(),this.timeList=[],delete this.pageparm.startTime,delete this.pageparm.endTime,this.pageparm.carNumbers&&delete this.pageparm.carNumbers,this.carNumbers=[]},getTeams:function(){var e=this;Object(s.a)({url:c+"/teams/selectall"}).then(function(t){e.teamsList=t.data.data,e.loading=!1}).catch(function(e){console.log(e)})},search:function(){var e=this;this.carNumbers.length&&(this.pageparm.carNumbers=this.carNumbers),this.loading=!0,this.timeList.length&&(this.pageparm.startTime=this.getYMDHMS(new Date(this.timeList[0].toString())),this.pageparm.endTime=this.getYMDHMS(new Date(this.timeList[1].toString()))),this.pageparm.state=1,this.pageparm.pageNo=1,this.pageparm.pageSize=1e4,Object(s.a)({method:"post",url:c+"/fault/screenfault",data:this.pageparm}).then(function(t){e.$message.success("搜索成功"),e.tableData=t.data.data.list,e.tableData=e.tableData.map(function(t){return t.deliveryDate=e.getYMDHMS(t.deliveryDate),t.risk=(t.risk,0),t.code="null"==t.code?"":t.code,t.schedule="null"==t.schedule?"":t.schedule,t.respDepart="null"==t.respDepart?"":t.respDepart,t.notes="null"==t.notes?"":t.notes,t}),e.total=t.data.data.size,e.loading=!1}).catch(function(t){e.initPage(),e.getFault(),e.$message.error("搜索失败"),console.log(t)})},initPage:function(){this.pageparm={pageNo:1,pageSize:1e4}},getYMDHMS:function(e){var t=new Date(e);return t.getFullYear()+"-"+(t.getMonth()+1).toString().padStart(2,"0")+"-"+t.getDate().toString().padStart(2,"0")},exportExcel:function(){this.carNumbers.length&&(this.pageparm.carNumbers=this.carNumbers),this.timeList.length&&(this.pageparm.startTime=this.getYMDHMS(new Date(this.timeList[0].toString())),this.pageparm.endTime=this.getYMDHMS(new Date(this.timeList[1].toString())));var e=c+"/fault/exportsenior?";for(var t in this.pageparm)this.pageparm[t]&&(e+=t+"="+this.pageparm[t]+"&");s.a.get(e).then(function(t){console.log(e),window.location.href=e})},callFather:function(e){this.pageparm.pageNo=e.pageNo,this.pageparm.pageSize=e.pageSize,this.getFault()},getFault:function(){var e=this;this.carNumbers.length&&(this.pageparm.carNumbers=this.carNumbers),this.pageparm.state=1,Object(s.a)({url:c+"/fault/screenfault",method:"post",data:this.pageparm}).then(function(t){e.tableData=t.data.data.list,e.tableData=e.tableData.map(function(t){return t.deliveryDate=e.getYMDHMS(t.deliveryDate),t.risk=(t.risk,0),t.code="null"==t.code?"":t.code,t.schedule="null"==t.schedule?"":t.schedule,t.respDepart="null"==t.respDepart?"":t.respDepart,t.notes="null"==t.notes?"":t.notes,t}),e.total=t.data.data.size,e.loading=!1}).catch(function(e){console.log(e)})},deleteById:function(e){var t=this;this.$confirm("此操作将永久删除, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:c+"/fault/deletefaultid",params:{id:e.id}}).then(function(e){t.$message({message:"删除成功",type:"success"}),t.search()}).catch(function(e){console.log(e)})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},handleEdit:function(e,t){this.editFormVisible=!0,void 0!=t&&"undefined"!=t?(this.title="修改",this.editForm=t,"未处理"!=this.editForm.result&"长期跟踪"!=this.editForm.result?this.result="已处理":"未处理"==this.editForm.result?this.result="未处理":"长期跟踪"==this.editForm.result&&(this.result="长期跟踪")):(this.title="添加",this.editForm={state:1})},changeResult:function(){this.editForm.result=""},handelFault:function(){var e=this;this.$refs.editForm.validate(function(t){if(!t)return console.log("提交失败"),!1;if("已处理"!=e.result&&(e.editForm.result=e.result),e.editForm.risk=e.risk,"添加"==e.title)Object(s.a)({url:c+"/fault/insertfault",method:"post",data:e.editForm}).then(function(t){e.$message({message:e.title+"成功",type:"success"}),e.editFormVisible=!1,e.editForm={},e.initPage(),e.getFault()}).catch(function(t){console.log(t),e.$message({message:e.title+"失败",type:"error"}),e.editFormVisible=!1,e.editForm={},e.initPage(),e.getFault()});else{for(var a in e.editForm)!e.editForm[a]&"risk"!=a&&(e.editForm[a]="null");Object(s.a)({url:c+"/fault/updatefaultid",method:"post",data:e.editForm}).then(function(t){e.editFormVisible=!1,e.editForm={}}).catch(function(e){console.log(e)})}})},closeDialog:function(){this.editFormVisible=!1,this.editForm={},this.initPage(),this.getFault()},handleUploadSuccess:function(e){this.uploadUrlPath=N()(e),this.loading.close()},handleBeforeUpload:function(){this.loading=this.$loading({lock:!0,text:"上传中",background:"rgba(0, 0, 0, 0.7)"})},handleUploadError:function(){this.$message({type:"error",message:"上传失败"}),this.loading.close()},handleRemove:function(e,t){console.log(e,t)},handlePreview:function(e){console.log(e)},handleExceed:function(e,t){this.$message.warning("当前限制选择文件个数，本次选择了 "+e.length+" 个文件，共选择了 "+(e.length+t.length)+" 个文件")},beforeRemove:function(e,t){return this.$confirm("确定移除 "+e.name+"？")},handleSuccess:function(){this.getFault(),this.$message.success("导入成功")},handleError:function(){this.getFault(),this.$message.error("导入格式错误，请修改后重新导入！")},resetRisk:function(){this.risk=0},changState:function(e,t){var a=this;this.$confirm("此操作将数据提交到故障遗留列表, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:" "+c+"/fault/changestate",params:{id:e,state:0}}).then(function(e){a.$message.success("已转移到故障遗留库"),a.search()}).catch(function(e){a.$message.error("重新提交")})}).catch(function(){a.$message({type:"info",message:"已取消提交"})})},showModal:function(e){var t=this;Object(s.a)({url:c+"/fault/fileList/"+e,method:"get"}).then(function(e){console.log(e),t.dialogVisible=!0,t.attachmentList=e.data.data||[]})},handleCloseFile:function(e){e()},showUploadModal:function(e){this.fault.id=e.id,this.uploadModalVisible=!0},beforeClose:function(e){e()},upload:function(){this.$refs.refName.clearFiles(),this.uploadModalVisible=!1},handleFileSuccess:function(e,t,a){console.log("success"),200!==e.code?(this.$message.error(e.msg),this.$refs.refName.uploadFiles.splice(this.$refs.refName.uploadFiles.indexOf(t),1)):this.$message.success("上传成功")},handleFileError:function(e,t,a){this.$message.error("文件超出大小限制，上传失败，请联系管理员!"),this.$refs.refName.uploadFiles.splice(this.$refs.refName.uploadFiles.indexOf(t),1),this.$refs.refName.clearFiles()},downloadAttachment:function(e){console.log("下载附件",e),D(c+"/fault/download/"+e.faultFileMidId,e.fileName)},deleteAttachment:function(e){var t=this;console.log("删除附件",e),this.deleteParams={fileId:e.fileId,faultFileMidId:e.faultFileMidId},this.$confirm("点击后删除，是否确定？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:c+"/fault/deleteFile",method:"post",data:t.deleteParams}).then(function(a){console.log(a),200!==a.data.code?t.$message.error(a.data.msg):(t.$message.success("操作成功!"),t.showModal(e.faultId))}).catch(function(e){t.$message.error(e)})})},handleFileNameClick:function(e){var t=this;console.log("点击文件名",e),this.$confirm("点击后下载，是否确定？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:c+"/fault/getFileInfo/"+e.fileId,method:"get"}).then(function(a){console.log(a),200!==a.data.code&&(t.$message.error(a.data.msg),t.showModal(e.faultId)),D(c+"/fault/download/"+e.faultFileMidId,e.fileName)}).catch(function(e){t.$message.error(e)})})}}},z={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{ref:"searchForm",staticClass:"user-search",attrs:{inline:!0,model:e.pageparm}},[a("el-form-item",{attrs:{label:"处理结果：",prop:"result"}},[a("el-select",{attrs:{placeholder:"请选择处理结果"},on:{change:function(t){return e.changeInput(t)}},model:{value:e.pageparm.result,callback:function(t){e.$set(e.pageparm,"result",t)},expression:"pageparm.result"}},[a("el-option",{attrs:{label:"未处理",value:"未处理"}}),e._v(" "),a("el-option",{attrs:{label:"已处理",value:"已处理"}}),e._v(" "),a("el-option",{attrs:{label:"长期跟踪",value:"长期跟踪"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"交修日期"}},[a("el-col",{attrs:{span:11}},[a("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.timeList,callback:function(t){e.timeList=t},expression:"timeList"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"车号",prop:"carNumber"}},[a("el-select",{attrs:{multiple:"",filterable:"",placeholder:"请选择车号"},on:{change:function(t){return e.changeInput(t)}},model:{value:e.carNumbers,callback:function(t){e.carNumbers=t},expression:"carNumbers"}},e._l(e.carNumberList,function(e){return a("el-option",{key:e.value,attrs:{label:e.value,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"车厢号",prop:"carBodyNumber"}},[a("el-input",{attrs:{size:"small",placeholder:"输入车厢号"},on:{input:function(t){return e.changeInput(t)}},model:{value:e.pageparm.carBodyNumber,callback:function(t){e.$set(e.pageparm,"carBodyNumber",t)},expression:"pageparm.carBodyNumber"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"故障描述：",prop:"faultDescription"}},[a("el-input",{attrs:{size:"small",placeholder:"输入故障描述"},on:{input:function(t){return e.changeInput(t)}},model:{value:e.pageparm.faultDescription,callback:function(t){e.$set(e.pageparm,"faultDescription",t)},expression:"pageparm.faultDescription"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"故障来源：",prop:"source"}},[a("el-input",{attrs:{size:"small",placeholder:"输入故障来源"},on:{input:function(t){return e.changeInput(t)}},model:{value:e.pageparm.source,callback:function(t){e.$set(e.pageparm,"source",t)},expression:"pageparm.source"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"处理方法：",prop:"method"}},[a("el-input",{attrs:{size:"small",placeholder:"输入处理方法"},on:{input:function(t){return e.changeInput(t)}},model:{value:e.pageparm.method,callback:function(t){e.$set(e.pageparm,"method",t)},expression:"pageparm.method"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"处理班组",prop:"teamsGroups"}},[a("el-select",{attrs:{placeholder:"请选择处理班组"},on:{change:function(t){return e.changeInput(t)}},model:{value:e.pageparm.teamsGroups,callback:function(t){e.$set(e.pageparm,"teamsGroups",t)},expression:"pageparm.teamsGroups"}},e._l(e.teamsList,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.name}})}),1)],1),e._v(" "),a("br"),e._v(" "),a("el-form-item",[a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-search"},on:{click:function(t){return e.search()}}},[e._v("搜索")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-refresh-right"},on:{click:function(t){return e.resetForm("searchForm")}}},[e._v("重置")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-plus"},on:{click:function(t){return e.handleEdit()}}},[e._v("添加")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"warning",icon:"el-icon-star-off"},on:{click:function(t){return e.exportExcel()}}},[e._v("导出")])],1)],1),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"",height:"600"}},[a("el-table-column",{attrs:{type:"index",label:"序号",align:"center",width:"130",index:e.indexMethod,fixed:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"deliveryDate",label:"交修日期",width:"180",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"carNumber",label:"车号",width:"180",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"carBodyNumber",label:"车厢号",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"faultDescription",label:"故障描述",width:"180",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"teamsGroups",label:"处理班组",width:"180",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"result",label:"处理结果",width:"130",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"method",label:"处理方法",width:"180",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"source",label:"故障来源",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s("null"==t.row.source?"":t.row.source)+"\n            ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"notes",label:"车组预计送修时间",align:"center",width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s("null"==t.row.notes?"":t.row.notes)+"\n            ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"",label:"删除",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(a){return e.deleteById(t.row)}}})]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"notes",label:"查看",align:"center",width:"130"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticClass:"icon-button",on:{click:function(a){return e.showModal(t.row.id)}}},[a("i",{staticClass:"el-icon-view"}),e._v("\n              查看附件\n            ")])]}}])},[e._v(" "),a("el-dialog",{attrs:{title:"附件列表",visible:e.dialogVisible,width:"40%","before-close":e.handleCloseFile,"append-to-body":""},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.attachmentList}},[a("el-table-column",{attrs:{prop:"fileName",align:"center",label:"名称"},scopedSlots:e._u([{key:"default",fn:function(t){var l=t.row;return[a("el-link",{on:{click:function(t){return e.handleFileNameClick(l)}}},[e._v(e._s(l.fileName))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"fileType",align:"center",label:"类型"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var l=t.row;return[a("el-button",{attrs:{type:"primary",icon:"el-icon-download"},on:{click:function(t){return e.downloadAttachment(l)}}}),e._v(" "),a("el-button",{attrs:{type:"danger",icon:"el-icon-delete"},on:{click:function(t){return e.deleteAttachment(l)}}})]}}])})],1)],1)],1),e._v(" "),a("el-table-column",{attrs:{prop:"",label:"附件",width:"120",align:"center",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticStyle:{"margin-top":"5px"}},[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(a){return e.showUploadModal(t.row)}}},[e._v("点击上传")])],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"",label:"操作",width:"180",align:"center",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary",icon:"el-icon-edit",circle:""},on:{click:function(a){return e.handleEdit(t.$index,t.row)}}}),e._v(" "),a("el-button",{attrs:{type:"success",icon:"el-icon-bottom",circle:""},on:{click:function(a){return e.changState(t.row.id,t.row.state)}}})]}}])})],1),e._v(" "),a("Pagination",{attrs:{"child-msg":e.pageparm,total:e.total},on:{callFather:e.callFather}}),e._v(" "),a("el-dialog",{attrs:{title:e.title,visible:e.editFormVisible,width:"55%"},on:{"update:visible":function(t){e.editFormVisible=t},click:function(t){return e.closeDialog("editForm")}}},[a("el-form",{ref:"editForm",attrs:{"label-width":"120px",model:e.editForm,rules:e.rules}},[a("el-form-item",{attrs:{label:"交修日期",prop:"deliveryDate"}},[a("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",type:"date",placeholder:"选择日期"},model:{value:e.editForm.deliveryDate,callback:function(t){e.$set(e.editForm,"deliveryDate",t)},expression:"editForm.deliveryDate"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"车号",prop:"carNumber"}},[a("el-input",{attrs:{"auto-complete":"off",placeholder:"请输入车号"},model:{value:e.editForm.carNumber,callback:function(t){e.$set(e.editForm,"carNumber",t)},expression:"editForm.carNumber"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"车厢号",prop:"carBodyNumber"}},[a("el-input",{attrs:{min:1,label:"",placeholder:"请输入车箱号"},model:{value:e.editForm.carBodyNumber,callback:function(t){e.$set(e.editForm,"carBodyNumber",t)},expression:"editForm.carBodyNumber"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"故障描述",prop:"faultDescription"}},[a("el-input",{attrs:{type:"textarea",label:"",placeholder:"请输入故障描述"},model:{value:e.editForm.faultDescription,callback:function(t){e.$set(e.editForm,"faultDescription",t)},expression:"editForm.faultDescription"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"处理班组",prop:"teamsGroups"}},[a("el-select",{attrs:{placeholder:"请选择处理班组"},model:{value:e.editForm.teamsGroups,callback:function(t){e.$set(e.editForm,"teamsGroups",t)},expression:"editForm.teamsGroups"}},e._l(e.teamsList,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.name}})}),1),e._v(" "),a("el-link",{attrs:{type:"primary",href:"http://localhost:8080/#/teams/index",underline:!1}},[e._v("添加班组")])],1),e._v(" "),a("el-form-item",{attrs:{label:"处理结果",prop:"result"}},[a("label",{attrs:{slot:"label"},slot:"label"},[a("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v(" 处理结果")]),e._v(" "),a("el-radio-group",{on:{change:e.changeResult},model:{value:e.result,callback:function(t){e.result=t},expression:"result"}},[a("el-radio",{staticClass:"radio",attrs:{label:"未处理"}},[e._v("未处理")]),e._v(" "),a("el-radio",{staticClass:"radio",attrs:{label:"长期跟踪"}},[e._v("长期跟踪")]),e._v(" "),a("el-radio",{staticClass:"radio",attrs:{label:"已处理"}},[e._v("已处理(填写处理时间)")])],1),e._v(" "),"已处理"==e.result?a("el-input",{attrs:{label:"",placeholder:"请输入处理结果",size:"mini"},model:{value:e.editForm.result,callback:function(t){e.$set(e.editForm,"result",t)},expression:"editForm.result"}}):e._e()],1),e._v(" "),a("el-form-item",{attrs:{label:"处理方法",prop:"method"}},[a("el-input",{attrs:{type:"textarea",size:"small","auto-complete":"off",placeholder:"请输入处理结果"},model:{value:e.editForm.method,callback:function(t){e.$set(e.editForm,"method",t)},expression:"editForm.method"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"故障来源",prop:"respDepart"}},[a("el-input",{attrs:{label:"",placeholder:"请输入故障来源"},model:{value:e.editForm.source,callback:function(t){e.$set(e.editForm,"source",t)},expression:"editForm.source"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"车组预计送修时间",prop:"node"}},[a("el-input",{attrs:{size:"small","auto-complete":"off",placeholder:"车组预计送修时间"},model:{value:e.editForm.notes,callback:function(t){e.$set(e.editForm,"notes",t)},expression:"editForm.notes"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){return e.closeDialog("editForm")}}},[e._v("取消")]),e._v(" "),a("el-button",{staticClass:"title",attrs:{size:"small",type:"primary"},on:{click:function(t){return e.handelFault("editForm")}}},[e._v("保存")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"文件上传",visible:e.uploadModalVisible,width:"650px","before-close":e.beforeClose,"append-to-body":"","show-close":!1,"close-on-click-modal":!1},on:{"update:visible":function(t){e.uploadModalVisible=t}}},[a("el-upload",{ref:"refName",staticClass:"uploadFile",attrs:{action:e.baseURL+"/fault/upload","on-success":e.handleFileSuccess,"on-error":e.handleFileError,"file-list":e.fileList,data:e.fault,drag:"",multiple:""}},[a("i",{staticClass:"el-icon-upload"}),e._v(" "),a("div",{staticClass:"el-upload__text"},[e._v("将文件拖到此处，或"),a("em",[e._v("点击上传")])])]),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.upload}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.upload}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var M=a("VU/8")(I,z,!1,function(e){a("qnhG")},"data-v-156ff750",null).exports,q={name:"Fault",components:{Pagination:T},data:function(){return{carNumbers:[],carNumberList:S,risks:[],baseURL:c,timeList:[],tableData:[],editFormVisible:!1,title:"编辑",editForm:{state:2,risk:0},risk:0,result:"",rules:{deliveryDate:[{required:!0,message:"请输入日期",trigger:"blur"}],carNumber:[{required:!0,message:"请输入车号",trigger:"blur"}],carBodyNumber:[{required:!0,message:"请输入车厢号",trigger:"blur"}],faultDescription:[{required:!0,message:"请输入故障描述",trigger:"blur"}],teamsGroups:[{required:!0,message:"请选择班组",trigger:"blur"}],funClass:[{required:!0,message:"请选择功能分类",trigger:"blur"}],handle:[{required:!0,message:"请选择处置分类",trigger:"blur"}],method:[{required:!0,message:"请输入处理方法",trigger:"blur"}],source:[{required:!0,message:"请输入故障来源",trigger:"blur"}],material:[{required:!0,message:"请选择到料情况"}]},pageparm:{pageNo:1,pageSize:1e5,state:2},total:0,allList:[],loading:!0,teamsList:[],riskList:[{label:"⭐",value:1},{label:"⭐⭐",value:2},{label:"⭐⭐⭐",value:3}],editRichFormVisible:!1,msg:"",isShow:!1,uploadModalVisible:!1,fileList:[],dialogVisible:!1,attachmentList:[],previewDialogVisible:!1,previewFile:"",fault:{},deleteParams:{}}},created:function(){this.getFault(),this.getTeams()},computed:{indexMethod:function(){return(this.pageparm.pageNo-1)*this.pageparm.pageSize+1}},methods:{rowStyle:function(e){var t=e.row;return 1==t.dimension?{background:"antiquewhite"}:1==t.review?{background:"rgb(159 199 159)"}:void 0},changeUpdate:function(){this.$forceUpdate()},changeResultSelect:function(){"全部"==this.pageparm.result&&delete this.pageparm.result},resetForm:function(e){this.$refs[e].resetFields(),this.timeList=[],delete this.pageparm.startTime,delete this.pageparm.endTime,this.pageparm.carNumbers&&delete this.pageparm.carNumbers,this.carNumbers=[],this.pageparm.risks&&delete this.pageparm.risks,this.risks=[]},getTeams:function(){var e=this;Object(s.a)({url:c+"/teams/selectall"}).then(function(t){e.teamsList=t.data.data,e.loading=!1}).catch(function(e){console.log(e)})},search:function(){var e=this;this.carNumbers.length&&(this.pageparm.carNumbers=this.carNumbers),this.risks.length&&(this.pageparm.risks=this.risks),this.loading=!0,this.timeList.length&&(this.pageparm.startTime=this.getYMDHMS(new Date(this.timeList[0].toString())),this.pageparm.endTime=this.getYMDHMS(new Date(this.timeList[1].toString()))),this.pageparm.pageNo=1,this.pageparm.pageSize=1e5,Object(s.a)({method:"post",url:c+"/fault/screenfault",data:this.pageparm}).then(function(t){e.tableData=t.data.data.list,e.tableData=e.tableData.map(function(t){return t.deliveryDate=e.getYMDHMS(t.deliveryDate),t.risk="0"==t.risk?0:parseInt(t.risk),t.code="null"==t.code?"":t.code,t.schedule="null"==t.schedule?"":t.schedule,t.respDepart="null"==t.respDepart?"":t.respDepart,t.notes="null"==t.notes?"":t.notes,t.trackPerson="null"==t.trackPerson?"":t.trackPerson,t.trackRequire="null"==t.trackRequire?"":t.trackPerson,t.feedback="null"==t.feedback?"":t.feedback,t}),e.total=t.data.data.size,e.loading=!1,e.$message.success("搜索成功")}).catch(function(t){e.initPage(),e.getFault(),e.$message.error("搜索失败"),console.log(t)})},initPage:function(){this.pageparm={pageNo:1,pageSize:1e5,state:2}},getYMDHMS:function(e){var t=new Date(e);return t.getFullYear()+"-"+(t.getMonth()+1).toString().padStart(2,"0")+"-"+t.getDate().toString().padStart(2,"0")},exportExcel:function(){"全部"==this.pageparm.result&&delete this.pageparm.result,this.carNumbers.length&&(this.pageparm.carNumbers=this.carNumbers),this.timeList.length&&(this.pageparm.startTime=this.getYMDHMS(new Date(this.timeList[0].toString())),this.pageparm.endTime=this.getYMDHMS(new Date(this.timeList[1].toString()))),this.risks.length&&(this.pageparm.risks=this.risks);var e=c+"/fault/exporttrack?";for(var t in this.pageparm)this.pageparm[t]&&(e+=t+"="+this.pageparm[t]+"&");console.log(e),s.a.get(e).then(function(t){console.log(e),window.location.href=e})},callFather:function(e){this.pageparm.pageNo=e.pageNo,this.pageparm.pageSize=e.pageSize,this.getFault()},getFault:function(){var e=this;this.carNumbers.length&&(this.pageparm.carNumbers=this.carNumbers),Object(s.a)({url:c+"/fault/screenfault",method:"post",data:this.pageparm}).then(function(t){e.tableData=t.data.data.list||[],e.tableData=e.tableData.map(function(t){return t.deliveryDate=e.getYMDHMS(t.deliveryDate),t.risk="0"==t.risk?parseInt(0):parseInt(t.risk),t.code="null"==t.code?"":t.code,t.schedule="null"==t.schedule?"":t.schedule,t.respDepart="null"==t.respDepart?"":t.respDepart,t.notes="null"==t.notes?"":t.notes,t.trackPerson="null"==t.trackPerson?"":t.trackPerson,t.trackRequire="null"==t.trackRequire?"":t.trackRequire,t.feedback="null"==t.feedback?"":t.feedback,t}),e.total=t.data.data.size,e.loading=!1}).catch(function(e){console.log(e)})},deleteById:function(e){var t=this;this.$confirm("此操作将永久删除, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:c+"/fault/deletefaultid",params:{id:e.id}}).then(function(e){t.$message({message:"删除成功",type:"success"}),t.search()}).catch(function(e){console.log(e)})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},handleEdit:function(e,t){this.editFormVisible=!0,void 0!=t&&"undefined"!=t?(this.title="修改",this.editForm=t,"未处理"!=this.editForm.result&"长期跟踪"!=this.editForm.result?this.result="已处理":"未处理"==this.editForm.result?this.result="未处理":"长期跟踪"==this.editForm.result&&(this.result="长期跟踪"),this.risk=t.risk):(this.title="添加",this.editForm={},this.result="")},changeResult:function(){this.editForm.result=""},handelFault:function(){var e=this;this.$refs.editForm.validate(function(t){if(!t)return console.log("提交失败"),!1;if("已处理"!=e.result&&(e.editForm.result=e.result),e.editForm.risk=e.risk,"添加"==e.title)e.editForm.dimension="0",e.editForm.state=2,Object(s.a)({url:c+"/fault/insertfault",method:"post",data:e.editForm}).then(function(t){e.$message({message:e.title+"成功",type:"success"}),e.editFormVisible=!1,e.editForm={state:2},e.risk=0,e.initPage(),e.getFault()}).catch(function(t){console.log(t),e.$message({message:e.title+"失败",type:"error"}),e.editFormVisible=!1,e.editForm={state:2},e.risk=0,e.initPage(),e.getFault()});else{for(var a in e.editForm)!e.editForm[a]&"risk"!=a&&(e.editForm[a]="null");Object(s.a)({url:c+"/fault/updatefaultid",method:"post",data:e.editForm}).then(function(t){e.editFormVisible=!1,e.editForm={},e.risk=0,e.$message.success("修改成功")}).catch(function(t){console.log(t),e.$message.error("请重新提交")})}})},closeDialog:function(){this.editFormVisible=!1,this.editForm={},this.risk=0,this.initPage(),this.getFault()},handleUploadSuccess:function(e){this.uploadUrlPath=N()(e),this.loading.close()},handleBeforeUpload:function(){this.loading=this.$loading({lock:!0,text:"上传中",background:"rgba(0, 0, 0, 0.7)"})},handleUploadError:function(){this.$message({type:"error",message:"上传失败"}),this.loading.close()},handleRemove:function(e,t){console.log(e,t)},handlePreview:function(e){console.log(e)},handleExceed:function(e,t){this.$message.warning("当前限制选择文件个数，本次选择了 "+e.length+" 个文件，共选择了 "+(e.length+t.length)+" 个文件")},beforeRemove:function(e,t){return this.$confirm("确定移除 "+e.name+"？")},handleSuccess:function(){this.getFault(),this.$message.success("导入成功")},handleError:function(){this.getFault(),this.$message.error("导入格式错误，请修改后重新导入！")},resetRisk:function(){this.risk=0},changeDimension:function(e,t){var a=this;this.$confirm("此操作将数据列为重点故障，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:" "+c+"/fault/changedimension",params:{id:e,dimension:t}}).then(function(e){a.$message.success("成功"),a.search()}).catch(function(e){a.$message.error("失败")})}).catch(function(){a.$message({type:"info",message:"已取消"})})},changeTrack:function(e){var t=this;this.$confirm("此操作将数据提交到故障遗留列表, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:" "+c+"/fault/changestate",params:{id:e,state:0,trackPerson:"null",trackRequire:"null",feedback:"null"}}).then(function(e){t.$message.success("已转移到故障遗留库"),t.search()}).catch(function(e){t.$message.error("重新提交")})}).catch(function(){t.$message({type:"info",message:"已取消提交"})})},goRich:function(e){this.$router.push({path:"/technician/fault/rich",query:{id:e.id}})},checkRich:function(e){var t=this;this.editRichFormVisible=!0,Object(s.a)({method:"post",url:c+"/fault/screenfault",data:{pageNo:1,pageSize:1e5,id:e.id}}).then(function(e){var a=e.data.data.list[0].rich;console.log(a),a?(t.isShow=!0,t.msg=a):t.isShow=!1}).catch(function(e){t.initPage(),t.getFault(),t.$message.error("搜索失败"),console.log(e)})},closeRichDialog:function(){this.msg="",this.editRichFormVisible=!1},showModal:function(e){var t=this;console.log(e),Object(s.a)({url:c+"/fault/fileList/"+e,method:"get"}).then(function(e){console.log(e),t.dialogVisible=!0,t.attachmentList=e.data.data||[]})},handleCloseFile:function(e){e()},handleFileNameClick:function(e){var t=this;console.log(c+"/fault/download/"+e.faultFileMidId),console.log("点击文件名",e),this.$confirm("点击后下载，是否确定？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:c+"/fault/getFileInfo/"+e.fileId,method:"get"}).then(function(a){console.log(a),200!==a.data.code&&(t.$message.error(a.data.msg),t.showModal(e.faultId)),D(c+"/fault/download/"+e.faultFileMidId,e.fileName),console.log(c+"/fault/download/"+e.faultFileMidId)}).catch(function(e){t.$message.error(e)})})},downloadAttachment:function(e){console.log("下载附件",e),D(c+"/fault/download/"+e.faultFileMidId,e.fileName)},deleteAttachment:function(e){var t=this;console.log("删除附件",e),this.deleteParams={fileId:e.fileId,faultFileMidId:e.faultFileMidId},this.$confirm("点击后删除，是否确定？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:c+"/fault/deleteFile",method:"post",data:t.deleteParams}).then(function(a){console.log(a),200!==a.data.code?t.$message.error(a.data.msg):(t.$message.success("操作成功!"),t.showModal(e.faultId))}).catch(function(e){t.$message.error(e)})})},showUploadModal:function(e){this.fault.id=e.id,this.uploadModalVisible=!0},beforeClose:function(e){e()},handleFileSuccess:function(e,t,a){console.log("success"),200!==e.code?(this.$message.error(e.msg),this.$refs.refName.uploadFiles.splice(this.$refs.refName.uploadFiles.indexOf(t),1)):this.$message.success("上传成功")},handleFileError:function(e,t,a){this.$message.error("文件超出大小限制，上传失败，请联系管理员!"),this.$refs.refName.uploadFiles.splice(this.$refs.refName.uploadFiles.indexOf(t),1),this.$refs.refName.clearFiles()},upload:function(){this.$refs.refName.clearFiles(),this.uploadModalVisible=!1}}},O={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{ref:"searchForm",staticClass:"user-search",attrs:{inline:!0,model:e.pageparm}},[a("el-form-item",{attrs:{label:"处理结果：",prop:"result"}},[a("el-select",{attrs:{placeholder:"请选择处理结果"},on:{change:e.changeResultSelect},model:{value:e.pageparm.result,callback:function(t){e.$set(e.pageparm,"result",t)},expression:"pageparm.result"}},[a("el-option",{attrs:{label:"全部",value:"全部"}}),e._v(" "),a("el-option",{attrs:{label:"未处理",value:"未处理"}}),e._v(" "),a("el-option",{attrs:{label:"已处理",value:"已处理"}}),e._v(" "),a("el-option",{attrs:{label:"长期跟踪",value:"长期跟踪"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"标注",prop:"dimension"}},[a("el-select",{attrs:{placeholder:"请选择"},on:{change:e.changeUpdate},model:{value:e.pageparm.dimension,callback:function(t){e.$set(e.pageparm,"dimension",t)},expression:"pageparm.dimension"}},[a("el-option",{attrs:{label:"非重点关注",value:"0"}}),e._v(" "),a("el-option",{attrs:{label:"重点关注",value:"1"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"到料",prop:"material"}},[a("el-select",{attrs:{placeholder:"请选择到料情况"},model:{value:e.pageparm.material,callback:function(t){e.$set(e.pageparm,"material",t)},expression:"pageparm.material"}},[a("el-option",{attrs:{label:"无",value:"无"}}),e._v(" "),a("el-option",{attrs:{label:"否",value:"否"}}),e._v(" "),a("el-option",{attrs:{label:"是",value:"是"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"复核",prop:"review"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.pageparm.review,callback:function(t){e.$set(e.pageparm,"review",t)},expression:"pageparm.review"}},[a("el-option",{attrs:{label:"否",value:"0"}}),e._v(" "),a("el-option",{attrs:{label:"是",value:"1"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"车号",prop:"carNumber"}},[a("el-select",{attrs:{multiple:"",filterable:"",placeholder:"请选择车号"},model:{value:e.carNumbers,callback:function(t){e.carNumbers=t},expression:"carNumbers"}},e._l(e.carNumberList,function(e){return a("el-option",{key:e.value,attrs:{label:e.value,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"车厢号",prop:"carBodyNumber"}},[a("el-input",{attrs:{size:"small",placeholder:"输入车厢号"},on:{input:function(t){return e.changeInput(t)}},model:{value:e.pageparm.carBodyNumber,callback:function(t){e.$set(e.pageparm,"carBodyNumber",t)},expression:"pageparm.carBodyNumber"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"责任人",prop:"trackPerson"}},[a("el-input",{attrs:{size:"small",placeholder:"输入责任人"},on:{input:function(t){return e.changeInput(t)}},model:{value:e.pageparm.trackPerson,callback:function(t){e.$set(e.pageparm,"trackPerson",t)},expression:"pageparm.trackPerson"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"追踪要求",prop:"trackRequire"}},[a("el-input",{attrs:{size:"small",placeholder:"输入追踪要求"},on:{input:function(t){return e.changeInput(t)}},model:{value:e.pageparm.trackRequire,callback:function(t){e.$set(e.pageparm,"trackRequire",t)},expression:"pageparm.trackRequire"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"反馈实现",prop:"feedback"}},[a("el-input",{attrs:{size:"small",placeholder:"输入反馈实现"},on:{input:function(t){return e.changeInput(t)}},model:{value:e.pageparm.feedback,callback:function(t){e.$set(e.pageparm,"feedback",t)},expression:"pageparm.feedback"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"交修日期"}},[a("el-col",{attrs:{span:11}},[a("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.timeList,callback:function(t){e.timeList=t},expression:"timeList"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"故障描述：",prop:"faultDescription"}},[a("el-input",{attrs:{size:"small",placeholder:"输入故障描述"},on:{input:function(t){return e.changeInput(t)}},model:{value:e.pageparm.faultDescription,callback:function(t){e.$set(e.pageparm,"faultDescription",t)},expression:"pageparm.faultDescription"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"影响进度原因：",prop:"schedule"}},[a("el-input",{attrs:{size:"small",placeholder:"输入影响进度原因"},on:{input:function(t){return e.changeInput(t)}},model:{value:e.pageparm.schedule,callback:function(t){e.$set(e.pageparm,"schedule",t)},expression:"pageparm.schedule"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"故障来源：",prop:"source"}},[a("el-input",{attrs:{size:"small",placeholder:"输入故障来源"},on:{input:function(t){return e.changeInput(t)}},model:{value:e.pageparm.source,callback:function(t){e.$set(e.pageparm,"source",t)},expression:"pageparm.source"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"处理方法：",prop:"method"}},[a("el-input",{attrs:{size:"small",placeholder:"输入处理方法"},model:{value:e.pageparm.method,callback:function(t){e.$set(e.pageparm,"method",t)},expression:"pageparm.method"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"处理班组",prop:"teamsGroups"},on:{change:e.changeUpdate}},[a("el-select",{attrs:{placeholder:"请选择处理班组"},model:{value:e.pageparm.teamsGroups,callback:function(t){e.$set(e.pageparm,"teamsGroups",t)},expression:"pageparm.teamsGroups"}},e._l(e.teamsList,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.name}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"功能分类",prop:"funClass"}},[a("el-select",{attrs:{placeholder:"请选择功能分类"},on:{change:e.changeUpdate},model:{value:e.pageparm.funClass,callback:function(t){e.$set(e.pageparm,"funClass",t)},expression:"pageparm.funClass"}},[a("el-option",{attrs:{label:"整车",value:"整车"}}),e._v(" "),a("el-option",{attrs:{label:"车体",value:"车体"}}),e._v(" "),a("el-option",{attrs:{label:"车端连接",value:"车端连接"}}),e._v(" "),a("el-option",{attrs:{label:"转向架及其辅助",value:"转向架及其辅助"}}),e._v(" "),a("el-option",{attrs:{label:"主供电",value:"主供电"}}),e._v(" "),a("el-option",{attrs:{label:"牵引",value:"牵引"}}),e._v(" "),a("el-option",{attrs:{label:"辅助电气",value:"辅助电气"}}),e._v(" "),a("el-option",{attrs:{label:"供风制动",value:"供风制动"}}),e._v(" "),a("el-option",{attrs:{label:"网络及辅助监控",value:"网络及辅助监控"}}),e._v(" "),a("el-option",{attrs:{label:"旅客信息",value:"旅客信息"}}),e._v(" "),a("el-option",{attrs:{label:"空调",value:"空调"}}),e._v(" "),a("el-option",{attrs:{label:"给排水卫生",value:"给排水卫生"}}),e._v(" "),a("el-option",{attrs:{label:"外门及车内设施",value:"外门及车内设施"}}),e._v(" "),a("el-option",{attrs:{label:"驾驶设施",value:"驾驶设施"}}),e._v(" "),a("el-option",{attrs:{label:"电务车载",value:"电务车载"}}),e._v(" "),a("el-option",{attrs:{label:"其他",value:"其他"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"处置分类",prop:"handle"}},[a("el-input",{attrs:{size:"small",placeholder:"输入处置分类"},on:{input:function(t){return e.changeInput(t)}},model:{value:e.pageparm.handle,callback:function(t){e.$set(e.pageparm,"handle",t)},expression:"pageparm.handle"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"风险等级",prop:"risk"}},[a("el-select",{attrs:{multiple:"",filterable:"",placeholder:"请选择风险等级"},on:{change:e.changeUpdate},model:{value:e.risks,callback:function(t){e.risks=t},expression:"risks"}},[a("el-option",{attrs:{label:"无风险",value:0}}),e._v(" "),e._l(e.riskList,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}},[a("span",{staticStyle:{float:"left"}},[a("el-rate",{attrs:{max:t.value,disabled:""},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}})],1)])})],2)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-search"},on:{click:function(t){return e.search()}}},[e._v("搜索")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-refresh-right"},on:{click:function(t){return e.resetForm("searchForm")}}},[e._v("重置")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"warning",icon:"el-icon-star-off"},on:{click:function(t){return e.exportExcel()}}},[e._v("导出")])],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"",height:"600","row-style":e.rowStyle}},[a("el-table-column",{attrs:{type:"index",label:"序号",align:"center",width:"70",index:e.indexMethod,fixed:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"deliveryDate",label:"交修日期",width:"100",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"carNumber",label:"车号",width:"70",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"carBodyNumber",label:"车厢号",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"trackPerson",label:"责任人",width:"100",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"trackRequire",label:"追踪要求",width:"180",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"feedback",label:"反馈实现",width:"180",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"faultDescription",label:"故障描述",width:"180",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"teamsGroups",label:"处理班组",width:"100",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"result",label:"处理结果",width:"180",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s("null"==t.row.result?"":t.row.result)+"\n            ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"method",label:"处理方法",width:"200",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s("null"==t.row.method?"":t.row.method)+"\n            ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"material",label:"是否到料",width:"100",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"source",label:"故障来源",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s("null"==t.row.source?"":t.row.source)+"\n            ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"funClass",label:"功能分类",width:"130",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s("null"==t.row.funClass?"":t.row.funClass)+"\n            ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"risk",label:"风险等级",width:"180",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-rate",{attrs:{max:3,disabled:""},model:{value:t.row.risk,callback:function(a){e.$set(t.row,"risk",a)},expression:"scope.row.risk"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"handle",label:"处置分类",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s("null"==t.row.handle?"":t.row.handle)+"\n            ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"notes",label:"备注",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s("null"==t.row.notes?"":t.row.notes)+"\n            ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"handle",label:"处置分类",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(a){return e.deleteById(t.row)}}})]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"notes",label:"查看",align:"center",width:"130"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticClass:"icon-button",on:{click:function(a){return e.showModal(t.row.id)}}},[a("i",{staticClass:"el-icon-view"}),e._v("\n                    查看附件\n                ")])]}}])},[e._v(" "),a("el-dialog",{attrs:{title:"附件列表",visible:e.dialogVisible,width:"40%","before-close":e.handleCloseFile,"append-to-body":""},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.attachmentList}},[a("el-table-column",{attrs:{prop:"fileName",align:"center",label:"名称"},scopedSlots:e._u([{key:"default",fn:function(t){var l=t.row;return[a("el-link",{on:{click:function(t){return e.handleFileNameClick(l)}}},[e._v(e._s(l.fileName))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"fileType",align:"center",label:"类型"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var l=t.row;return[a("el-button",{attrs:{type:"primary",icon:"el-icon-download"},on:{click:function(t){return e.downloadAttachment(l)}}}),e._v(" "),a("el-button",{attrs:{type:"danger",icon:"el-icon-delete"},on:{click:function(t){return e.deleteAttachment(l)}}})]}}])})],1)],1)],1),e._v(" "),a("el-table-column",{attrs:{prop:"",label:"附件",width:"120",align:"center",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticStyle:{"margin-top":"5px"}},[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(a){return e.showUploadModal(t.row)}}},[e._v("点击上传")])],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"",label:"操作",width:"180",align:"center",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary",icon:"el-icon-edit",circle:""},on:{click:function(a){return e.handleEdit(t.$index,t.row)}}}),e._v(" "),a("el-tooltip",{attrs:{content:"移交故障遗留列表",placement:"top"}},[a("el-button",{attrs:{type:"success",icon:"el-icon-download",circle:""},on:{click:function(a){return e.changeTrack(t.row.id)}}})],1),e._v(" "),1==t.row.dimension?a("el-button",{attrs:{type:"warning",icon:"el-icon-warning",circle:""},on:{click:function(a){return e.changeDimension(t.row.id,0)}}}):a("el-button",{attrs:{icon:"el-icon-warning-outline",circle:""},on:{click:function(a){return e.changeDimension(t.row.id,1)}}})]}}])})],1),e._v(" "),a("Pagination",{attrs:{"child-msg":e.pageparm,total:e.total},on:{callFather:e.callFather}}),e._v(" "),a("el-dialog",{attrs:{title:e.title,visible:e.editFormVisible,width:"50%"},on:{"update:visible":function(t){e.editFormVisible=t},click:function(t){return e.closeDialog("editForm")}}},[a("el-form",{ref:"editForm",attrs:{"label-width":"120px",model:e.editForm,rules:e.rules}},[a("el-form-item",{attrs:{label:"责任人",prop:"trackPerson"}},[a("el-input",{attrs:{label:"",placeholder:"请输入责任人",disabled:""},model:{value:e.editForm.trackPerson,callback:function(t){e.$set(e.editForm,"trackPerson",t)},expression:"editForm.trackPerson"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"追踪要求",prop:"trackRequire"}},[a("el-input",{attrs:{type:"textarea",label:"",placeholder:"请输入追踪要求",disabled:""},model:{value:e.editForm.trackRequire,callback:function(t){e.$set(e.editForm,"trackRequire",t)},expression:"editForm.trackRequire"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"反馈实现",prop:"feedback"}},[a("el-input",{attrs:{type:"textarea",label:"",placeholder:"请责任人填写反馈实现"},model:{value:e.editForm.feedback,callback:function(t){e.$set(e.editForm,"feedback",t)},expression:"editForm.feedback"}})],1),e._v(" "),a("el-divider",{attrs:{"content-position":"left"}},[e._v("故障详情")]),e._v(" "),a("el-form-item",{attrs:{label:"交修日期",prop:"deliveryDate"}},[a("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",type:"date",placeholder:"选择日期"},model:{value:e.editForm.deliveryDate,callback:function(t){e.$set(e.editForm,"deliveryDate",t)},expression:"editForm.deliveryDate"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"车号",prop:"carNumber"}},[a("el-input",{attrs:{"auto-complete":"off",placeholder:"请输入车号"},model:{value:e.editForm.carNumber,callback:function(t){e.$set(e.editForm,"carNumber",t)},expression:"editForm.carNumber"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"车厢号",prop:"carBodyNumber"}},[a("el-input",{attrs:{min:1,label:"",placeholder:"请输入车箱号"},model:{value:e.editForm.carBodyNumber,callback:function(t){e.$set(e.editForm,"carBodyNumber",t)},expression:"editForm.carBodyNumber"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"故障描述",prop:"faultDescription"}},[a("el-input",{attrs:{type:"textarea",label:"",placeholder:"请输入故障描述"},model:{value:e.editForm.faultDescription,callback:function(t){e.$set(e.editForm,"faultDescription",t)},expression:"editForm.faultDescription"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"处理班组",prop:"teamsGroups"}},[a("el-select",{attrs:{placeholder:"请选择处理班组"},model:{value:e.editForm.teamsGroups,callback:function(t){e.$set(e.editForm,"teamsGroups",t)},expression:"editForm.teamsGroups"}},e._l(e.teamsList,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.name}})}),1),e._v(" "),a("el-link",{attrs:{type:"primary",href:"http://localhost:8080/#/teams/index",underline:!1}},[e._v("添加班组")])],1),e._v(" "),a("el-form-item",{attrs:{label:"处理结果",prop:"result"}},[a("label",{attrs:{slot:"label"},slot:"label"},[a("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v(" 处理结果")]),e._v(" "),a("el-radio-group",{on:{change:e.changeResult},model:{value:e.result,callback:function(t){e.result=t},expression:"result"}},[a("el-radio",{staticClass:"radio",attrs:{label:"未处理"}},[e._v("未处理")]),e._v(" "),a("el-radio",{staticClass:"radio",attrs:{label:"长期跟踪"}},[e._v("长期跟踪")]),e._v(" "),a("el-radio",{staticClass:"radio",attrs:{label:"已处理"}},[e._v("已处理(填写处理时间)")])],1),e._v(" "),"已处理"==e.result?a("el-input",{attrs:{label:"",placeholder:"请输入处理结果",size:"mini"},model:{value:e.editForm.result,callback:function(t){e.$set(e.editForm,"result",t)},expression:"editForm.result"}}):e._e()],1),e._v(" "),a("el-form-item",{attrs:{label:"处置分类",prop:"handle"}},[a("el-select",{attrs:{placeholder:"请选择处置分类"},model:{value:e.editForm.handle,callback:function(t){e.$set(e.editForm,"handle",t)},expression:"editForm.handle"}},[a("el-option",{attrs:{label:"已处理",value:"已处理"}}),e._v(" "),a("el-option",{attrs:{label:"待处理",value:"待处理"}}),e._v(" "),a("el-option",{attrs:{label:"待一级修",value:"待二级修"}}),e._v(" "),a("el-option",{attrs:{label:"待二级修",value:"待二级修"}}),e._v(" "),a("el-option",{attrs:{label:"待扣修",value:"待扣修"}}),e._v(" "),a("el-option",{attrs:{label:"待高级修",value:"待高级修"}}),e._v(" "),a("el-option",{attrs:{label:"待集中处理",value:"待集中处理"}}),e._v(" "),a("el-option",{attrs:{label:"待售后处理",value:"待售后处理"}}),e._v(" "),a("el-option",{attrs:{label:"待料",value:"待料"}}),e._v(" "),a("el-option",{attrs:{label:"跟踪观察",value:"跟踪观察"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"功能分类",prop:"funClass"}},[a("el-select",{attrs:{placeholder:"请选择功能分类"},model:{value:e.editForm.funClass,callback:function(t){e.$set(e.editForm,"funClass",t)},expression:"editForm.funClass"}},[a("el-option",{attrs:{label:"整车",value:"整车"}}),e._v(" "),a("el-option",{attrs:{label:"车体",value:"车体"}}),e._v(" "),a("el-option",{attrs:{label:"车端连接",value:"车端连接"}}),e._v(" "),a("el-option",{attrs:{label:"转向架及其辅助",value:"转向架及其辅助"}}),e._v(" "),a("el-option",{attrs:{label:"主供电",value:"主供电"}}),e._v(" "),a("el-option",{attrs:{label:"牵引",value:"牵引"}}),e._v(" "),a("el-option",{attrs:{label:"辅助电气",value:"辅助电气"}}),e._v(" "),a("el-option",{attrs:{label:"供风制动",value:"供风制动"}}),e._v(" "),a("el-option",{attrs:{label:"网络及辅助监控",value:"网络及辅助监控"}}),e._v(" "),a("el-option",{attrs:{label:"旅客信息",value:"旅客信息"}}),e._v(" "),a("el-option",{attrs:{label:"空调",value:"空调"}}),e._v(" "),a("el-option",{attrs:{label:"给排水卫生",value:"给排水卫生"}}),e._v(" "),a("el-option",{attrs:{label:"外门及车内设施",value:"外门及车内设施"}}),e._v(" "),a("el-option",{attrs:{label:"驾驶设施",value:"驾驶设施"}}),e._v(" "),a("el-option",{attrs:{label:"电务车载",value:"电务车载"}}),e._v(" "),a("el-option",{attrs:{label:"其他",value:"其他"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"到料",prop:"material"}},[a("label",{attrs:{slot:"label"},slot:"label"},[e._v("到料\n                    "),a("span",{staticStyle:{color:"red","font-size":"10px",float:"left",width:"300px","line-height":"0"}},[a("br"),e._v("（无需提料）    （待料）       （到料）\n                    ")])]),e._v(" "),a("el-radio-group",{on:{change:e.handleMethod},model:{value:e.editForm.material,callback:function(t){e.$set(e.editForm,"material",t)},expression:"editForm.material"}},[a("el-radio",{attrs:{label:"无",value:"无"}}),e._v(" "),a("el-radio",{attrs:{label:"否",value:"否"}}),e._v(" "),a("el-radio",{attrs:{label:"是",value:"是"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"处理方法",prop:"method"}},[a("el-input",{attrs:{type:"textarea",size:"small","auto-complete":"off",placeholder:"请输入遗留原因；处理方法；物料情况；跟踪周期。"},model:{value:e.editForm.method,callback:function(t){e.$set(e.editForm,"method",t)},expression:"editForm.method"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"复核",prop:"review"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.editForm.review,callback:function(t){e.$set(e.editForm,"review",t)},expression:"editForm.review"}},[a("el-option",{attrs:{label:"否",value:"0"}}),e._v(" "),a("el-option",{attrs:{label:"是",value:"1"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{hidden:"",label:"物料编码",prop:"code"}},[a("el-input",{attrs:{size:"small","auto-complete":"off",placeholder:"请输入物料编码"},model:{value:e.editForm.code,callback:function(t){e.$set(e.editForm,"code",t)},expression:"editForm.code"}})],1),e._v(" "),a("el-form-item",{attrs:{hidden:"",label:"影响进度原因",prop:"schedule"}},[a("el-input",{attrs:{size:"small","auto-complete":"off",placeholder:"请输入影响进度原因"},model:{value:e.editForm.schedule,callback:function(t){e.$set(e.editForm,"schedule",t)},expression:"editForm.schedule"}})],1),e._v(" "),a("el-form-item",{attrs:{hidden:"",label:"责任部门（待料）",prop:"respDepart"}},[a("el-input",{attrs:{label:"",placeholder:"请输入责任部门（待料）"},model:{value:e.editForm.respDepart,callback:function(t){e.$set(e.editForm,"respDepart",t)},expression:"editForm.respDepart"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"故障来源",prop:"source"}},[a("el-input",{attrs:{label:"",placeholder:"请输入故障来源"},model:{value:e.editForm.source,callback:function(t){e.$set(e.editForm,"source",t)},expression:"editForm.source"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"风险等级",prop:"risk"}},[a("div",{staticClass:"rate_wrap"},[a("el-rate",{attrs:{max:3},model:{value:e.risk,callback:function(t){e.risk=t},expression:"risk"}}),e._v(" "),a("el-button",{attrs:{size:"mini",icon:"el-icon-refresh-right",circle:""},on:{click:e.resetRisk}})],1)]),e._v(" "),a("el-form-item",{attrs:{label:"备注",prop:"node"}},[a("el-input",{attrs:{size:"small","auto-complete":"off",placeholder:"备注"},model:{value:e.editForm.notes,callback:function(t){e.$set(e.editForm,"notes",t)},expression:"editForm.notes"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){return e.closeDialog("editForm")}}},[e._v("取消")]),e._v(" "),a("el-button",{staticClass:"title",attrs:{size:"small",type:"primary"},on:{click:function(t){return e.handelFault("editForm")}}},[e._v("保存")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"文件上传",visible:e.uploadModalVisible,width:"650px","before-close":e.beforeClose,"append-to-body":"","show-close":!1,"close-on-click-modal":!1},on:{"update:visible":function(t){e.uploadModalVisible=t}}},[a("el-upload",{ref:"refName",staticClass:"uploadFile",attrs:{action:e.baseURL+"/fault/upload","on-success":e.handleFileSuccess,"on-error":e.handleFileError,"file-list":e.fileList,data:e.fault,drag:"",multiple:""}},[a("i",{staticClass:"el-icon-upload"}),e._v(" "),a("div",{staticClass:"el-upload__text"},[e._v("将文件拖到此处，或"),a("em",[e._v("点击上传")])])]),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.upload}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.upload}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var j=a("VU/8")(q,O,!1,function(e){a("RbNT")},"data-v-027aa7a9",null).exports,R=[{value:"CRH2A",label:"CRH2A",children:[{label:2217,value:2217},{label:2249,value:2249},{label:2250,value:2250},{label:2251,value:2251},{label:2256,value:2256},{label:2294,value:2294},{label:2295,value:2295},{label:2308,value:2308},{label:2309,value:2309},{label:2310,value:2310},{label:2311,value:2311},{label:2316,value:2316},{label:2317,value:2317},{label:2318,value:2318},{label:2319,value:2319},{label:4122,value:4122},{label:4123,value:4123},{label:4124,value:4124},{label:4125,value:4125},{label:4126,value:4126},{label:4127,value:4127},{label:4128,value:4128},{label:4129,value:4129},{label:4130,value:4130},{label:4131,value:4131}]},{value:"CRH380A",label:"CRH380A",children:[{label:2641,value:2641},{label:2642,value:2642},{label:2648,value:2648},{label:2654,value:2654},{label:2663,value:2663},{label:2664,value:2664},{label:2668,value:2668},{label:2669,value:2669},{label:2674,value:2674},{label:2675,value:2675},{label:2676,value:2676},{label:2677,value:2677},{label:2678,value:2678},{label:2679,value:2679},{label:2689,value:2689},{label:2690,value:2690},{label:2721,value:2721},{label:2782,value:2782},{label:2798,value:2798},{label:2800,value:2800},{label:2814,value:2814},{label:2841,value:2841},{label:2845,value:2845},{label:2846,value:2846},{label:2847,value:2847},{label:2848,value:2848},{label:2861,value:2861},{label:2867,value:2867},{label:2879,value:2879},{label:2904,value:2904},{label:2908,value:2908},{label:2921,value:2921},{label:2922,value:2922},{label:2923,value:2923},{label:2924,value:2924},{label:2925,value:2925},{label:2931,value:2931},{label:2932,value:2932},{label:2933,value:2933},{label:2934,value:2934},{label:2935,value:2935},{label:2681,value:2681}]},{value:"CRH5A",label:"CRH5A",children:[{label:5025,value:5025},{label:5027,value:5027},{label:5031,value:5031},{label:5032,value:5032},{label:5034,value:5034},{label:5040,value:5040},{label:5058,value:5058},{label:5059,value:5059},{label:5060,value:5060},{label:5066,value:5066},{label:5075,value:5075},{label:5080,value:5080},{label:5083,value:5083},{label:5084,value:5084},{label:5085,value:5085},{label:5086,value:5086},{label:5087,value:5087},{label:5095,value:5095},{label:5096,value:5096},{label:5098,value:5098},{label:5122,value:5122},{label:5133,value:5133}]}],E={name:"Fault",data:function(){return{baseURL:c,classCarNumbers:R}},created:function(){},methods:{checkFault:function(e){console.log(e),this.$router.push({path:"/technician/faultcarnumberdetail",query:{tag:e}})}}},A={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",e._l(e.classCarNumbers,function(t){return a("div",{staticClass:"item"},[a("el-tag",{staticClass:"carNumber",attrs:{effect:"plain"}},[e._v(e._s(t.label))]),a("br"),e._v(" "),a("el-row",{attrs:{gutter:20}},e._l(t.children,function(t){return a("el-col",{key:t.lable,attrs:{span:4}},[a("div",{staticClass:"grid-content bg-purple"},[a("el-tag",{staticClass:"tag_item",on:{click:function(a){return e.checkFault(t.label)}}},[e._v(e._s(t.label))])],1)])}),1)],1)}),0)},staticRenderFns:[]};var P=a("VU/8")(E,A,!1,function(e){a("2qce")},"data-v-309a5de0",null).exports,U={name:"Fault",components:{Pagination:T},data:function(){return{carNumbers:[],carNumberList:S,baseURL:c,timeList:[],tableData:[],result:"",pageparm:{pageNo:1,pageSize:200},total:0,allList:[],loading:!0,teamsList:[],id:0}},created:function(){this.getFault(),this.getTeams()},computed:{indexMethod:function(){return(this.pageparm.pageNo-1)*this.pageparm.pageSize+1}},methods:{rowStyle:function(e){if(1==e.row.dimension)return{background:"antiquewhite"}},changeUpdate:function(){this.$forceUpdate()},changeResultSelect:function(){"全部"==this.pageparm.result&&delete this.pageparm.result},resetForm:function(e){this.$refs[e].resetFields(),this.timeList=[],delete this.pageparm.startTime,delete this.pageparm.endTime,this.pageparm.carNumbers&&delete this.pageparm.carNumbers,this.carNumbers=[]},getTeams:function(){var e=this;Object(s.a)({url:c+"/teams/selectall"}).then(function(t){e.teamsList=t.data.data,e.loading=!1}).catch(function(e){console.log(e)})},search:function(){var e=this;this.carNumbers.length&&(this.pageparm.carNumbers=this.carNumbers),this.loading=!0,this.timeList.length&&(this.pageparm.startTime=this.getYMDHMS(new Date(this.timeList[0].toString())),this.pageparm.endTime=this.getYMDHMS(new Date(this.timeList[1].toString()))),this.pageparm.pageNo=1,this.pageparm.pageSize=1e5,this.pageparm.carNumber=this.$route.query.tag,Object(s.a)({method:"post",url:c+"/fault/screenfault",data:this.pageparm}).then(function(t){e.tableData=t.data.data.list,e.tableData=e.tableData.map(function(t){return t.deliveryDate=e.getYMDHMS(t.deliveryDate),t.risk="0"==t.risk?0:parseInt(t.risk),t.code="null"==t.code?"":t.code,t.schedule="null"==t.schedule?"":t.schedule,t.respDepart="null"==t.respDepart?"":t.respDepart,t.notes="null"==t.notes?"":t.notes,t}),e.total=t.data.data.size,e.loading=!1,e.$message.success("搜索成功")}).catch(function(t){e.initPage(),e.getFault(),e.$message.error("搜索失败"),console.log(t)})},initPage:function(){this.pageparm={pageNo:1,pageSize:1e5}},getYMDHMS:function(e){var t=new Date(e);return t.getFullYear()+"-"+(t.getMonth()+1).toString().padStart(2,"0")+"-"+t.getDate().toString().padStart(2,"0")},exportExcel:function(){"全部"==this.pageparm.result&&delete this.pageparm.result,this.carNumbers.length&&(this.pageparm.carNumbers=this.carNumbers),this.timeList.length&&(this.pageparm.startTime=this.getYMDHMS(new Date(this.timeList[0].toString())),this.pageparm.endTime=this.getYMDHMS(new Date(this.timeList[1].toString()))),this.pageparm.carNumber=this.$route.query.tag;var e=c+"/fault/export?";for(var t in this.pageparm)this.pageparm[t]&&(e+=t+"="+this.pageparm[t]+"&");console.log(e),s.a.get(e).then(function(t){console.log(e),window.location.href=e})},callFather:function(e){this.pageparm.pageNo=e.pageNo,this.pageparm.pageSize=e.pageSize,this.getFault()},getFault:function(){var e=this;this.carNumbers.length&&(this.pageparm.carNumbers=this.carNumbers),Object(s.a)({url:c+"/fault/screenfaultCarnumberDetail",params:{carNumber:this.$route.query.tag,pageNo:this.pageparm.pageNo,pageSize:this.pageparm.pageSize}}).then(function(t){e.tableData=t.data.data.list||[],e.tableData=e.tableData.map(function(t){return t.deliveryDate=e.getYMDHMS(t.deliveryDate),t.risk="0"==t.risk?parseInt(0):parseInt(t.risk),t.code="null"==t.code?"":t.code,t.schedule="null"==t.schedule?"":t.schedule,t.respDepart="null"==t.respDepart?"":t.respDepart,t.notes="null"==t.notes?"":t.notes,t}),e.total=t.data.data.size,e.loading=!1}).catch(function(e){console.log(e)})},deleteById:function(e){var t=this;this.$confirm("此操作将永久删除, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:c+"/fault/deletefaultid",params:{id:e.id}}).then(function(e){t.$message({message:"删除成功",type:"success"}),t.getFault()}).catch(function(e){console.log(e)})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},handleUploadSuccess:function(e){this.uploadUrlPath=N()(e),this.loading.close()},handleBeforeUpload:function(){this.loading=this.$loading({lock:!0,text:"上传中",background:"rgba(0, 0, 0, 0.7)"})},handleUploadError:function(){this.$message({type:"error",message:"上传失败"}),this.loading.close()},handleRemove:function(e,t){console.log(e,t)},handlePreview:function(e){console.log(e)},handleExceed:function(e,t){this.$message.warning("当前限制选择文件个数，本次选择了 "+e.length+" 个文件，共选择了 "+(e.length+t.length)+" 个文件")},beforeRemove:function(e,t){return this.$confirm("确定移除 "+e.name+"？")},handleSuccess:function(){this.getFault(),this.$message.success("导入成功")},handleError:function(){this.getFault(),this.$message.error("导入格式错误，请修改后重新导入！")},changeDimension:function(e,t){var a=this;this.$confirm("此操作将数据列为重点故障，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:" "+c+"/fault/changedimension",params:{id:e,dimension:t}}).then(function(e){a.$message.success("成功"),a.search()}).catch(function(e){a.$message.error("失败")})}).catch(function(){a.$message({type:"info",message:"已取消"})})},handleSizeChange:function(e){this.pageparm.pageSize=e,this.getFault(),document.querySelector(".el-main").scrollTo(0,0),console.log("每页 "+e+" 条")},handleCurrentChange:function(e){this.pageparm.pageNo=e,this.getFault(),document.querySelector(".el-main").scrollTo(0,0),console.log("当前页: "+e)}}},H={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-breadcrumb",{staticClass:"breadcrumb",attrs:{separator:"/"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/technician/faultcarnumber"}}},[e._v("返回")]),e._v(" "),a("el-breadcrumb-item",{staticStyle:{"font-size":"36px"}},[a("b",[e._v(e._s(this.$route.query.tag))])])],1),e._v(" "),a("el-upload",{staticClass:"upload-demo",attrs:{action:e.baseURL+"/fault/importcar","on-preview":e.handlePreview,"on-remove":e.handleRemove,"before-remove":e.beforeRemove,multiple:"","on-exceed":e.handleExceed,"on-success":e.handleSuccess,"on-error":e.handleError}},[a("el-button",{attrs:{size:"small",type:"warning",icon:"el-icon-star-on"}},[e._v("导入")])],1),a("br"),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"",height:"700","row-style":e.rowStyle}},[a("el-table-column",{attrs:{type:"index",label:"序号",align:"center",width:"70",index:e.indexMethod,fixed:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"deliveryDate",label:"交修日期",width:"100",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"carNumber",label:"车号",width:"70",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"carBodyNumber",label:"车厢号",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"faultDescription",label:"故障描述",width:"180",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"teamsGroups",label:"处理班组",width:"100",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"result",label:"处理结果",width:"180",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s("null"==t.row.result?"":t.row.result)+"\n            ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"method",label:"处理方法",width:"200",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s("null"==t.row.method?"":t.row.method)+"\n            ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"source",label:"故障来源",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s("null"==t.row.source?"":t.row.source)+"\n            ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"handle",label:"处置分类",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s("null"==t.row.handle?"":t.row.handle)+"\n            ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"",label:"操作",width:"180",align:"center",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(a){return e.deleteById(t.row)}}}),e._v(" "),1==t.row.dimension?a("el-button",{attrs:{type:"warning",icon:"el-icon-warning",circle:""},on:{click:function(a){return e.changeDimension(t.row.id,0)}}}):a("el-button",{attrs:{icon:"el-icon-warning-outline",circle:""},on:{click:function(a){return e.changeDimension(t.row.id,1)}}})]}}])})],1),e._v(" "),a("el-pagination",{attrs:{"current-page":e.currentPage4,"page-sizes":[200,300,400],"page-size":100,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)},staticRenderFns:[]};var Y=a("VU/8")(U,H,!1,function(e){a("tuiz")},"data-v-1ee94b9c",null).exports,Q=a("BO1k"),G=a.n(Q),W=a("yPE/"),K=a.n(W),X=(a("3f40"),a("4qOc"),a("+cgv"),a("G0J2")),Z=a("AJTU"),J=a.n(Z),ee=a("37tQ");K.a.register("modules/imageResize",J.a),K.a.register("modules/imageDrop",ee.a);var te={components:{quillEditor:X.quillEditor},name:"Editor",props:{value:{type:String,default:""},height:{type:Number,default:null},minHeight:{type:Number,default:null},readOnly:{type:Boolean,default:!1},fileSize:{type:Number,default:5},type:{type:String,default:"url"}},data:function(){return{baseURL:c,id:0,editForm:{},msg:"",content:"",editorOption:{placeholder:"请输入需要编写的内容...",modules:{imageDrop:!0,imageResize:{displayStyles:{backgroundColor:"black",border:"none",color:"white"},modules:["Resize","DisplaySize","Toolbar"]},toolbar:[["bold","italic","underline","strike","blockquote","code-block",{header:1},{header:2},{list:"ordered"},{list:"bullet"},{indent:"-1"},{indent:"+1"},{align:[]},{color:[]},{background:[]},"image"],[{size:["small",!1,"large","huge"]}],[{header:[1,2,3,4,5,6,!1]}]]}}}},created:function(){this.id=this.$route.query.id,console.log(this.id),this.getRich()},methods:{onEditorBlur:function(e){},onEditorFocus:function(){},onEditorReady:function(){},onEditorChange:function(){},goBack:function(){this.$router.back(-1)},getRich:function(){var e=this;Object(s.a)({method:"post",url:c+"/fault/screenfault",data:{pageNo:1,pageSize:1e5,id:this.id}}).then(function(t){var a=t.data.data.list[0].rich;e.editForm=t.data.data.list[0],a&&(e.content=a)}).catch(function(t){e.initPage(),e.getFault(),e.$message.error("搜索失败"),console.log(t)})},handelFault:function(){var e=this;this.editForm=w()({},this.editForm,{rich:this.content}),Object(s.a)({url:c+"/fault/updatefaultid",method:"post",data:this.editForm}).then(function(t){e.editFormVisible=!1,e.editForm={},e.risk=0,e.$message.success("修改成功")}).catch(function(t){console.log(t),e.$message.error("请重新提交")})}},watch:{content:function(){}},mounted:function(){var e=!0,t=!1,a=void 0;try{for(var l,r=G()([{Choice:".ql-insertMetric",title:"跳转配置"},{Choice:".ql-bold",title:"加粗"},{Choice:".ql-italic",title:"斜体"},{Choice:".ql-underline",title:"下划线"},{Choice:".ql-header",title:"段落格式"},{Choice:".ql-strike",title:"删除线"},{Choice:".ql-blockquote",title:"块引用"},{Choice:".ql-code",title:"插入代码"},{Choice:".ql-code-block",title:"插入代码段"},{Choice:".ql-font",title:"字体"},{Choice:".ql-size",title:"字体大小"},{Choice:'.ql-list[value="ordered"]',title:"编号列表"},{Choice:'.ql-list[value="bullet"]',title:"项目列表"},{Choice:".ql-direction",title:"文本方向"},{Choice:'.ql-header[value="1"]',title:"h1"},{Choice:'.ql-header[value="2"]',title:"h2"},{Choice:".ql-align",title:"对齐方式"},{Choice:".ql-color",title:"字体颜色"},{Choice:".ql-background",title:"背景颜色"},{Choice:".ql-image",title:"图像"},{Choice:".ql-video",title:"视频"},{Choice:".ql-link",title:"添加链接"},{Choice:".ql-formula",title:"插入公式"},{Choice:".ql-clean",title:"清除字体格式"},{Choice:'.ql-script[value="sub"]',title:"下标"},{Choice:'.ql-script[value="super"]',title:"上标"},{Choice:'.ql-indent[value="-1"]',title:"向左缩进"},{Choice:'.ql-indent[value="+1"]',title:"向右缩进"},{Choice:".ql-header .ql-picker-label",title:"标题大小"},{Choice:'.ql-header .ql-picker-item[data-value="1"]',title:"标题一"},{Choice:'.ql-header .ql-picker-item[data-value="2"]',title:"标题二"},{Choice:'.ql-header .ql-picker-item[data-value="3"]',title:"标题三"},{Choice:'.ql-header .ql-picker-item[data-value="4"]',title:"标题四"},{Choice:'.ql-header .ql-picker-item[data-value="5"]',title:"标题五"},{Choice:'.ql-header .ql-picker-item[data-value="6"]',title:"标题六"},{Choice:".ql-header .ql-picker-item:last-child",title:"标准"},{Choice:'.ql-size .ql-picker-item[data-value="small"]',title:"小号"},{Choice:'.ql-size .ql-picker-item[data-value="large"]',title:"大号"},{Choice:'.ql-size .ql-picker-item[data-value="huge"]',title:"超大号"},{Choice:".ql-size .ql-picker-item:nth-child(2)",title:"标准"},{Choice:".ql-align .ql-picker-item:first-child",title:"居左对齐"},{Choice:'.ql-align .ql-picker-item[data-value="center"]',title:"居中对齐"},{Choice:'.ql-align .ql-picker-item[data-value="right"]',title:"居右对齐"},{Choice:'.ql-align .ql-picker-item[data-value="justify"]',title:"两端对齐"},{Choice:".ql-upload",title:"上传文件"},{Choice:".ql-table",title:"插入表格"},{Choice:".ql-table-insert-row",title:"插入行"},{Choice:".ql-table-insert-column",title:"插入列"},{Choice:".ql-table-delete-row",title:"删除行"},{Choice:".ql-table-delete-column",title:"删除列"}]);!(e=(l=r.next()).done);e=!0){var o=l.value,i=document.querySelector(".quill-editor "+o.Choice);i&&i.setAttribute("title",o.title)}}catch(e){t=!0,a=e}finally{try{!e&&r.return&&r.return()}finally{if(t)throw a}}}},ae={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-page-header",{attrs:{content:"编辑页面"},on:{back:e.goBack}}),e._v(" "),a("br"),e._v(" "),a("quill-editor",{ref:"myQuillEditor",attrs:{options:e.editorOption},on:{blur:function(t){return e.onEditorBlur(t)},focus:function(t){return e.onEditorFocus(t)},ready:function(t){return e.onEditorReady(t)},change:function(t){return e.onEditorChange(t)}},model:{value:e.content,callback:function(t){e.content=t},expression:"content"}}),e._v(" "),a("el-button",{staticClass:"title",attrs:{size:"small",type:"primary"},on:{click:function(t){return e.handelFault()}}},[e._v("保存")])],1)},staticRenderFns:[]};var le=a("VU/8")(te,ae,!1,function(e){a("ujId")},"data-v-77b4ff29",null).exports,re={name:"rickcheck",data:function(){return{baseURL:c,msg:"",isShow:!1,id:0}},created:function(){this.id=this.$route.query.id,console.log(this.id),this.getRich()},methods:{goBack:function(){this.$router.back(-1)},getRich:function(){var e=this;Object(s.a)({method:"post",url:c+"/fault/screenfault",data:{pageNo:1,pageSize:1e5,id:this.id}}).then(function(t){var a=t.data.data.list[0].rich;a&&(e.isShow=!0,e.msg=a),e.$message.success("搜索成功")}).catch(function(t){e.initPage(),e.getFault(),e.$message.error("搜索失败"),console.log(t)})}},watch:{}},oe={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("el-page-header",{attrs:{content:"详情页面"},on:{back:this.goBack}}),this._v(" "),t("br"),this._v(" "),this.isShow?t("div",{staticClass:"ql-editor",domProps:{innerHTML:this._s(this.msg)}}):t("div",[t("el-empty",{attrs:{"image-size":300,description:"暂无内容"}})],1)],1)},staticRenderFns:[]};var ie=a("VU/8")(re,oe,!1,function(e){a("vFDb")},"data-v-e6715d30",null).exports,ne={name:"FaultDecorate",components:{Pagination:T},data:function(){return{carNumbers:[],risks:[],carNumberList:S,baseURL:c,timeList:[],tableData:[],editFormVisible:!1,dialogTrackVisible:!1,title:"编辑",editForm:x()({code:"无",schedule:"无",respDepart:"无",review:"0"},"review",""),editTrackForm:{},risk:0,result:"",rules:{deliveryDate:[{required:!0,message:"请输入日期",trigger:"blur"}],carNumber:[{required:!0,message:"请输入车号",trigger:"blur"}],carBodyNumber:[{required:!0,message:"请输入车厢号",trigger:"blur"}],faultDescription:[{required:!0,message:"请输入故障描述",trigger:"blur"}],teamsGroups:[{required:!0,message:"请选择班组",trigger:"blur"}],funClass:[{required:!0,message:"请选择功能分类",trigger:"blur"}],handle:[{required:!0,message:"请选择处置分类",trigger:"blur"}],method:[{required:!0,message:"请输入处理方法",trigger:"blur"}],source:[{required:!0,message:"请输入故障来源",trigger:"blur"}],material:[{required:!0,message:"请选择到料情况",trigger:"blur"}]},trackRules:{trackPerson:[{required:!0,message:"请输入责任人",trigger:"blur"}],trackRequire:[{required:!0,message:"请输入追踪要求",trigger:"blur"}],feedback:[{required:!0,message:"请输入反馈实现",trigger:"blur"}]},pageparm:{pageNo:1,pageSize:1e4,result:"未处理",state:"4"},total:0,allList:[],loading:!0,teamsList:[],riskList:[{label:"⭐",value:1},{label:"⭐⭐",value:2},{label:"⭐⭐⭐",value:3}],id:0,uploadModalVisible:!1,fileList:[],dialogVisible:!1,attachmentList:[],previewDialogVisible:!1,previewFile:"",fault:{},deleteParams:{}}},created:function(){this.getFault(),this.getTeams()},computed:{indexMethod:function(){return(this.pageparm.pageNo-1)*this.pageparm.pageSize+1}},methods:{changeInput:function(e){this.$forceUpdate()},rowStyle:function(e){var t=e.row;return 1==t.dimension?{background:"antiquewhite"}:1==t.review?{background:"rgb(159 199 159)"}:void 0},changeUpdate:function(){this.$forceUpdate()},changeResultSelect:function(){"全部"==this.pageparm.result&&delete this.pageparm.result},resetForm:function(e){this.$refs[e].resetFields(),this.timeList=[],delete this.pageparm.startTime,delete this.pageparm.endTime,this.pageparm.carNumbers&&delete this.pageparm.carNumbers,this.carNumbers=[],this.pageparm.risks&&delete this.pageparm.risks,this.risks=[]},getTeams:function(){var e=this;Object(s.a)({url:c+"/teams/selectall"}).then(function(t){e.teamsList=t.data.data,e.loading=!1}).catch(function(e){console.log(e)})},search:function(){var e=this;this.carNumbers.length&&(this.pageparm.carNumbers=this.carNumbers),this.risks.length&&(this.pageparm.risks=this.risks),this.loading=!0,this.timeList.length&&(this.pageparm.startTime=this.getYMDHMS(new Date(this.timeList[0].toString())),this.pageparm.endTime=this.getYMDHMS(new Date(this.timeList[1].toString()))),this.pageparm.pageNo=1,Object(s.a)({method:"post",url:c+"/fault/screenfault",data:w()({},this.pageparm,{pageNo:this.pageparm.pageNo,pageSize:this.pageparm.pageSize})}).then(function(t){e.tableData=t.data.data.list,e.tableData=e.tableData.map(function(t){return t.deliveryDate=e.getYMDHMS(t.deliveryDate),t.risk="0"==t.risk?0:parseInt(t.risk),t.code="null"==t.code?"":t.code,t.schedule="null"==t.schedule?"":t.schedule,t.respDepart="null"==t.respDepart?"":t.respDepart,t.notes="null"==t.notes?"":t.notes,t}),e.total=t.data.data.size,e.loading=!1,e.$message.success("搜索成功")}).catch(function(t){e.initPage(),e.getFault(),e.$message.error("搜索失败")})},searchCurrent:function(){var e=this;this.carNumbers.length&&(this.pageparm.carNumbers=this.carNumbers),this.risks.length&&(this.pageparm.risks=this.risks),this.loading=!0,this.timeList.length&&(this.pageparm.startTime=this.getYMDHMS(new Date(this.timeList[0].toString())),this.pageparm.endTime=this.getYMDHMS(new Date(this.timeList[1].toString()))),this.pageparm.pageNo=1,this.pageparm.pageSize=1e4,Object(s.a)({method:"post",url:c+"/fault/screenfault",data:this.pageparm}).then(function(t){e.tableData=t.data.data.list,e.tableData=e.tableData.map(function(t){return t.deliveryDate=e.getYMDHMS(t.deliveryDate),t.risk="0"==t.risk?0:parseInt(t.risk),t.code="null"==t.code?"":t.code,t.schedule="null"==t.schedule?"":t.schedule,t.respDepart="null"==t.respDepart?"":t.respDepart,t.notes="null"==t.notes?"":t.notes,t}),e.total=t.data.data.size,e.loading=!1,e.$message.success("搜索成功")}).catch(function(t){e.initPage(),e.getFault(),e.$message.error("搜索失败")})},initPage:function(){this.pageparm={pageNo:1,pageSize:1e4,state:0,result:"未处理"}},getYMDHMS:function(e){var t=new Date(e);return t.getFullYear()+"-"+(t.getMonth()+1).toString().padStart(2,"0")+"-"+t.getDate().toString().padStart(2,"0")},exportExcel:function(){"全部"==this.pageparm.result&&delete this.pageparm.result,this.carNumbers.length&&(this.pageparm.carNumbers=this.carNumbers),this.timeList.length&&(this.pageparm.startTime=this.getYMDHMS(new Date(this.timeList[0].toString())),this.pageparm.endTime=this.getYMDHMS(new Date(this.timeList[1].toString()))),this.risks.length&&(this.pageparm.risks=this.risks);var e=c+"/fault/export?";for(var t in this.pageparm)this.pageparm[t]&&(e+=t+"="+this.pageparm[t]+"&");console.log(e),s.a.get(e).then(function(t){console.log(e),window.location.href=e})},callFather:function(e){this.pageparm.pageNo=e.pageNo,this.pageparm.pageSize=e.pageSize,this.searchCurrent(),document.querySelector(".el-main").scrollTo(0,0)},getFault:function(){var e=this;this.carNumbers.length&&(this.pageparm.carNumbers=this.carNumbers),Object(s.a)({method:"post",url:c+"/fault/screenfault",data:{result:"未处理",state:"4",pageNo:this.pageparm.pageNo,pageSize:this.pageparm.pageSize}}).then(function(t){e.tableData=t.data.data.list||[],e.tableData=e.tableData.map(function(t){return t.deliveryDate=e.getYMDHMS(t.deliveryDate),t.risk="0"==t.risk?parseInt(0):parseInt(t.risk),t.code="null"==t.code?"":t.code,t.schedule="null"==t.schedule?"":t.schedule,t.respDepart="null"==t.respDepart?"":t.respDepart,t.notes="null"==t.notes?"":t.notes,t}),e.total=t.data.data.size,e.loading=!1}).catch(function(e){console.log(e)})},deleteById:function(e){var t=this;this.$confirm("此操作将永久删除, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:c+"/fault/deletefaultid",params:{id:e.id}}).then(function(e){t.$message({message:"删除成功",type:"success"}),t.search()}).catch(function(e){console.log(e)})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},handleEdit:function(e,t){console.log(t),this.editFormVisible=!0,void 0!=t&&"undefined"!=t?(this.title="修改",this.editForm=t,"未处理"!=this.editForm.result&"长期跟踪"!=this.editForm.result?this.result="已处理":"未处理"==this.editForm.result?this.result="未处理":"长期跟踪"==this.editForm.result&&(this.result="长期跟踪"),this.risk=t.risk):(this.title="添加",this.editForm={review:"0",code:"无",schedule:"无",respDepart:"无",notes:"无"},this.result="")},changeResult:function(){this.editForm.result=""},handelFault:function(){var e=this;this.$refs.editForm.validate(function(t){if(!t)return console.log("提交失败"),!1;if("已处理"!=e.result&&(e.editForm.result=e.result),e.editForm.risk=e.risk,"添加"==e.title)e.editForm.result?(e.editForm.dimension="0",Object(s.a)({url:c+"/fault/insertfault",method:"post",data:e.editForm}).then(function(t){e.$message({message:e.title+"成功",type:"success"}),e.editFormVisible=!1,e.editForm={},e.risk=0,e.initPage(),e.search()}).catch(function(t){console.log(t),e.$message({message:e.title+"失败",type:"error"}),e.editFormVisible=!1,e.editForm={},e.risk=0,e.initPage(),e.search()})):e.$message.error("请选择处理结果");else{for(var a in e.editForm)!e.editForm[a]&"risk"!=a&&(e.editForm[a]="null");Object(s.a)({url:c+"/fault/updatefaultid",method:"post",data:e.editForm}).then(function(t){e.editFormVisible=!1,e.editForm={},e.risk=0,e.$message.success("修改成功")}).catch(function(t){console.log(t),e.$message.error("请重新提交")})}})},closeDialog:function(){this.editFormVisible=!1,this.editForm={},this.risk=0},handleUploadSuccess:function(e){this.uploadUrlPath=N()(e),this.loading.close()},handleBeforeUpload:function(){this.loading=this.$loading({lock:!0,text:"上传中",background:"rgba(0, 0, 0, 0.7)"})},handleUploadError:function(){this.$message({type:"error",message:"上传失败"}),this.loading.close()},handleRemove:function(e,t){console.log(e,t)},handlePreview:function(e){console.log(e)},handleExceed:function(e,t){this.$message.warning("当前限制选择文件个数，本次选择了 "+e.length+" 个文件，共选择了 "+(e.length+t.length)+" 个文件")},beforeRemove:function(e,t){return this.$confirm("确定移除 "+e.name+"？")},handleSuccess:function(){this.getFault(),this.$message.success("导入成功")},handleError:function(){this.getFault(),this.$message.error("导入格式错误，请修改后重新导入！")},resetRisk:function(){this.risk=0},changState:function(e,t){var a=this;this.$confirm("此操作将数据提交, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:" "+c+"/fault/changestate",params:{id:e,state:t}}).then(function(e){a.$message.success("已转移到故障遗留列表"),a.search()}).catch(function(e){a.$message.error("重新提交")})}).catch(function(){a.$message({type:"info",message:"已取消提交"})})},changeTrack:function(){var e=this;this.$refs.editTrackForm.validate(function(t){if(!t)return console.log("请输入责任人"),!1;e.$confirm("此操作将数据提交到故障追踪列表, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:" "+c+"/fault/changestate",params:{id:e.id,state:2,trackPerson:e.editTrackForm.trackPerson,trackRequire:e.editTrackForm.trackRequire,feedback:"请责任人填写"}}).then(function(t){e.$message.success("已转移到故障追踪列表"),e.search(),e.dialogTrackVisible=!1,e.editTrackForm={}}).catch(function(t){e.$message.error("请重新提交"),e.editTrackForm={}})}).catch(function(){e.$message({type:"info",message:"已取消提交"})})})},changeDimension:function(e,t){var a=this;this.$confirm("此操作将数据列为重点故障，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:" "+c+"/fault/changedimension",params:{id:e,dimension:t}}).then(function(e){a.$message.success("成功"),a.search()}).catch(function(e){a.$message.error("失败")})}).catch(function(){a.$message({type:"info",message:"已取消"})})},handleTrack:function(e){this.dialogTrackVisible=!0,this.id=e},handleClose:function(){this.editTrackForm={},this.dialogTrackVisible=!1},handleMethod:function(){"修改"==this.title&&(this.editForm.handle="")},showUploadModal:function(e){this.fault.id=e.id,this.uploadModalVisible=!0},beforeClose:function(e){e()},upload:function(){this.$refs.refName.clearFiles(),this.uploadModalVisible=!1},handleFileSuccess:function(e,t,a){200!==e.code?(this.$message.error(e.msg),this.$refs.refName.uploadFiles.splice(this.$refs.refName.uploadFiles.indexOf(t),1)):this.$message.success("上传成功")},handleFileError:function(e,t,a){this.$message.error("文件超出大小限制，上传失败，请联系管理员!"),this.$refs.refName.uploadFiles.splice(this.$refs.refName.uploadFiles.indexOf(t),1),this.$refs.refName.clearFiles()},showModal:function(e){var t=this;Object(s.a)({url:c+"/fault/fileList/"+e,method:"get"}).then(function(e){t.dialogVisible=!0,t.attachmentList=e.data.data||[]})},handleCloseFile:function(e){e()},downloadAttachment:function(e){console.log("下载附件",e),D(c+"/fault/download/"+e.faultFileMidId,e.fileName)},deleteAttachment:function(e){var t=this;console.log("删除附件",e),this.deleteParams={fileId:e.fileId,faultFileMidId:e.faultFileMidId},this.$confirm("点击后删除，是否确定？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:c+"/fault/deleteFile",method:"post",data:t.deleteParams}).then(function(a){console.log(a),200!==a.data.code?t.$message.error(a.data.msg):(t.$message.success("操作成功!"),t.showModal(e.faultId))}).catch(function(e){t.$message.error(e)})})},handleFileNameClick:function(e){var t=this;console.log("点击文件名",e),this.$confirm("点击后下载，是否确定？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:c+"/fault/getFileInfo/"+e.fileId,method:"get"}).then(function(a){console.log(a),200!==a.data.code&&(t.$message.error(a.data.msg),t.showModal(e.faultId)),D(c+"/fault/download/"+e.faultFileMidId,e.fileName)}).catch(function(e){t.$message.error(e)})})},handleSizeChange:function(e){this.pageparm.pageSize=e,this.getFault(),document.querySelector(".el-main").scrollTo(0,0),console.log("每页 "+e+" 条")},handleCurrentChange:function(e){this.pageparm.pageNo=e,this.getFault(),document.querySelector(".el-main").scrollTo(0,0),console.log("当前页: "+e)},goTeam:function(){this.$router.push({path:"/teams/index"})}}},se={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-upload",{staticClass:"upload-demo",attrs:{action:e.baseURL+"/fault/import","on-preview":e.handlePreview,"on-remove":e.handleRemove,"before-remove":e.beforeRemove,multiple:"","on-exceed":e.handleExceed,"on-success":e.handleSuccess,"on-error":e.handleError}},[a("el-button",{attrs:{size:"small",type:"warning",icon:"el-icon-star-on"}},[e._v("导入")])],1),e._v(" "),a("br"),a("br"),e._v(" "),a("el-form",{ref:"searchForm",staticClass:"user-search",attrs:{inline:!0,model:e.pageparm}},[a("el-form-item",{attrs:{label:"处理结果：",prop:"result"}},[a("el-select",{attrs:{placeholder:"请选择处理结果"},on:{change:e.changeResultSelect},model:{value:e.pageparm.result,callback:function(t){e.$set(e.pageparm,"result",t)},expression:"pageparm.result"}},[a("el-option",{attrs:{label:"全部",value:"全部"}}),e._v(" "),a("el-option",{attrs:{label:"未处理",value:"未处理"}}),e._v(" "),a("el-option",{attrs:{label:"已处理",value:"已处理"}}),e._v(" "),a("el-option",{attrs:{label:"长期跟踪",value:"长期跟踪"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"标注",prop:"dimension"}},[a("el-select",{attrs:{placeholder:"请选择"},on:{change:e.changeUpdate},model:{value:e.pageparm.dimension,callback:function(t){e.$set(e.pageparm,"dimension",t)},expression:"pageparm.dimension"}},[a("el-option",{attrs:{label:"非重点关注",value:"0"}}),e._v(" "),a("el-option",{attrs:{label:"重点关注",value:"1"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"复核",prop:"review"}},[a("el-select",{attrs:{placeholder:"请选择"},on:{change:function(t){return e.changeInput(t)}},model:{value:e.pageparm.review,callback:function(t){e.$set(e.pageparm,"review",t)},expression:"pageparm.review"}},[a("el-option",{attrs:{label:"否",value:"0"}}),e._v(" "),a("el-option",{attrs:{label:"是",value:"1"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"车号",prop:"carNumber"}},[a("el-select",{attrs:{multiple:"",filterable:"",placeholder:"请选择车号"},on:{change:function(t){return e.changeInput(t)}},model:{value:e.carNumbers,callback:function(t){e.carNumbers=t},expression:"carNumbers"}},e._l(e.carNumberList,function(e){return a("el-option",{key:e.value,attrs:{label:e.value,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"车厢号",prop:"carBodyNumber"}},[a("el-input",{attrs:{size:"small",placeholder:"输入车厢号"},on:{input:function(t){return e.changeInput(t)}},model:{value:e.pageparm.carBodyNumber,callback:function(t){e.$set(e.pageparm,"carBodyNumber",t)},expression:"pageparm.carBodyNumber"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"交修日期"}},[a("el-col",{attrs:{span:11}},[a("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.timeList,callback:function(t){e.timeList=t},expression:"timeList"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"故障描述：",prop:"faultDescription"}},[a("el-input",{attrs:{size:"small",placeholder:"输入故障描述"},on:{input:function(t){return e.changeInput(t)}},model:{value:e.pageparm.faultDescription,callback:function(t){e.$set(e.pageparm,"faultDescription",t)},expression:"pageparm.faultDescription"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"故障来源：",prop:"source"}},[a("el-input",{attrs:{size:"small",placeholder:"输入故障来源"},on:{input:function(t){return e.changeInput(t)}},model:{value:e.pageparm.source,callback:function(t){e.$set(e.pageparm,"source",t)},expression:"pageparm.source"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"处理方法：",prop:"method"}},[a("el-input",{attrs:{size:"small",placeholder:"输入处理方法"},on:{input:function(t){return e.changeInput(t)}},model:{value:e.pageparm.method,callback:function(t){e.$set(e.pageparm,"method",t)},expression:"pageparm.method"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"处理班组",prop:"teamsGroups"}},[a("el-select",{attrs:{placeholder:"请选择处理班组"},on:{change:e.changeUpdate},model:{value:e.pageparm.teamsGroups,callback:function(t){e.$set(e.pageparm,"teamsGroups",t)},expression:"pageparm.teamsGroups"}},e._l(e.teamsList,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.name}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"功能分类",prop:"funClass"}},[a("el-select",{attrs:{placeholder:"请选择功能分类"},on:{change:e.changeUpdate},model:{value:e.pageparm.funClass,callback:function(t){e.$set(e.pageparm,"funClass",t)},expression:"pageparm.funClass"}},[a("el-option",{attrs:{label:"整车",value:"整车"}}),e._v(" "),a("el-option",{attrs:{label:"车体",value:"车体"}}),e._v(" "),a("el-option",{attrs:{label:"车端连接",value:"车端连接"}}),e._v(" "),a("el-option",{attrs:{label:"转向架及其辅助",value:"转向架及其辅助"}}),e._v(" "),a("el-option",{attrs:{label:"主供电",value:"主供电"}}),e._v(" "),a("el-option",{attrs:{label:"牵引",value:"牵引"}}),e._v(" "),a("el-option",{attrs:{label:"辅助电气",value:"辅助电气"}}),e._v(" "),a("el-option",{attrs:{label:"供风制动",value:"供风制动"}}),e._v(" "),a("el-option",{attrs:{label:"网络及辅助监控",value:"网络及辅助监控"}}),e._v(" "),a("el-option",{attrs:{label:"旅客信息",value:"旅客信息"}}),e._v(" "),a("el-option",{attrs:{label:"空调",value:"空调"}}),e._v(" "),a("el-option",{attrs:{label:"给排水卫生",value:"给排水卫生"}}),e._v(" "),a("el-option",{attrs:{label:"外门及车内设施",value:"外门及车内设施"}}),e._v(" "),a("el-option",{attrs:{label:"驾驶设施",value:"驾驶设施"}}),e._v(" "),a("el-option",{attrs:{label:"电务车载",value:"电务车载"}}),e._v(" "),a("el-option",{attrs:{label:"其他",value:"其他"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"处置分类",prop:"handle"}},[a("el-input",{attrs:{size:"small",placeholder:"输入处置分类"},on:{input:function(t){return e.changeInput(t)}},model:{value:e.pageparm.handle,callback:function(t){e.$set(e.pageparm,"handle",t)},expression:"pageparm.handle"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"风险等级",prop:"risk"}},[a("el-select",{attrs:{multiple:"",filterable:"",placeholder:"请选择风险等级"},on:{change:e.changeUpdate},model:{value:e.risks,callback:function(t){e.risks=t},expression:"risks"}},[a("el-option",{attrs:{label:"无风险",value:0}}),e._v(" "),e._l(e.riskList,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}},[a("span",{staticStyle:{float:"left"}},[a("el-rate",{attrs:{max:t.value,disabled:""},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}})],1)])})],2)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-search"},on:{click:function(t){return e.search()}}},[e._v("搜索")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-refresh-right"},on:{click:function(t){return e.resetForm("searchForm")}}},[e._v("重置")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-plus"},on:{click:function(t){return e.handleEdit()}}},[e._v("添加")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"warning",icon:"el-icon-star-off"},on:{click:function(t){return e.exportExcel()}}},[e._v("导出")])],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"",height:"600","row-style":e.rowStyle}},[a("el-table-column",{attrs:{type:"index",label:"序号",align:"center",width:"70",index:e.indexMethod,fixed:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"deliveryDate",label:"交修日期",width:"100",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"carNumber",label:"车号",width:"70",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"carBodyNumber",label:"车厢号",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"faultDescription",label:"故障描述",width:"180",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"teamsGroups",label:"处理班组",width:"100",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"result",label:"处理结果",width:"180",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s("null"==t.row.result?"":t.row.result)+"\n            ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"method",label:"处理方法",width:"200",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s("null"==t.row.method?"":t.row.method)+"\n            ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"material",label:"是否到料",width:"100",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"source",label:"故障来源",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s("null"==t.row.source?"":t.row.source)+"\n            ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"funClass",label:"功能分类",width:"130",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s("null"==t.row.funClass?"":t.row.funClass)+"\n            ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"risk",label:"风险等级",width:"180",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-rate",{attrs:{max:3,disabled:""},model:{value:t.row.risk,callback:function(a){e.$set(t.row,"risk",a)},expression:"scope.row.risk"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"handle",label:"处置分类",width:"150",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s("null"==t.row.handle?"":t.row.handle)+"\n            ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"notes",label:"备注",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s("null"==t.row.notes?"":t.row.notes)+"\n            ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"notes",label:"查看",align:"center",width:"130"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticClass:"icon-button",on:{click:function(a){return e.showModal(t.row.id)}}},[a("i",{staticClass:"el-icon-view"}),e._v("\n                    查看附件\n                ")])]}}])},[e._v(" "),a("el-dialog",{attrs:{title:"附件列表",visible:e.dialogVisible,width:"40%","before-close":e.handleCloseFile,"append-to-body":""},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.attachmentList}},[a("el-table-column",{attrs:{prop:"fileName",align:"center",label:"名称"},scopedSlots:e._u([{key:"default",fn:function(t){var l=t.row;return[a("el-link",{on:{click:function(t){return e.handleFileNameClick(l)}}},[e._v(e._s(l.fileName))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"fileType",align:"center",label:"类型"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var l=t.row;return[a("el-button",{attrs:{type:"primary",icon:"el-icon-download"},on:{click:function(t){return e.downloadAttachment(l)}}}),e._v(" "),a("el-button",{attrs:{type:"danger",icon:"el-icon-delete"},on:{click:function(t){return e.deleteAttachment(l)}}})]}}])})],1)],1)],1),e._v(" "),a("el-table-column",{attrs:{prop:"",label:"删除",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(a){return e.deleteById(t.row)}}})]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"",label:"附件",width:"120",align:"center",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticStyle:{"margin-top":"5px"}},[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(a){return e.showUploadModal(t.row)}}},[e._v("点击上传")])],1)]}}])}),e._v(" "),a("el-dialog",{attrs:{title:"文件上传",visible:e.uploadModalVisible,width:"650px","before-close":e.beforeClose,"append-to-body":"","show-close":!1,"close-on-click-modal":!1},on:{"update:visible":function(t){e.uploadModalVisible=t}}},[a("el-upload",{ref:"refName",staticClass:"uploadFile",attrs:{action:e.baseURL+"/fault/upload","on-success":e.handleFileSuccess,"on-error":e.handleFileError,"file-list":e.fileList,data:e.fault,drag:"",multiple:""}},[a("i",{staticClass:"el-icon-upload"}),e._v(" "),a("div",{staticClass:"el-upload__text"},[e._v("将文件拖到此处，或"),a("em",[e._v("点击上传")])])]),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.upload}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.upload}},[e._v("确 定")])],1)],1),e._v(" "),a("el-table-column",{attrs:{prop:"",label:"操作",width:"180",align:"center",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary",icon:"el-icon-edit",circle:""},on:{click:function(a){return e.handleEdit(t.$index,t.row)}}}),e._v(" "),a("el-tooltip",{attrs:{content:"移交故障遗留列表",placement:"top"}},[a("el-button",{attrs:{type:"success",icon:"el-icon-bottom",circle:""},on:{click:function(a){return e.changState(t.row.id,0)}}})],1),e._v(" "),a("el-tooltip",{attrs:{content:"移交高级修列表",placement:"top"}},[a("el-button",{attrs:{type:"success",icon:"el-icon-top",circle:""},on:{click:function(a){return e.changState(t.row.id,1)}}})],1)]}}])})],1),e._v(" "),a("Pagination",{attrs:{"child-msg":e.pageparm,total:e.total},on:{callFather:e.callFather}}),e._v(" "),a("el-dialog",{attrs:{title:e.title,visible:e.editFormVisible,width:"50%","close-on-click-modal":!1},on:{"update:visible":function(t){e.editFormVisible=t}}},[a("el-form",{ref:"editForm",attrs:{"label-width":"120px",model:e.editForm,rules:e.rules}},[a("el-form-item",{attrs:{label:"交修日期",prop:"deliveryDate"}},[a("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",type:"date",placeholder:"选择日期"},model:{value:e.editForm.deliveryDate,callback:function(t){e.$set(e.editForm,"deliveryDate",t)},expression:"editForm.deliveryDate"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"车号",prop:"carNumber"}},[a("el-input",{attrs:{"auto-complete":"off",placeholder:"请输入车号"},model:{value:e.editForm.carNumber,callback:function(t){e.$set(e.editForm,"carNumber",t)},expression:"editForm.carNumber"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"车厢号",prop:"carBodyNumber"}},[a("el-input",{attrs:{min:1,label:"",placeholder:"请输入车箱号"},model:{value:e.editForm.carBodyNumber,callback:function(t){e.$set(e.editForm,"carBodyNumber",t)},expression:"editForm.carBodyNumber"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"故障描述",prop:"faultDescription"}},[a("el-input",{attrs:{type:"textarea",label:"",placeholder:"请输入故障描述"},model:{value:e.editForm.faultDescription,callback:function(t){e.$set(e.editForm,"faultDescription",t)},expression:"editForm.faultDescription"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"处理班组",prop:"teamsGroups"}},[a("el-select",{attrs:{placeholder:"请选择处理班组"},model:{value:e.editForm.teamsGroups,callback:function(t){e.$set(e.editForm,"teamsGroups",t)},expression:"editForm.teamsGroups"}},e._l(e.teamsList,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.name}})}),1),e._v(" "),a("el-button",{attrs:{type:"text",underline:!1},on:{click:function(t){return e.goTeam()}}},[e._v("添加班组")])],1),e._v(" "),a("el-form-item",{attrs:{label:"处理结果",prop:"result"}},[a("label",{attrs:{slot:"label"},slot:"label"},[a("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v(" 处理结果")]),e._v(" "),a("el-radio-group",{on:{change:e.changeResult},model:{value:e.result,callback:function(t){e.result=t},expression:"result"}},[a("el-radio",{staticClass:"radio",attrs:{label:"未处理"}},[e._v("未处理")]),e._v(" "),a("el-radio",{staticClass:"radio",attrs:{label:"长期跟踪"}},[e._v("长期跟踪")]),e._v(" "),a("el-radio",{staticClass:"radio",attrs:{label:"已处理"}},[e._v("已处理(填写处理时间)")])],1),e._v(" "),"已处理"==e.result?a("el-input",{attrs:{label:"",placeholder:"请输入处理结果",size:"mini"},model:{value:e.editForm.result,callback:function(t){e.$set(e.editForm,"result",t)},expression:"editForm.result"}}):e._e()],1),e._v(" "),a("el-form-item",{attrs:{label:"处置分类",prop:"handle"}},[a("el-select",{attrs:{placeholder:"请选择处置分类"},model:{value:e.editForm.handle,callback:function(t){e.$set(e.editForm,"handle",t)},expression:"editForm.handle"}},[a("el-option",{attrs:{label:"已处理",value:"已处理"}}),e._v(" "),a("el-option",{attrs:{label:"待处理",value:"待处理"}}),e._v(" "),a("el-option",{attrs:{label:"待一级修",value:"待一级修"}}),e._v(" "),a("el-option",{attrs:{label:"待二级修",value:"待二级修"}}),e._v(" "),a("el-option",{attrs:{label:"待扣修",value:"待扣修"}}),e._v(" "),a("el-option",{attrs:{label:"待高级修",value:"待高级修"}}),e._v(" "),a("el-option",{attrs:{label:"待集中处理",value:"待集中处理"}}),e._v(" "),a("el-option",{attrs:{label:"待售后处理",value:"待售后处理"}}),e._v(" "),a("el-option",{attrs:{label:"待料",value:"待料"}}),e._v(" "),a("el-option",{attrs:{label:"短期跟踪",value:"短期跟踪"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"功能分类",prop:"funClass"}},[a("el-select",{attrs:{placeholder:"请选择功能分类"},model:{value:e.editForm.funClass,callback:function(t){e.$set(e.editForm,"funClass",t)},expression:"editForm.funClass"}},[a("el-option",{attrs:{label:"整车",value:"整车"}}),e._v(" "),a("el-option",{attrs:{label:"车体",value:"车体"}}),e._v(" "),a("el-option",{attrs:{label:"车端连接",value:"车端连接"}}),e._v(" "),a("el-option",{attrs:{label:"转向架及其辅助",value:"转向架及其辅助"}}),e._v(" "),a("el-option",{attrs:{label:"主供电",value:"主供电"}}),e._v(" "),a("el-option",{attrs:{label:"牵引",value:"牵引"}}),e._v(" "),a("el-option",{attrs:{label:"辅助电气",value:"辅助电气"}}),e._v(" "),a("el-option",{attrs:{label:"供风制动",value:"供风制动"}}),e._v(" "),a("el-option",{attrs:{label:"网络及辅助监控",value:"网络及辅助监控"}}),e._v(" "),a("el-option",{attrs:{label:"旅客信息",value:"旅客信息"}}),e._v(" "),a("el-option",{attrs:{label:"空调",value:"空调"}}),e._v(" "),a("el-option",{attrs:{label:"给排水卫生",value:"给排水卫生"}}),e._v(" "),a("el-option",{attrs:{label:"外门及车内设施",value:"外门及车内设施"}}),e._v(" "),a("el-option",{attrs:{label:"驾驶设施",value:"驾驶设施"}}),e._v(" "),a("el-option",{attrs:{label:"电务车载",value:"电务车载"}}),e._v(" "),a("el-option",{attrs:{label:"其他",value:"其他"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"到料",prop:"material"}},[a("label",{attrs:{slot:"label"},slot:"label"},[e._v("到料 \n                    "),a("span",{staticStyle:{color:"red","font-size":"10px",float:"left",width:"300px","line-height":"0"}},[a("br"),e._v("（无需提料）    （待料）       （到料）\n                    ")])]),e._v(" "),a("el-radio-group",{on:{change:e.handleMethod},model:{value:e.editForm.material,callback:function(t){e.$set(e.editForm,"material",t)},expression:"editForm.material"}},[a("el-radio",{attrs:{label:"无",value:"无"}}),e._v(" "),a("el-radio",{attrs:{label:"否",value:"否"}}),e._v(" "),a("el-radio",{attrs:{label:"是",value:"是"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"处理方法",prop:"method"}},[a("el-input",{attrs:{type:"textarea",size:"small","auto-complete":"off",placeholder:"请输入遗留原因；处理方法；物料情况；跟踪周期。"},on:{input:e.handleMethod},model:{value:e.editForm.method,callback:function(t){e.$set(e.editForm,"method",t)},expression:"editForm.method"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"复核",prop:"review"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.editForm.review,callback:function(t){e.$set(e.editForm,"review",t)},expression:"editForm.review"}},[a("el-option",{attrs:{label:"否",value:"0"}}),e._v(" "),a("el-option",{attrs:{label:"是",value:"1"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{hidden:"",label:"物料编码",prop:"code"}},[a("el-input",{attrs:{size:"small","auto-complete":"off",placeholder:"请输入物料编码"},model:{value:e.editForm.code,callback:function(t){e.$set(e.editForm,"code",t)},expression:"editForm.code"}})],1),e._v(" "),a("el-form-item",{attrs:{hidden:"",label:"影响进度原因",prop:"schedule"}},[a("el-input",{attrs:{size:"small","auto-complete":"off",placeholder:"请输入影响进度原因"},model:{value:e.editForm.schedule,callback:function(t){e.$set(e.editForm,"schedule",t)},expression:"editForm.schedule"}})],1),e._v(" "),a("el-form-item",{attrs:{hidden:"",label:"责任部门（待料）",prop:"respDepart"}},[a("el-input",{attrs:{label:"",placeholder:"请输入责任部门（待料）"},model:{value:e.editForm.respDepart,callback:function(t){e.$set(e.editForm,"respDepart",t)},expression:"editForm.respDepart"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"故障来源",prop:"source"}},[a("el-input",{attrs:{label:"",placeholder:"请输入故障来源"},model:{value:e.editForm.source,callback:function(t){e.$set(e.editForm,"source",t)},expression:"editForm.source"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"风险等级",prop:"risk"}},[a("div",{staticClass:"rate_wrap"},[a("el-rate",{attrs:{max:3},model:{value:e.risk,callback:function(t){e.risk=t},expression:"risk"}}),e._v(" "),a("el-button",{attrs:{size:"mini",icon:"el-icon-refresh-right",circle:""},on:{click:e.resetRisk}})],1)]),e._v(" "),a("el-form-item",{attrs:{label:"备注",prop:"node"}},[a("el-input",{attrs:{size:"small","auto-complete":"off",placeholder:"备注"},model:{value:e.editForm.notes,callback:function(t){e.$set(e.editForm,"notes",t)},expression:"editForm.notes"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){return e.closeDialog("editForm")}}},[e._v("取消")]),e._v(" "),a("el-button",{staticClass:"title",attrs:{size:"small",type:"primary"},on:{click:function(t){return e.handelFault("editForm")}}},[e._v("保存")])],1)],1)],1)},staticRenderFns:[]};var ce=a("VU/8")(ne,se,!1,function(e){a("vyqo")},"data-v-2a087ad2",null).exports,ue={name:"FaultDecorate",components:{Pagination:T},data:function(){return{carNumbers:[],risks:[],carNumberList:S,baseURL:c,timeList:[],tableData:[],editFormVisible:!1,dialogTrackVisible:!1,title:"编辑",editForm:x()({code:"无",schedule:"无",respDepart:"无",review:"0"},"review",""),editTrackForm:{},risk:0,result:"",rules:{deliveryDate:[{required:!0,message:"请输入日期",trigger:"blur"}],carNumber:[{required:!0,message:"请输入车号",trigger:"blur"}],carBodyNumber:[{required:!0,message:"请输入车厢号",trigger:"blur"}],faultDescription:[{required:!0,message:"请输入故障描述",trigger:"blur"}],teamsGroups:[{required:!0,message:"请选择班组",trigger:"blur"}],funClass:[{required:!0,message:"请选择功能分类",trigger:"blur"}],handle:[{required:!0,message:"请选择处置分类",trigger:"blur"}],method:[{required:!0,message:"请输入处理方法",trigger:"blur"}],source:[{required:!0,message:"请输入故障来源",trigger:"blur"}],material:[{required:!0,message:"请选择到料情况",trigger:"blur"}]},trackRules:{trackPerson:[{required:!0,message:"请输入责任人",trigger:"blur"}],trackRequire:[{required:!0,message:"请输入追踪要求",trigger:"blur"}],feedback:[{required:!0,message:"请输入反馈实现",trigger:"blur"}]},pageparm:{pageNo:1,pageSize:1e4,result:"未处理",state:"4"},total:0,allList:[],loading:!0,teamsList:[],riskList:[{label:"⭐",value:1},{label:"⭐⭐",value:2},{label:"⭐⭐⭐",value:3}],id:0,uploadModalVisible:!1,fileList:[],dialogVisible:!1,attachmentList:[],previewDialogVisible:!1,previewFile:"",fault:{},deleteParams:{}}},created:function(){this.getFault(),this.getTeams()},computed:{indexMethod:function(){return(this.pageparm.pageNo-1)*this.pageparm.pageSize+1}},methods:{changeInput:function(e){this.$forceUpdate()},rowStyle:function(e){var t=e.row;return 1==t.dimension?{background:"antiquewhite"}:1==t.review?{background:"rgb(159 199 159)"}:void 0},changeUpdate:function(){this.$forceUpdate()},changeResultSelect:function(){"全部"==this.pageparm.result&&delete this.pageparm.result},resetForm:function(e){this.$refs[e].resetFields(),this.timeList=[],delete this.pageparm.startTime,delete this.pageparm.endTime,this.pageparm.carNumbers&&delete this.pageparm.carNumbers,this.carNumbers=[],this.pageparm.risks&&delete this.pageparm.risks,this.risks=[]},getTeams:function(){var e=this;Object(s.a)({url:c+"/teams/selectall"}).then(function(t){e.teamsList=t.data.data,e.loading=!1}).catch(function(e){console.log(e)})},search:function(){var e=this;this.carNumbers.length&&(this.pageparm.carNumbers=this.carNumbers),this.risks.length&&(this.pageparm.risks=this.risks),this.loading=!0,this.timeList.length&&(this.pageparm.startTime=this.getYMDHMS(new Date(this.timeList[0].toString())),this.pageparm.endTime=this.getYMDHMS(new Date(this.timeList[1].toString()))),this.pageparm.pageNo=1,Object(s.a)({method:"post",url:c+"/fault/screenfault",data:w()({},this.pageparm,{pageNo:this.pageparm.pageNo,pageSize:this.pageparm.pageSize})}).then(function(t){e.tableData=t.data.data.list,e.tableData=e.tableData.map(function(t){return t.deliveryDate=e.getYMDHMS(t.deliveryDate),t.risk="0"==t.risk?0:parseInt(t.risk),t.code="null"==t.code?"":t.code,t.schedule="null"==t.schedule?"":t.schedule,t.respDepart="null"==t.respDepart?"":t.respDepart,t.notes="null"==t.notes?"":t.notes,t}),e.total=t.data.data.size,e.loading=!1,e.$message.success("搜索成功")}).catch(function(t){e.initPage(),e.getFault(),e.$message.error("搜索失败")})},searchCurrent:function(){var e=this;this.carNumbers.length&&(this.pageparm.carNumbers=this.carNumbers),this.risks.length&&(this.pageparm.risks=this.risks),this.loading=!0,this.timeList.length&&(this.pageparm.startTime=this.getYMDHMS(new Date(this.timeList[0].toString())),this.pageparm.endTime=this.getYMDHMS(new Date(this.timeList[1].toString()))),this.pageparm.pageNo=1,this.pageparm.pageSize=1e4,Object(s.a)({method:"post",url:c+"/fault/screenfault",data:this.pageparm}).then(function(t){e.tableData=t.data.data.list,e.tableData=e.tableData.map(function(t){return t.deliveryDate=e.getYMDHMS(t.deliveryDate),t.risk="0"==t.risk?0:parseInt(t.risk),t.code="null"==t.code?"":t.code,t.schedule="null"==t.schedule?"":t.schedule,t.respDepart="null"==t.respDepart?"":t.respDepart,t.notes="null"==t.notes?"":t.notes,t}),e.total=t.data.data.size,e.loading=!1,e.$message.success("搜索成功")}).catch(function(t){e.initPage(),e.getFault(),e.$message.error("搜索失败")})},initPage:function(){this.pageparm={pageNo:1,pageSize:1e4,state:0,result:"未处理"}},getYMDHMS:function(e){var t=new Date(e);return t.getFullYear()+"-"+(t.getMonth()+1).toString().padStart(2,"0")+"-"+t.getDate().toString().padStart(2,"0")},exportExcel:function(){"全部"==this.pageparm.result&&delete this.pageparm.result,this.carNumbers.length&&(this.pageparm.carNumbers=this.carNumbers),this.timeList.length&&(this.pageparm.startTime=this.getYMDHMS(new Date(this.timeList[0].toString())),this.pageparm.endTime=this.getYMDHMS(new Date(this.timeList[1].toString()))),this.risks.length&&(this.pageparm.risks=this.risks);var e=c+"/fault/export?";for(var t in this.pageparm)this.pageparm[t]&&(e+=t+"="+this.pageparm[t]+"&");console.log(e),s.a.get(e).then(function(t){console.log(e),window.location.href=e})},callFather:function(e){this.pageparm.pageNo=e.pageNo,this.pageparm.pageSize=e.pageSize,this.searchCurrent(),document.querySelector(".el-main").scrollTo(0,0)},getFault:function(){var e=this;this.carNumbers.length&&(this.pageparm.carNumbers=this.carNumbers),Object(s.a)({method:"post",url:c+"/fault/screenfault",data:{result:"未处理",state:"4",pageNo:this.pageparm.pageNo,pageSize:this.pageparm.pageSize}}).then(function(t){e.tableData=t.data.data.list||[],e.tableData=e.tableData.map(function(t){return t.deliveryDate=e.getYMDHMS(t.deliveryDate),t.risk="0"==t.risk?parseInt(0):parseInt(t.risk),t.code="null"==t.code?"":t.code,t.schedule="null"==t.schedule?"":t.schedule,t.respDepart="null"==t.respDepart?"":t.respDepart,t.notes="null"==t.notes?"":t.notes,t}),e.total=t.data.data.size,e.loading=!1}).catch(function(e){console.log(e)})},deleteById:function(e){var t=this;this.$confirm("此操作将永久删除, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:c+"/fault/deletefaultid",params:{id:e.id}}).then(function(e){t.$message({message:"删除成功",type:"success"}),t.search()}).catch(function(e){console.log(e)})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},handleEdit:function(e,t){console.log(t),this.editFormVisible=!0,void 0!=t&&"undefined"!=t?(this.title="修改",this.editForm=t,"未处理"!=this.editForm.result&"长期跟踪"!=this.editForm.result?this.result="已处理":"未处理"==this.editForm.result?this.result="未处理":"长期跟踪"==this.editForm.result&&(this.result="长期跟踪"),this.risk=t.risk):(this.title="添加",this.editForm={review:"0",code:"无",schedule:"无",respDepart:"无",notes:"无"},this.result="")},changeResult:function(){this.editForm.result=""},handelFault:function(){var e=this;this.$refs.editForm.validate(function(t){if(!t)return console.log("提交失败"),!1;if("已处理"!=e.result&&(e.editForm.result=e.result),e.editForm.risk=e.risk,"添加"==e.title)e.editForm.result?(e.editForm.dimension="0",Object(s.a)({url:c+"/fault/insertfault",method:"post",data:e.editForm}).then(function(t){e.$message({message:e.title+"成功",type:"success"}),e.editFormVisible=!1,e.editForm={},e.risk=0,e.initPage(),e.search()}).catch(function(t){console.log(t),e.$message({message:e.title+"失败",type:"error"}),e.editFormVisible=!1,e.editForm={},e.risk=0,e.initPage(),e.search()})):e.$message.error("请选择处理结果");else{for(var a in e.editForm)!e.editForm[a]&"risk"!=a&&(e.editForm[a]="null");Object(s.a)({url:c+"/fault/updatefaultid",method:"post",data:e.editForm}).then(function(t){e.editFormVisible=!1,e.editForm={},e.risk=0,e.$message.success("修改成功")}).catch(function(t){console.log(t),e.$message.error("请重新提交")})}})},closeDialog:function(){this.editFormVisible=!1,this.editForm={},this.risk=0},handleUploadSuccess:function(e){this.uploadUrlPath=N()(e),this.loading.close()},handleBeforeUpload:function(){this.loading=this.$loading({lock:!0,text:"上传中",background:"rgba(0, 0, 0, 0.7)"})},handleUploadError:function(){this.$message({type:"error",message:"上传失败"}),this.loading.close()},handleRemove:function(e,t){console.log(e,t)},handlePreview:function(e){console.log(e)},handleExceed:function(e,t){this.$message.warning("当前限制选择文件个数，本次选择了 "+e.length+" 个文件，共选择了 "+(e.length+t.length)+" 个文件")},beforeRemove:function(e,t){return this.$confirm("确定移除 "+e.name+"？")},handleSuccess:function(){this.getFault(),this.$message.success("导入成功")},handleError:function(){this.getFault(),this.$message.error("导入格式错误，请修改后重新导入！")},resetRisk:function(){this.risk=0},changState:function(e,t){var a=this;this.$confirm("此操作将数据提交, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:" "+c+"/fault/changestate",params:{id:e,state:t}}).then(function(e){a.$message.success("已转移到故障遗留列表"),a.search()}).catch(function(e){a.$message.error("重新提交")})}).catch(function(){a.$message({type:"info",message:"已取消提交"})})},changeTrack:function(){var e=this;this.$refs.editTrackForm.validate(function(t){if(!t)return console.log("请输入责任人"),!1;e.$confirm("此操作将数据提交到故障追踪列表, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:" "+c+"/fault/changestate",params:{id:e.id,state:2,trackPerson:e.editTrackForm.trackPerson,trackRequire:e.editTrackForm.trackRequire,feedback:"请责任人填写"}}).then(function(t){e.$message.success("已转移到故障追踪列表"),e.search(),e.dialogTrackVisible=!1,e.editTrackForm={}}).catch(function(t){e.$message.error("请重新提交"),e.editTrackForm={}})}).catch(function(){e.$message({type:"info",message:"已取消提交"})})})},changeDimension:function(e,t){var a=this;this.$confirm("此操作将数据列为重点故障，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:" "+c+"/fault/changedimension",params:{id:e,dimension:t}}).then(function(e){a.$message.success("成功"),a.search()}).catch(function(e){a.$message.error("失败")})}).catch(function(){a.$message({type:"info",message:"已取消"})})},handleTrack:function(e){this.dialogTrackVisible=!0,this.id=e},handleClose:function(){this.editTrackForm={},this.dialogTrackVisible=!1},handleMethod:function(){"修改"==this.title&&(this.editForm.handle="")},showUploadModal:function(e){this.fault.id=e.id,this.uploadModalVisible=!0},beforeClose:function(e){e()},upload:function(){this.$refs.refName.clearFiles(),this.uploadModalVisible=!1},handleFileSuccess:function(e,t,a){200!==e.code?(this.$message.error(e.msg),this.$refs.refName.uploadFiles.splice(this.$refs.refName.uploadFiles.indexOf(t),1)):this.$message.success("上传成功")},handleFileError:function(e,t,a){this.$message.error("文件超出大小限制，上传失败，请联系管理员!"),this.$refs.refName.uploadFiles.splice(this.$refs.refName.uploadFiles.indexOf(t),1),this.$refs.refName.clearFiles()},showModal:function(e){var t=this;Object(s.a)({url:c+"/fault/fileList/"+e,method:"get"}).then(function(e){t.dialogVisible=!0,t.attachmentList=e.data.data||[]})},handleCloseFile:function(e){e()},downloadAttachment:function(e){console.log("下载附件",e),D(c+"/fault/download/"+e.faultFileMidId,e.fileName)},deleteAttachment:function(e){var t=this;console.log("删除附件",e),this.deleteParams={fileId:e.fileId,faultFileMidId:e.faultFileMidId},this.$confirm("点击后删除，是否确定？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:c+"/fault/deleteFile",method:"post",data:t.deleteParams}).then(function(a){console.log(a),200!==a.data.code?t.$message.error(a.data.msg):(t.$message.success("操作成功!"),t.showModal(e.faultId))}).catch(function(e){t.$message.error(e)})})},handleFileNameClick:function(e){var t=this;console.log("点击文件名",e),this.$confirm("点击后下载，是否确定？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:c+"/fault/getFileInfo/"+e.fileId,method:"get"}).then(function(a){console.log(a),200!==a.data.code&&(t.$message.error(a.data.msg),t.showModal(e.faultId)),D(c+"/fault/download/"+e.faultFileMidId,e.fileName)}).catch(function(e){t.$message.error(e)})})},handleSizeChange:function(e){this.pageparm.pageSize=e,this.getFault(),document.querySelector(".el-main").scrollTo(0,0),console.log("每页 "+e+" 条")},handleCurrentChange:function(e){this.pageparm.pageNo=e,this.getFault(),document.querySelector(".el-main").scrollTo(0,0),console.log("当前页: "+e)},goTeam:function(){this.$router.push({path:"/teams/index"})}}},me={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{ref:"searchForm",staticClass:"user-search",attrs:{inline:!0,model:e.pageparm}},[a("el-form-item",{attrs:{label:"处理结果：",prop:"result"}},[a("el-select",{attrs:{placeholder:"请选择处理结果"},on:{change:e.changeResultSelect},model:{value:e.pageparm.result,callback:function(t){e.$set(e.pageparm,"result",t)},expression:"pageparm.result"}},[a("el-option",{attrs:{label:"全部",value:"全部"}}),e._v(" "),a("el-option",{attrs:{label:"未处理",value:"未处理"}}),e._v(" "),a("el-option",{attrs:{label:"已处理",value:"已处理"}}),e._v(" "),a("el-option",{attrs:{label:"长期跟踪",value:"长期跟踪"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"标注",prop:"dimension"}},[a("el-select",{attrs:{placeholder:"请选择"},on:{change:e.changeUpdate},model:{value:e.pageparm.dimension,callback:function(t){e.$set(e.pageparm,"dimension",t)},expression:"pageparm.dimension"}},[a("el-option",{attrs:{label:"非重点关注",value:"0"}}),e._v(" "),a("el-option",{attrs:{label:"重点关注",value:"1"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"复核",prop:"review"}},[a("el-select",{attrs:{placeholder:"请选择"},on:{change:function(t){return e.changeInput(t)}},model:{value:e.pageparm.review,callback:function(t){e.$set(e.pageparm,"review",t)},expression:"pageparm.review"}},[a("el-option",{attrs:{label:"否",value:"0"}}),e._v(" "),a("el-option",{attrs:{label:"是",value:"1"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"车号",prop:"carNumber"}},[a("el-select",{attrs:{multiple:"",filterable:"",placeholder:"请选择车号"},on:{change:function(t){return e.changeInput(t)}},model:{value:e.carNumbers,callback:function(t){e.carNumbers=t},expression:"carNumbers"}},e._l(e.carNumberList,function(e){return a("el-option",{key:e.value,attrs:{label:e.value,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"车厢号",prop:"carBodyNumber"}},[a("el-input",{attrs:{size:"small",placeholder:"输入车厢号"},on:{input:function(t){return e.changeInput(t)}},model:{value:e.pageparm.carBodyNumber,callback:function(t){e.$set(e.pageparm,"carBodyNumber",t)},expression:"pageparm.carBodyNumber"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"交修日期"}},[a("el-col",{attrs:{span:11}},[a("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.timeList,callback:function(t){e.timeList=t},expression:"timeList"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"故障描述：",prop:"faultDescription"}},[a("el-input",{attrs:{size:"small",placeholder:"输入故障描述"},on:{input:function(t){return e.changeInput(t)}},model:{value:e.pageparm.faultDescription,callback:function(t){e.$set(e.pageparm,"faultDescription",t)},expression:"pageparm.faultDescription"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"故障来源：",prop:"source"}},[a("el-input",{attrs:{size:"small",placeholder:"输入故障来源"},on:{input:function(t){return e.changeInput(t)}},model:{value:e.pageparm.source,callback:function(t){e.$set(e.pageparm,"source",t)},expression:"pageparm.source"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"处理方法：",prop:"method"}},[a("el-input",{attrs:{size:"small",placeholder:"输入处理方法"},on:{input:function(t){return e.changeInput(t)}},model:{value:e.pageparm.method,callback:function(t){e.$set(e.pageparm,"method",t)},expression:"pageparm.method"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"处理班组",prop:"teamsGroups"}},[a("el-select",{attrs:{placeholder:"请选择处理班组"},on:{change:e.changeUpdate},model:{value:e.pageparm.teamsGroups,callback:function(t){e.$set(e.pageparm,"teamsGroups",t)},expression:"pageparm.teamsGroups"}},e._l(e.teamsList,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.name}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"功能分类",prop:"funClass"}},[a("el-select",{attrs:{placeholder:"请选择功能分类"},on:{change:e.changeUpdate},model:{value:e.pageparm.funClass,callback:function(t){e.$set(e.pageparm,"funClass",t)},expression:"pageparm.funClass"}},[a("el-option",{attrs:{label:"整车",value:"整车"}}),e._v(" "),a("el-option",{attrs:{label:"车体",value:"车体"}}),e._v(" "),a("el-option",{attrs:{label:"车端连接",value:"车端连接"}}),e._v(" "),a("el-option",{attrs:{label:"转向架及其辅助",value:"转向架及其辅助"}}),e._v(" "),a("el-option",{attrs:{label:"主供电",value:"主供电"}}),e._v(" "),a("el-option",{attrs:{label:"牵引",value:"牵引"}}),e._v(" "),a("el-option",{attrs:{label:"辅助电气",value:"辅助电气"}}),e._v(" "),a("el-option",{attrs:{label:"供风制动",value:"供风制动"}}),e._v(" "),a("el-option",{attrs:{label:"网络及辅助监控",value:"网络及辅助监控"}}),e._v(" "),a("el-option",{attrs:{label:"旅客信息",value:"旅客信息"}}),e._v(" "),a("el-option",{attrs:{label:"空调",value:"空调"}}),e._v(" "),a("el-option",{attrs:{label:"给排水卫生",value:"给排水卫生"}}),e._v(" "),a("el-option",{attrs:{label:"外门及车内设施",value:"外门及车内设施"}}),e._v(" "),a("el-option",{attrs:{label:"驾驶设施",value:"驾驶设施"}}),e._v(" "),a("el-option",{attrs:{label:"电务车载",value:"电务车载"}}),e._v(" "),a("el-option",{attrs:{label:"其他",value:"其他"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"处置分类",prop:"handle"}},[a("el-input",{attrs:{size:"small",placeholder:"输入处置分类"},on:{input:function(t){return e.changeInput(t)}},model:{value:e.pageparm.handle,callback:function(t){e.$set(e.pageparm,"handle",t)},expression:"pageparm.handle"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"风险等级",prop:"risk"}},[a("el-select",{attrs:{multiple:"",filterable:"",placeholder:"请选择风险等级"},on:{change:e.changeUpdate},model:{value:e.risks,callback:function(t){e.risks=t},expression:"risks"}},[a("el-option",{attrs:{label:"无风险",value:0}}),e._v(" "),e._l(e.riskList,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}},[a("span",{staticStyle:{float:"left"}},[a("el-rate",{attrs:{max:t.value,disabled:""},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}})],1)])})],2)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-search"},on:{click:function(t){return e.search()}}},[e._v("搜索")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-refresh-right"},on:{click:function(t){return e.resetForm("searchForm")}}},[e._v("重置")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-plus"},on:{click:function(t){return e.handleEdit()}}},[e._v("添加")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"warning",icon:"el-icon-star-off"},on:{click:function(t){return e.exportExcel()}}},[e._v("导出")])],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"",height:"600","row-style":e.rowStyle}},[a("el-table-column",{attrs:{type:"index",label:"序号",align:"center",width:"70",index:e.indexMethod,fixed:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"deliveryDate",label:"交修日期",width:"100",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"carNumber",label:"车号",width:"70",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"carBodyNumber",label:"车厢号",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"faultDescription",label:"故障描述",width:"180",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"teamsGroups",label:"处理班组",width:"100",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"result",label:"处理结果",width:"180",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s("null"==t.row.result?"":t.row.result)+"\n            ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"method",label:"处理方法",width:"200",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s("null"==t.row.method?"":t.row.method)+"\n            ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"material",label:"是否到料",width:"100",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"source",label:"故障来源",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s("null"==t.row.source?"":t.row.source)+"\n            ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"funClass",label:"功能分类",width:"130",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s("null"==t.row.funClass?"":t.row.funClass)+"\n            ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"risk",label:"风险等级",width:"180",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-rate",{attrs:{max:3,disabled:""},model:{value:t.row.risk,callback:function(a){e.$set(t.row,"risk",a)},expression:"scope.row.risk"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"handle",label:"处置分类",width:"150",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s("null"==t.row.handle?"":t.row.handle)+"\n            ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"notes",label:"备注",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s("null"==t.row.notes?"":t.row.notes)+"\n            ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"notes",label:"查看",align:"center",width:"130"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticClass:"icon-button",on:{click:function(a){return e.showModal(t.row.id)}}},[a("i",{staticClass:"el-icon-view"}),e._v("\n                    查看附件\n                ")])]}}])},[e._v(" "),a("el-dialog",{attrs:{title:"附件列表",visible:e.dialogVisible,width:"40%","before-close":e.handleCloseFile,"append-to-body":""},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.attachmentList}},[a("el-table-column",{attrs:{prop:"fileName",align:"center",label:"名称"},scopedSlots:e._u([{key:"default",fn:function(t){var l=t.row;return[a("el-link",{on:{click:function(t){return e.handleFileNameClick(l)}}},[e._v(e._s(l.fileName))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"fileType",align:"center",label:"类型"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var l=t.row;return[a("el-button",{attrs:{type:"primary",icon:"el-icon-download"},on:{click:function(t){return e.downloadAttachment(l)}}}),e._v(" "),a("el-button",{attrs:{type:"danger",icon:"el-icon-delete"},on:{click:function(t){return e.deleteAttachment(l)}}})]}}])})],1)],1)],1),e._v(" "),a("el-table-column",{attrs:{prop:"",label:"删除",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(a){return e.deleteById(t.row)}}})]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"",label:"附件",width:"120",align:"center",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticStyle:{"margin-top":"5px"}},[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(a){return e.showUploadModal(t.row)}}},[e._v("点击上传")])],1)]}}])}),e._v(" "),a("el-dialog",{attrs:{title:"文件上传",visible:e.uploadModalVisible,width:"650px","before-close":e.beforeClose,"append-to-body":"","show-close":!1,"close-on-click-modal":!1},on:{"update:visible":function(t){e.uploadModalVisible=t}}},[a("el-upload",{ref:"refName",staticClass:"uploadFile",attrs:{action:e.baseURL+"/fault/upload","on-success":e.handleFileSuccess,"on-error":e.handleFileError,"file-list":e.fileList,data:e.fault,drag:"",multiple:""}},[a("i",{staticClass:"el-icon-upload"}),e._v(" "),a("div",{staticClass:"el-upload__text"},[e._v("将文件拖到此处，或"),a("em",[e._v("点击上传")])])]),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.upload}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.upload}},[e._v("确 定")])],1)],1),e._v(" "),a("el-table-column",{attrs:{prop:"",label:"操作",width:"100",align:"center",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary",icon:"el-icon-edit",circle:""},on:{click:function(a){return e.handleEdit(t.$index,t.row)}}})]}}])})],1),e._v(" "),a("Pagination",{attrs:{"child-msg":e.pageparm,total:e.total},on:{callFather:e.callFather}}),e._v(" "),a("el-dialog",{attrs:{title:e.title,visible:e.editFormVisible,width:"50%","close-on-click-modal":!1},on:{"update:visible":function(t){e.editFormVisible=t}}},[a("el-form",{ref:"editForm",attrs:{"label-width":"120px",model:e.editForm,rules:e.rules}},[a("el-form-item",{attrs:{label:"交修日期",prop:"deliveryDate"}},[a("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",type:"date",placeholder:"选择日期"},model:{value:e.editForm.deliveryDate,callback:function(t){e.$set(e.editForm,"deliveryDate",t)},expression:"editForm.deliveryDate"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"车号",prop:"carNumber"}},[a("el-input",{attrs:{"auto-complete":"off",placeholder:"请输入车号"},model:{value:e.editForm.carNumber,callback:function(t){e.$set(e.editForm,"carNumber",t)},expression:"editForm.carNumber"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"车厢号",prop:"carBodyNumber"}},[a("el-input",{attrs:{min:1,label:"",placeholder:"请输入车箱号"},model:{value:e.editForm.carBodyNumber,callback:function(t){e.$set(e.editForm,"carBodyNumber",t)},expression:"editForm.carBodyNumber"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"故障描述",prop:"faultDescription"}},[a("el-input",{attrs:{type:"textarea",label:"",placeholder:"请输入故障描述"},model:{value:e.editForm.faultDescription,callback:function(t){e.$set(e.editForm,"faultDescription",t)},expression:"editForm.faultDescription"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"处理班组",prop:"teamsGroups"}},[a("el-select",{attrs:{placeholder:"请选择处理班组"},model:{value:e.editForm.teamsGroups,callback:function(t){e.$set(e.editForm,"teamsGroups",t)},expression:"editForm.teamsGroups"}},e._l(e.teamsList,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.name}})}),1),e._v(" "),a("el-button",{attrs:{type:"text",underline:!1},on:{click:function(t){return e.goTeam()}}},[e._v("添加班组")])],1),e._v(" "),a("el-form-item",{attrs:{label:"处理结果",prop:"result"}},[a("label",{attrs:{slot:"label"},slot:"label"},[a("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v(" 处理结果")]),e._v(" "),a("el-radio-group",{on:{change:e.changeResult},model:{value:e.result,callback:function(t){e.result=t},expression:"result"}},[a("el-radio",{staticClass:"radio",attrs:{label:"未处理"}},[e._v("未处理")]),e._v(" "),a("el-radio",{staticClass:"radio",attrs:{label:"长期跟踪"}},[e._v("长期跟踪")]),e._v(" "),a("el-radio",{staticClass:"radio",attrs:{label:"已处理"}},[e._v("已处理(填写处理时间)")])],1),e._v(" "),"已处理"==e.result?a("el-input",{attrs:{label:"",placeholder:"请输入处理结果",size:"mini"},model:{value:e.editForm.result,callback:function(t){e.$set(e.editForm,"result",t)},expression:"editForm.result"}}):e._e()],1),e._v(" "),a("el-form-item",{attrs:{label:"处置分类",prop:"handle"}},[a("el-select",{attrs:{placeholder:"请选择处置分类"},model:{value:e.editForm.handle,callback:function(t){e.$set(e.editForm,"handle",t)},expression:"editForm.handle"}},[a("el-option",{attrs:{label:"已处理",value:"已处理"}}),e._v(" "),a("el-option",{attrs:{label:"待处理",value:"待处理"}}),e._v(" "),a("el-option",{attrs:{label:"待一级修",value:"待一级修"}}),e._v(" "),a("el-option",{attrs:{label:"待二级修",value:"待二级修"}}),e._v(" "),a("el-option",{attrs:{label:"待扣修",value:"待扣修"}}),e._v(" "),a("el-option",{attrs:{label:"待高级修",value:"待高级修"}}),e._v(" "),a("el-option",{attrs:{label:"待集中处理",value:"待集中处理"}}),e._v(" "),a("el-option",{attrs:{label:"待售后处理",value:"待售后处理"}}),e._v(" "),a("el-option",{attrs:{label:"待料",value:"待料"}}),e._v(" "),a("el-option",{attrs:{label:"短期跟踪",value:"短期跟踪"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"功能分类",prop:"funClass"}},[a("el-select",{attrs:{placeholder:"请选择功能分类"},model:{value:e.editForm.funClass,callback:function(t){e.$set(e.editForm,"funClass",t)},expression:"editForm.funClass"}},[a("el-option",{attrs:{label:"整车",value:"整车"}}),e._v(" "),a("el-option",{attrs:{label:"车体",value:"车体"}}),e._v(" "),a("el-option",{attrs:{label:"车端连接",value:"车端连接"}}),e._v(" "),a("el-option",{attrs:{label:"转向架及其辅助",value:"转向架及其辅助"}}),e._v(" "),a("el-option",{attrs:{label:"主供电",value:"主供电"}}),e._v(" "),a("el-option",{attrs:{label:"牵引",value:"牵引"}}),e._v(" "),a("el-option",{attrs:{label:"辅助电气",value:"辅助电气"}}),e._v(" "),a("el-option",{attrs:{label:"供风制动",value:"供风制动"}}),e._v(" "),a("el-option",{attrs:{label:"网络及辅助监控",value:"网络及辅助监控"}}),e._v(" "),a("el-option",{attrs:{label:"旅客信息",value:"旅客信息"}}),e._v(" "),a("el-option",{attrs:{label:"空调",value:"空调"}}),e._v(" "),a("el-option",{attrs:{label:"给排水卫生",value:"给排水卫生"}}),e._v(" "),a("el-option",{attrs:{label:"外门及车内设施",value:"外门及车内设施"}}),e._v(" "),a("el-option",{attrs:{label:"驾驶设施",value:"驾驶设施"}}),e._v(" "),a("el-option",{attrs:{label:"电务车载",value:"电务车载"}}),e._v(" "),a("el-option",{attrs:{label:"其他",value:"其他"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"到料",prop:"material"}},[a("label",{attrs:{slot:"label"},slot:"label"},[e._v("到料 \n                    "),a("span",{staticStyle:{color:"red","font-size":"10px",float:"left",width:"300px","line-height":"0"}},[a("br"),e._v("（无需提料）    （待料）       （到料）\n                    ")])]),e._v(" "),a("el-radio-group",{on:{change:e.handleMethod},model:{value:e.editForm.material,callback:function(t){e.$set(e.editForm,"material",t)},expression:"editForm.material"}},[a("el-radio",{attrs:{label:"无",value:"无"}}),e._v(" "),a("el-radio",{attrs:{label:"否",value:"否"}}),e._v(" "),a("el-radio",{attrs:{label:"是",value:"是"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"处理方法",prop:"method"}},[a("el-input",{attrs:{type:"textarea",size:"small","auto-complete":"off",placeholder:"请输入遗留原因；处理方法；物料情况；跟踪周期。"},on:{input:e.handleMethod},model:{value:e.editForm.method,callback:function(t){e.$set(e.editForm,"method",t)},expression:"editForm.method"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"复核",prop:"review"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.editForm.review,callback:function(t){e.$set(e.editForm,"review",t)},expression:"editForm.review"}},[a("el-option",{attrs:{label:"否",value:"0"}}),e._v(" "),a("el-option",{attrs:{label:"是",value:"1"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{hidden:"",label:"物料编码",prop:"code"}},[a("el-input",{attrs:{size:"small","auto-complete":"off",placeholder:"请输入物料编码"},model:{value:e.editForm.code,callback:function(t){e.$set(e.editForm,"code",t)},expression:"editForm.code"}})],1),e._v(" "),a("el-form-item",{attrs:{hidden:"",label:"影响进度原因",prop:"schedule"}},[a("el-input",{attrs:{size:"small","auto-complete":"off",placeholder:"请输入影响进度原因"},model:{value:e.editForm.schedule,callback:function(t){e.$set(e.editForm,"schedule",t)},expression:"editForm.schedule"}})],1),e._v(" "),a("el-form-item",{attrs:{hidden:"",label:"责任部门（待料）",prop:"respDepart"}},[a("el-input",{attrs:{label:"",placeholder:"请输入责任部门（待料）"},model:{value:e.editForm.respDepart,callback:function(t){e.$set(e.editForm,"respDepart",t)},expression:"editForm.respDepart"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"故障来源",prop:"source"}},[a("el-input",{attrs:{label:"",placeholder:"请输入故障来源"},model:{value:e.editForm.source,callback:function(t){e.$set(e.editForm,"source",t)},expression:"editForm.source"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"风险等级",prop:"risk"}},[a("div",{staticClass:"rate_wrap"},[a("el-rate",{attrs:{max:3},model:{value:e.risk,callback:function(t){e.risk=t},expression:"risk"}}),e._v(" "),a("el-button",{attrs:{size:"mini",icon:"el-icon-refresh-right",circle:""},on:{click:e.resetRisk}})],1)]),e._v(" "),a("el-form-item",{attrs:{label:"备注",prop:"node"}},[a("el-input",{attrs:{size:"small","auto-complete":"off",placeholder:"备注"},model:{value:e.editForm.notes,callback:function(t){e.$set(e.editForm,"notes",t)},expression:"editForm.notes"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){return e.closeDialog("editForm")}}},[e._v("取消")]),e._v(" "),a("el-button",{staticClass:"title",attrs:{size:"small",type:"primary"},on:{click:function(t){return e.handelFault("editForm")}}},[e._v("保存")])],1)],1)],1)},staticRenderFns:[]};var pe=a("VU/8")(ue,me,!1,function(e){a("xRMN")},"data-v-6d35086f",null).exports,de={name:"FaultCheck",components:{Pagination:T},data:function(){return{carNumbers:[],risks:[],carNumberList:S,baseURL:c,timeList:[],tableData:[],editFormVisible:!1,title:"编辑",editForm:{},risk:0,result:"",rules:{deliveryDate:[{required:!0,message:"请输入日期",trigger:"blur"}],carNumber:[{required:!0,message:"请输入车号",trigger:"blur"}],carBodyNumber:[{required:!0,message:"请输入车厢号",trigger:"blur"}],faultDescription:[{required:!0,message:"请输入故障描述",trigger:"blur"}],teamsGroups:[{required:!0,message:"请选择班组",trigger:"blur"}],funClass:[{required:!0,message:"请选择功能分类",trigger:"blur"}],handle:[{required:!0,message:"请选择处置分类",trigger:"blur"}],method:[{required:!0,message:"请输入处理方法",trigger:"blur"}],source:[{required:!0,message:"请输入故障来源",trigger:"blur"}]},pageparm:{pageNo:1,pageSize:1e5,state:0,result:"未处理"},total:0,allList:[],headers:"'Content-Type': 'multipart/form-data'",loading:!0,teamsList:[],riskList:[{label:"⭐",value:1},{label:"⭐⭐",value:2},{label:"⭐⭐⭐",value:3}],fileList:[],dialogVisible:!1,attachmentList:[]}},created:function(){this.getFault(),this.getTeams()},computed:{indexMethod:function(){return(this.pageparm.pageNo-1)*this.pageparm.pageSize+1}},methods:{changeResultSelect:function(){"全部"==this.pageparm.result&&delete this.pageparm.result},rowStyle:function(e){if(1==e.row.dimension)return{background:"antiquewhite"}},changeUpdate:function(){this.$forceUpdate()},resetForm:function(e){this.$refs[e].resetFields(),this.timeList=[],delete this.pageparm.startTime,delete this.pageparm.endTime,this.pageparm.carNumbers&&delete this.pageparm.carNumbers,this.carNumbers=[],this.pageparm.risks&&delete this.pageparm.risks,this.risks=[]},getTeams:function(){var e=this;Object(s.a)({url:c+"/teams/selectall"}).then(function(t){e.teamsList=t.data.data,e.loading=!1}).catch(function(e){console.log(e)})},search:function(){var e=this;this.carNumbers.length&&(this.pageparm.carNumbers=this.carNumbers),this.risks.length&&(this.pageparm.risks=this.risks),this.loading=!0,this.timeList.length&&(this.pageparm.startTime=this.getYMDHMS(new Date(this.timeList[0].toString())),this.pageparm.endTime=this.getYMDHMS(new Date(this.timeList[1].toString()))),this.pageparm.pageNo=1,this.pageparm.pageSize=1e5,Object(s.a)({method:"post",url:c+"/fault/screenfault",data:this.pageparm}).then(function(t){e.tableData=t.data.data.list,e.tableData=e.tableData.map(function(t){return t.deliveryDate=e.getYMDHMS(t.deliveryDate),t.risk="0"==t.risk?0:parseInt(t.risk),t.code="null"==t.code?"":t.code,t.schedule="null"==t.schedule?"":t.schedule,t.respDepart="null"==t.respDepart?"":t.respDepart,t.notes="null"==t.notes?"":t.notes,t}),e.total=t.data.data.size,e.loading=!1,e.$message.success("搜索成功")}).catch(function(t){e.initPage(),e.getFault(),e.$message.error("搜索失败"),console.log(t)})},initPage:function(){this.pageparm={pageNo:1,pageSize:1e5,state:0}},getYMDHMS:function(e){var t=new Date(e);return t.getFullYear()+"-"+(t.getMonth()+1).toString().padStart(2,"0")+"-"+t.getDate().toString().padStart(2,"0")},exportExcel:function(){"全部"==this.pageparm.result&&delete this.pageparm.result,this.carNumbers.length&&(this.pageparm.carNumbers=this.carNumbers),this.timeList.length&&(this.pageparm.startTime=this.getYMDHMS(new Date(this.timeList[0].toString())),this.pageparm.endTime=this.getYMDHMS(new Date(this.timeList[1].toString()))),this.risks.length&&(this.pageparm.risks=this.risks);var e=c+"/fault/export?";for(var t in this.pageparm)this.pageparm[t]&&(e+=t+"="+this.pageparm[t]+"&");console.log(e),s.a.get(e).then(function(t){console.log(e),window.location.href=e})},callFather:function(e){this.pageparm.pageNo=e.pageNo,this.pageparm.pageSize=e.pageSize,this.getFault()},getFault:function(){var e=this;this.carNumbers.length&&(this.pageparm.carNumbers=this.carNumbers),Object(s.a)({url:c+"/fault/screenfault",method:"post",data:{result:"未处理",state:"0",pageNo:this.pageparm.pageNo,pageSize:this.pageparm.pageSize}}).then(function(t){e.tableData=t.data.data.list||[],e.tableData=e.tableData.map(function(t){return t.deliveryDate=e.getYMDHMS(t.deliveryDate),t.risk="0"==t.risk?parseInt(0):parseInt(t.risk),t.code="null"==t.code?"":t.code,t.schedule="null"==t.schedule?"":t.schedule,t.respDepart="null"==t.respDepart?"":t.respDepart,t.notes="null"==t.notes?"":t.notes,t}),e.total=t.data.data.size,e.loading=!1}).catch(function(e){console.log(e)})},deleteById:function(e){var t=this;this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:c+"/fault/deletefaultid",params:{id:e.id}}).then(function(e){t.$message({message:"删除成功",type:"success"}),t.getFault()}).catch(function(e){console.log(e)})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},handleEdit:function(e,t){this.editFormVisible=!0,void 0!=t&&"undefined"!=t?(this.title="修改",this.editForm=t,"未处理"!=this.editForm.result&"长期跟踪"!=this.editForm.result?this.result="已处理":"未处理"==this.editForm.result?this.result="未处理":"长期跟踪"==this.editForm.result&&(this.result="长期跟踪")):(this.title="添加",this.editForm={},this.result="")},changeResult:function(){this.editForm.result=""},handelFault:function(){var e=this;this.$refs.editForm.validate(function(t){if(!t)return console.log("提交失败"),!1;if("已处理"!=e.result&&(e.editForm.result=e.result),e.editForm.risk=e.risk,"添加"==e.title)e.editForm.dimension="0",Object(s.a)({url:c+"/fault/insertfault",method:"post",data:e.editForm}).then(function(t){e.$message({message:e.title+"成功",type:"success"}),e.editFormVisible=!1,e.editForm={},e.initPage(),e.getFault()}).catch(function(t){console.log(t),e.$message({message:e.title+"失败",type:"error"}),e.editFormVisible=!1,e.editForm={},e.initPage(),e.getFault()});else{for(var a in e.editForm)!e.editForm[a]&"risk"!=a&&(e.editForm[a]="null");Object(s.a)({url:c+"/fault/updatefaultid",method:"post",data:e.editForm}).then(function(t){e.editFormVisible=!1,e.editForm={},e.$message.success("修改成功")}).catch(function(t){console.log(t),e.$message.error("请重新提交")})}})},closeDialog:function(){this.editFormVisible=!1,this.editForm={},this.initPage(),this.getFault()},handleUploadSuccess:function(e){this.uploadUrlPath=N()(e),this.loading.close()},handleBeforeUpload:function(){this.loading=this.$loading({lock:!0,text:"上传中",background:"rgba(0, 0, 0, 0.7)"})},handleUploadError:function(){this.$message({type:"error",message:"上传失败"}),this.loading.close()},handleRemove:function(e,t){console.log(e,t)},handlePreview:function(e){console.log(e)},handleExceed:function(e,t){this.$message.warning("当前限制选择文件个数，本次选择了 "+e.length+" 个文件，共选择了 "+(e.length+t.length)+" 个文件")},beforeRemove:function(e,t){return this.$confirm("确定移除 "+e.name+"？")},handleSuccess:function(){this.getFault(),this.$message.success("导入成功")},handleError:function(){this.getFault(),this.$message.error("导入格式错误，请修改后重新导入！")},resetRisk:function(){this.risk=0},changState:function(e,t){var a=this;this.$confirm("此操作将数据提交到高级修库, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:" "+c+"/fault/changestate",params:{id:e,state:1}}).then(function(e){a.$message.success("已转移到高级修库"),a.search()}).catch(function(e){a.$message.error("重新提交")})}).catch(function(){a.$message({type:"info",message:"已取消提交"})})},changeDimension:function(e,t){var a=this;this.$confirm("是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:" "+c+"/fault/changedimension",params:{id:e,dimension:t}}).then(function(e){a.$message.success("成功"),a.search()}).catch(function(e){a.$message.error("失败")})}).catch(function(){a.$message({type:"info",message:"已取消"})})},showModal:function(e){var t=this;Object(s.a)({url:c+"/fault/fileList/"+e,method:"get"}).then(function(e){t.dialogVisible=!0,t.attachmentList=e.data.data||[]})},handleCloseFile:function(e){e()},downloadAttachment:function(e){console.log("下载附件",e),D(c+"/fault/download/"+e.faultFileMidId,e.fileName)}}},he={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{ref:"searchForm",staticClass:"user-search",attrs:{inline:!0,model:e.pageparm}},[a("el-form-item",{attrs:{label:"处理结果：",prop:"result"}},[a("el-select",{attrs:{placeholder:"请选择处理结果"},on:{change:e.changeResultSelect},model:{value:e.pageparm.result,callback:function(t){e.$set(e.pageparm,"result",t)},expression:"pageparm.result"}},[a("el-option",{attrs:{label:"全部",value:"全部"}}),e._v(" "),a("el-option",{attrs:{label:"未处理",value:"未处理"}}),e._v(" "),a("el-option",{attrs:{label:"已处理",value:"已处理"}}),e._v(" "),a("el-option",{attrs:{label:"长期跟踪",value:"长期跟踪"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"标注",prop:"dimension"}},[a("el-select",{attrs:{placeholder:"请选择"},on:{change:e.changeUpdate},model:{value:e.pageparm.dimension,callback:function(t){e.$set(e.pageparm,"dimension",t)},expression:"pageparm.dimension"}},[a("el-option",{attrs:{label:"非重点关注",value:"0"}}),e._v(" "),a("el-option",{attrs:{label:"重点关注",value:"1"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"到料",prop:"material"}},[a("el-select",{attrs:{placeholder:"请选择到料情况"},model:{value:e.pageparm.material,callback:function(t){e.$set(e.pageparm,"material",t)},expression:"pageparm.material"}},[a("el-option",{attrs:{label:"无",value:"无"}}),e._v(" "),a("el-option",{attrs:{label:"否",value:"否"}}),e._v(" "),a("el-option",{attrs:{label:"是",value:"是"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"复核",prop:"review"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.pageparm.review,callback:function(t){e.$set(e.pageparm,"review",t)},expression:"pageparm.review"}},[a("el-option",{attrs:{label:"否",value:"0"}}),e._v(" "),a("el-option",{attrs:{label:"是",value:"1"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"车号",prop:"carNumber"}},[a("el-select",{attrs:{multiple:"",filterable:"",placeholder:"请选择车号"},model:{value:e.carNumbers,callback:function(t){e.carNumbers=t},expression:"carNumbers"}},e._l(e.carNumberList,function(e){return a("el-option",{key:e.value,attrs:{label:e.value,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"车厢号",prop:"carBodyNumber"}},[a("el-input",{attrs:{size:"small",placeholder:"输入车厢号"},model:{value:e.pageparm.carBodyNumber,callback:function(t){e.$set(e.pageparm,"carBodyNumber",t)},expression:"pageparm.carBodyNumber"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"交修日期"}},[a("el-col",{attrs:{span:11}},[a("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.timeList,callback:function(t){e.timeList=t},expression:"timeList"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"故障描述：",prop:"faultDescription"}},[a("el-input",{attrs:{size:"small",placeholder:"输入故障描述"},model:{value:e.pageparm.faultDescription,callback:function(t){e.$set(e.pageparm,"faultDescription",t)},expression:"pageparm.faultDescription"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"故障来源：",prop:"source"}},[a("el-input",{attrs:{size:"small",placeholder:"输入故障来源"},model:{value:e.pageparm.source,callback:function(t){e.$set(e.pageparm,"source",t)},expression:"pageparm.source"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"处理方法：",prop:"method"}},[a("el-input",{attrs:{size:"small",placeholder:"输入处理方法"},model:{value:e.pageparm.method,callback:function(t){e.$set(e.pageparm,"method",t)},expression:"pageparm.method"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"处理班组",prop:"teamsGroups"},on:{change:e.changeUpdate}},[a("el-input",{attrs:{size:"small",placeholder:"输入处理班组"},model:{value:e.pageparm.teamsGroups,callback:function(t){e.$set(e.pageparm,"teamsGroups",t)},expression:"pageparm.teamsGroups"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"功能分类",prop:"funClass"}},[a("el-select",{attrs:{placeholder:"请选择功能分类"},on:{change:e.changeUpdate},model:{value:e.pageparm.funClass,callback:function(t){e.$set(e.pageparm,"funClass",t)},expression:"pageparm.funClass"}},[a("el-option",{attrs:{label:"整车",value:"整车"}}),e._v(" "),a("el-option",{attrs:{label:"车体",value:"车体"}}),e._v(" "),a("el-option",{attrs:{label:"车端连接",value:"车端连接"}}),e._v(" "),a("el-option",{attrs:{label:"转向架及其辅助",value:"转向架及其辅助"}}),e._v(" "),a("el-option",{attrs:{label:"主供电",value:"主供电"}}),e._v(" "),a("el-option",{attrs:{label:"牵引",value:"牵引"}}),e._v(" "),a("el-option",{attrs:{label:"辅助电气",value:"辅助电气"}}),e._v(" "),a("el-option",{attrs:{label:"供风制动",value:"供风制动"}}),e._v(" "),a("el-option",{attrs:{label:"网络及辅助监控",value:"网络及辅助监控"}}),e._v(" "),a("el-option",{attrs:{label:"旅客信息",value:"旅客信息"}}),e._v(" "),a("el-option",{attrs:{label:"空调",value:"空调"}}),e._v(" "),a("el-option",{attrs:{label:"给排水卫生",value:"给排水卫生"}}),e._v(" "),a("el-option",{attrs:{label:"外门及车内设施",value:"外门及车内设施"}}),e._v(" "),a("el-option",{attrs:{label:"驾驶设施",value:"驾驶设施"}}),e._v(" "),a("el-option",{attrs:{label:"电务车载",value:"电务车载"}}),e._v(" "),a("el-option",{attrs:{label:"其他",value:"其他"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"处置分类",prop:"handle"}},[a("el-input",{attrs:{size:"small",placeholder:"输入处置分类"},model:{value:e.pageparm.handle,callback:function(t){e.$set(e.pageparm,"handle",t)},expression:"pageparm.handle"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"风险等级",prop:"risk"}},[a("el-select",{attrs:{multiple:"",filterable:"",placeholder:"请选择风险等级"},on:{change:e.changeUpdate},model:{value:e.risks,callback:function(t){e.risks=t},expression:"risks"}},[a("el-option",{attrs:{label:"无风险",value:0}}),e._v(" "),e._l(e.riskList,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}},[a("span",{staticStyle:{float:"left"}},[a("el-rate",{attrs:{max:t.value,disabled:""},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}})],1)])})],2)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-search"},on:{click:function(t){return e.search()}}},[e._v("搜索")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-refresh-right"},on:{click:function(t){return e.resetForm("searchForm")}}},[e._v("重置")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"warning",icon:"el-icon-star-off"},on:{click:function(t){return e.exportExcel()}}},[e._v("导出")])],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"",height:"600","row-style":e.rowStyle}},[a("el-table-column",{attrs:{type:"index",label:"序号",align:"center",width:"70",index:e.indexMethod,fixed:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"deliveryDate",label:"交修日期",width:"100",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"carNumber",label:"车号",width:"70",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"carBodyNumber",label:"车厢号",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"faultDescription",label:"故障描述",width:"180",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"teamsGroups",label:"处理班组",width:"100",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"result",label:"处理结果",width:"180",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s("null"==t.row.result?"":t.row.result)+"\n            ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"method",label:"处理方法",width:"200",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s("null"==t.row.method?"":t.row.method)+"\n            ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"material",label:"是否到料",width:"100",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"source",label:"故障来源",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s("null"==t.row.source?"":t.row.source)+"\n            ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"funClass",label:"功能分类",width:"130",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s("null"==t.row.funClass?"":t.row.funClass)+"\n            ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"risk",label:"风险等级",width:"100",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-rate",{attrs:{max:3,disabled:""},model:{value:t.row.risk,callback:function(a){e.$set(t.row,"risk",a)},expression:"scope.row.risk"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"handle",label:"处置分类",width:"150",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s("null"==t.row.handle?"":t.row.handle)+"\n            ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"notes",label:"备注",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s("null"==t.row.notes?"":t.row.notes)+"\n            ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"notes",label:"查看",align:"center",width:"130"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticClass:"icon-button",on:{click:function(a){return e.showModal(t.row.id)}}},[a("i",{staticClass:"el-icon-view"}),e._v("\n                    查看附件\n                ")])]}}])},[e._v(" "),a("el-dialog",{attrs:{title:"附件列表",visible:e.dialogVisible,width:"40%","before-close":e.handleCloseFile,"append-to-body":""},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.attachmentList}},[a("el-table-column",{attrs:{prop:"fileName",align:"center",label:"名称"},scopedSlots:e._u([{key:"default",fn:function(t){var l=t.row;return[a("el-link",{on:{click:function(t){return e.handleFileNameClick(l)}}},[e._v(e._s(l.fileName))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"fileType",align:"center",label:"类型"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var l=t.row;return[a("el-button",{attrs:{type:"primary",icon:"el-icon-download"},on:{click:function(t){return e.downloadAttachment(l)}}})]}}])})],1)],1)],1)],1),e._v(" "),a("Pagination",{attrs:{"child-msg":e.pageparm,total:e.total},on:{callFather:e.callFather}})],1)},staticRenderFns:[]};var ge=a("VU/8")(de,he,!1,function(e){a("XxQX")},"data-v-6e32065b",null).exports,fe={name:"Fault",components:{Pagination:T},data:function(){return{carNumbers:[],carNumberList:S,baseURL:c,timeList:[],tableData:[],editFormVisible:!1,title:"编辑",editForm:{risk:0,state:1},risk:0,result:"",rules:{deliveryDate:[{required:!0,message:"请输入日期",trigger:"blur"}],carNumber:[{required:!0,message:"请输入车号",trigger:"blur"}],carBodyNumber:[{required:!0,message:"请输入车厢号",trigger:"blur"}],faultDescription:[{required:!0,message:"请输入故障描述",trigger:"blur"}],teamsGroups:[{required:!0,message:"请选择班组",trigger:"blur"}],funClass:[{required:!0,message:"请选择功能分类",trigger:"blur"}],handle:[{required:!0,message:"请选择处置分类",trigger:"blur"}]},pageparm:{pageNo:1,pageSize:1e4,state:1},total:0,allList:[],loading:!0,teamsList:[],fileList:[],dialogVisible:!1,attachmentList:[]}},created:function(){this.search(),this.getTeams()},computed:{indexMethod:function(){return(this.pageparm.pageNo-1)*this.pageparm.pageSize+1}},methods:{resetForm:function(e){this.$refs[e].resetFields(),this.timeList=[],delete this.pageparm.startTime,delete this.pageparm.endTime,this.pageparm.carNumbers&&delete this.pageparm.carNumbers,this.carNumbers=[]},getTeams:function(){var e=this;Object(s.a)({url:c+"/teams/selectall"}).then(function(t){e.teamsList=t.data.data,e.loading=!1}).catch(function(e){console.log(e)})},search:function(){var e=this;this.carNumbers.length&&(this.pageparm.carNumbers=this.carNumbers),this.loading=!0,this.timeList.length&&(this.pageparm.startTime=this.getYMDHMS(new Date(this.timeList[0].toString())),this.pageparm.endTime=this.getYMDHMS(new Date(this.timeList[1].toString()))),this.pageparm.state=1,this.pageparm.pageNo=1,this.pageparm.pageSize=50,Object(s.a)({method:"post",url:c+"/fault/screenfault",data:this.pageparm}).then(function(t){e.$message.success("搜索成功"),e.tableData=t.data.data.list,e.tableData=e.tableData.map(function(t){return t.deliveryDate=e.getYMDHMS(t.deliveryDate),t.risk=(t.risk,0),t.code="null"==t.code?"":t.code,t.schedule="null"==t.schedule?"":t.schedule,t.respDepart="null"==t.respDepart?"":t.respDepart,t.notes="null"==t.notes?"":t.notes,t}),e.total=t.data.data.size,e.loading=!1}).catch(function(t){e.initPage(),e.getFault(),e.$message.error("搜索失败"),console.log(t)})},initPage:function(){this.pageparm={pageNo:1,pageSize:50}},getYMDHMS:function(e){var t=new Date(e);return t.getFullYear()+"-"+(t.getMonth()+1).toString().padStart(2,"0")+"-"+t.getDate().toString().padStart(2,"0")},exportExcel:function(){this.carNumbers.length&&(this.pageparm.carNumbers=this.carNumbers),this.timeList.length&&(this.pageparm.startTime=this.getYMDHMS(new Date(this.timeList[0].toString())),this.pageparm.endTime=this.getYMDHMS(new Date(this.timeList[1].toString())));var e=c+"/fault/exportsenior?";for(var t in this.pageparm)this.pageparm[t]&&(e+=t+"="+this.pageparm[t]+"&");s.a.get(e).then(function(t){console.log(e),window.location.href=e})},callFather:function(e){this.pageparm.pageNo=e.pageNo,this.pageparm.pageSize=e.pageSize,this.getFault()},getFault:function(){var e=this;this.carNumbers.length&&(this.pageparm.carNumbers=this.carNumbers),this.pageparm.state=1,Object(s.a)({url:c+"/fault/screenfault",method:"post",data:this.pageparm}).then(function(t){e.tableData=t.data.data.list,e.tableData=e.tableData.map(function(t){return t.deliveryDate=e.getYMDHMS(t.deliveryDate),t.risk=(t.risk,0),t.code="null"==t.code?"":t.code,t.schedule="null"==t.schedule?"":t.schedule,t.respDepart="null"==t.respDepart?"":t.respDepart,t.notes="null"==t.notes?"":t.notes,t}),e.total=t.data.data.size,e.loading=!1}).catch(function(e){console.log(e)})},deleteById:function(e){var t=this;this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:c+"/fault/deletefaultid",params:{id:e.id}}).then(function(e){t.$message({message:"删除成功",type:"success"}),t.getFault()}).catch(function(e){console.log(e)})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},handleEdit:function(e,t){this.editFormVisible=!0,void 0!=t&&"undefined"!=t?(this.title="修改",this.editForm=t,"未处理"!=this.editForm.result&"长期跟踪"!=this.editForm.result?this.result="已处理":"未处理"==this.editForm.result?this.result="未处理":"长期跟踪"==this.editForm.result&&(this.result="长期跟踪")):(this.title="添加",this.editForm={state:1})},changeResult:function(){this.editForm.result=""},handelFault:function(){var e=this;this.$refs.editForm.validate(function(t){if(!t)return console.log("提交失败"),!1;if("已处理"!=e.result&&(e.editForm.result=e.result),e.editForm.risk=e.risk,"添加"==e.title)Object(s.a)({url:c+"/fault/insertfault",method:"post",data:e.editForm}).then(function(t){e.$message({message:e.title+"成功",type:"success"}),e.editFormVisible=!1,e.editForm={},e.initPage(),e.getFault()}).catch(function(t){console.log(t),e.$message({message:e.title+"失败",type:"error"}),e.editFormVisible=!1,e.editForm={},e.initPage(),e.getFault()});else{for(var a in e.editForm)!e.editForm[a]&"risk"!=a&&(e.editForm[a]="null");Object(s.a)({url:c+"/fault/updatefaultid",method:"post",data:e.editForm}).then(function(t){e.editFormVisible=!1,e.editForm={}}).catch(function(e){console.log(e)})}})},closeDialog:function(){this.editFormVisible=!1,this.editForm={},this.initPage(),this.getFault()},handleUploadSuccess:function(e){this.uploadUrlPath=N()(e),this.loading.close()},handleBeforeUpload:function(){this.loading=this.$loading({lock:!0,text:"上传中",background:"rgba(0, 0, 0, 0.7)"})},handleUploadError:function(){this.$message({type:"error",message:"上传失败"}),this.loading.close()},handleRemove:function(e,t){console.log(e,t)},handlePreview:function(e){console.log(e)},handleExceed:function(e,t){this.$message.warning("当前限制选择文件个数，本次选择了 "+e.length+" 个文件，共选择了 "+(e.length+t.length)+" 个文件")},beforeRemove:function(e,t){return this.$confirm("确定移除 "+e.name+"？")},handleSuccess:function(){this.getFault(),this.$message.success("导入成功")},handleError:function(){this.getFault(),this.$message.error("导入格式错误，请修改后重新导入！")},resetRisk:function(){this.risk=0},changState:function(e,t){var a=this;this.$confirm("此操作将数据提交到故障库, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:" "+c+"/fault/changestate",params:{id:e,state:0}}).then(function(e){a.$message.success("已转移到故障库"),a.search()}).catch(function(e){a.$message.error("重新提交")})}).catch(function(){a.$message({type:"info",message:"已取消提交"})})},showModal:function(e){var t=this;Object(s.a)({url:c+"/fault/fileList/"+e,method:"get"}).then(function(e){t.dialogVisible=!0,t.attachmentList=e.data.data||[]})},handleCloseFile:function(e){e()},downloadAttachment:function(e){console.log("下载附件",e),downloadFile(c+"/fault/download/"+e.faultFileMidId,e.fileName)}}},be={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{ref:"searchForm",staticClass:"user-search",attrs:{inline:!0,model:e.pageparm}},[a("el-form-item",{attrs:{label:"处理结果：",prop:"result"}},[a("el-select",{attrs:{placeholder:"请选择处理结果"},model:{value:e.pageparm.result,callback:function(t){e.$set(e.pageparm,"result",t)},expression:"pageparm.result"}},[a("el-option",{attrs:{label:"未处理",value:"未处理"}}),e._v(" "),a("el-option",{attrs:{label:"已处理",value:"已处理"}}),e._v(" "),a("el-option",{attrs:{label:"长期跟踪",value:"长期跟踪"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"交修日期"}},[a("el-col",{attrs:{span:11}},[a("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.timeList,callback:function(t){e.timeList=t},expression:"timeList"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"车号",prop:"carNumber"}},[a("el-select",{attrs:{multiple:"",filterable:"",placeholder:"请选择车号"},model:{value:e.carNumbers,callback:function(t){e.carNumbers=t},expression:"carNumbers"}},e._l(e.carNumberList,function(e){return a("el-option",{key:e.value,attrs:{label:e.value,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"车箱号",prop:"carBodyNumber"}},[a("el-input",{attrs:{size:"small",placeholder:"输入车厢号"},model:{value:e.pageparm.carBodyNumber,callback:function(t){e.$set(e.pageparm,"carBodyNumber",t)},expression:"pageparm.carBodyNumber"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"故障描述：",prop:"faultDescription"}},[a("el-input",{attrs:{size:"small",placeholder:"输入故障描述"},model:{value:e.pageparm.faultDescription,callback:function(t){e.$set(e.pageparm,"faultDescription",t)},expression:"pageparm.faultDescription"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"故障来源：",prop:"source"}},[a("el-input",{attrs:{size:"small",placeholder:"输入故障来源"},model:{value:e.pageparm.source,callback:function(t){e.$set(e.pageparm,"source",t)},expression:"pageparm.source"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"处理方法：",prop:"method"}},[a("el-input",{attrs:{size:"small",placeholder:"输入处理方法"},model:{value:e.pageparm.method,callback:function(t){e.$set(e.pageparm,"method",t)},expression:"pageparm.method"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-search"},on:{click:function(t){return e.search()}}},[e._v("搜索")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-refresh-right"},on:{click:function(t){return e.resetForm("searchForm")}}},[e._v("重置")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"warning",icon:"el-icon-star-off"},on:{click:function(t){return e.exportExcel()}}},[e._v("导出")])],1)],1),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"",height:"700"}},[a("el-table-column",{attrs:{type:"index",label:"序号",align:"center",width:"80",index:e.indexMethod,fixed:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"deliveryDate",label:"交修日期",width:"100",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"carNumber",label:"车号",width:"70",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"carBodyNumber",label:"车厢号",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"faultDescription",label:"故障描述",width:"180",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"teamsGroups",label:"处理班组",width:"180",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"result",label:"处理结果",width:"150",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"method",label:"处理方法",width:"180",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"source",label:"故障来源",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s("null"==t.row.source?"":t.row.source)+"\n            ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"notes",label:"车组预计送修时间",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s("null"==t.row.notes?"":t.row.notes)+"\n            ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"notes",label:"查看",align:"center",width:"130"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticClass:"icon-button",on:{click:function(a){return e.showModal(t.row.id)}}},[a("i",{staticClass:"el-icon-view"}),e._v("\n                    查看附件\n                ")])]}}])},[e._v(" "),a("el-dialog",{attrs:{title:"附件列表",visible:e.dialogVisible,width:"40%","before-close":e.handleCloseFile,"append-to-body":""},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.attachmentList}},[a("el-table-column",{attrs:{prop:"fileName",align:"center",label:"名称"},scopedSlots:e._u([{key:"default",fn:function(t){var l=t.row;return[a("el-link",{on:{click:function(t){return e.handleFileNameClick(l)}}},[e._v(e._s(l.fileName))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"fileType",align:"center",label:"类型"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var l=t.row;return[a("el-button",{attrs:{type:"primary",icon:"el-icon-download"},on:{click:function(t){return e.downloadAttachment(l)}}})]}}])})],1)],1)],1)],1),e._v(" "),a("Pagination",{attrs:{"child-msg":e.pageparm,total:e.total},on:{callFather:e.callFather}})],1)},staticRenderFns:[]};var ve=a("VU/8")(fe,be,!1,function(e){a("dxWL")},"data-v-75b2034b",null).exports,_e={name:"Fault",components:{Pagination:T},data:function(){return{carNumbers:[],carNumberList:S,baseURL:c,timeList:[],tableData:[],editFormVisible:!1,title:"编辑",editForm:{state:2,risk:0},risk:0,result:"",rules:{deliveryDate:[{required:!0,message:"请输入日期",trigger:"blur"}],carNumber:[{required:!0,message:"请输入车号",trigger:"blur"}],carBodyNumber:[{required:!0,message:"请输入车厢号",trigger:"blur"}],faultDescription:[{required:!0,message:"请输入故障描述",trigger:"blur"}],teamsGroups:[{required:!0,message:"请选择班组",trigger:"blur"}],funClass:[{required:!0,message:"请选择功能分类",trigger:"blur"}],handle:[{required:!0,message:"请选择处置分类",trigger:"blur"}],method:[{required:!0,message:"请输入处理方法",trigger:"blur"}],source:[{required:!0,message:"请输入故障来源",trigger:"blur"}],trackPerson:[{required:!0,message:"请输入责任人",trigger:"blur"}]},pageparm:{pageNo:1,pageSize:1e5,state:2},total:0,allList:[],headers:"'Content-Type': 'multipart/form-data'",loading:!0,teamsList:[],riskList:[{label:"⭐",value:1},{label:"⭐⭐",value:2},{label:"⭐⭐⭐",value:3}],fileList:[],dialogVisible:!1,attachmentList:[]}},created:function(){this.getFault(),this.getTeams()},computed:{indexMethod:function(){return(this.pageparm.pageNo-1)*this.pageparm.pageSize+1}},methods:{rowStyle:function(e){if(1==e.row.dimension)return{background:"antiquewhite"}},changeUpdate:function(){this.$forceUpdate()},changeResultSelect:function(){"全部"==this.pageparm.result&&delete this.pageparm.result},resetForm:function(e){this.$refs[e].resetFields(),this.timeList=[],delete this.pageparm.startTime,delete this.pageparm.endTime,this.pageparm.carNumbers&&delete this.pageparm.carNumbers,this.carNumbers=[],this.pageparm.risks&&delete this.pageparm.risks,this.risks=[]},getTeams:function(){var e=this;Object(s.a)({url:c+"/teams/selectall"}).then(function(t){e.teamsList=t.data.data,e.loading=!1}).catch(function(e){console.log(e)})},search:function(){var e=this;this.carNumbers.length&&(this.pageparm.carNumbers=this.carNumbers),this.loading=!0,this.timeList.length&&(this.pageparm.startTime=this.getYMDHMS(new Date(this.timeList[0].toString())),this.pageparm.endTime=this.getYMDHMS(new Date(this.timeList[1].toString()))),this.risks.length&&(this.pageparm.risks=this.risks),this.pageparm.pageNo=1,this.pageparm.pageSize=1e5,Object(s.a)({method:"post",url:c+"/fault/screenfault",data:this.pageparm}).then(function(t){e.tableData=t.data.data.list,e.tableData=e.tableData.map(function(t){return t.deliveryDate=e.getYMDHMS(t.deliveryDate),t.risk="0"==t.risk?0:parseInt(t.risk),t.code="null"==t.code?"":t.code,t.schedule="null"==t.schedule?"":t.schedule,t.respDepart="null"==t.respDepart?"":t.respDepart,t.notes="null"==t.notes?"":t.notes,t}),e.total=t.data.data.size,e.loading=!1,e.$message.success("搜索成功")}).catch(function(t){e.initPage(),e.getFault(),e.$message.error("搜索失败"),console.log(t)})},initPage:function(){this.pageparm={pageNo:1,pageSize:1e5,state:2}},getYMDHMS:function(e){var t=new Date(e);return t.getFullYear()+"-"+(t.getMonth()+1).toString().padStart(2,"0")+"-"+t.getDate().toString().padStart(2,"0")},exportExcel:function(){"全部"==this.pageparm.result&&delete this.pageparm.result,this.carNumbers.length&&(this.pageparm.carNumbers=this.carNumbers),this.timeList.length&&(this.pageparm.startTime=this.getYMDHMS(new Date(this.timeList[0].toString())),this.pageparm.endTime=this.getYMDHMS(new Date(this.timeList[1].toString()))),this.risks.length&&(this.pageparm.risks=this.risks);var e=c+"/fault/exporttrack?";for(var t in this.pageparm)this.pageparm[t]&&(e+=t+"="+this.pageparm[t]+"&");console.log(e),s.a.get(e).then(function(t){console.log(e),window.location.href=e})},callFather:function(e){this.pageparm.pageNo=e.pageNo,this.pageparm.pageSize=e.pageSize,this.getFault()},getFault:function(){var e=this;this.carNumbers.length&&(this.pageparm.carNumbers=this.carNumbers),Object(s.a)({url:c+"/fault/screenfault",method:"post",data:this.pageparm}).then(function(t){e.tableData=t.data.data.list||[],e.tableData=e.tableData.map(function(t){return t.deliveryDate=e.getYMDHMS(t.deliveryDate),t.risk="0"==t.risk?parseInt(0):parseInt(t.risk),t.code="null"==t.code?"":t.code,t.schedule="null"==t.schedule?"":t.schedule,t.respDepart="null"==t.respDepart?"":t.respDepart,t.notes="null"==t.notes?"":t.notes,t}),e.total=t.data.data.size,e.loading=!1}).catch(function(e){console.log(e)})},deleteById:function(e){var t=this;this.$confirm("此操作将永久删除, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:c+"/fault/deletefaultid",params:{id:e.id}}).then(function(e){t.$message({message:"删除成功",type:"success"}),t.getFault()}).catch(function(e){console.log(e)})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},handleEdit:function(e,t){this.editFormVisible=!0,void 0!=t&&"undefined"!=t?(this.title="修改",this.editForm=t,"未处理"!=this.editForm.result&"长期跟踪"!=this.editForm.result?this.result="已处理":"未处理"==this.editForm.result?this.result="未处理":"长期跟踪"==this.editForm.result&&(this.result="长期跟踪"),this.risk=t.risk):(this.title="添加",this.editForm={},this.result="")},changeResult:function(){this.editForm.result=""},handelFault:function(){var e=this;this.$refs.editForm.validate(function(t){if(!t)return console.log("提交失败"),!1;if("已处理"!=e.result&&(e.editForm.result=e.result),e.editForm.risk=e.risk,"添加"==e.title)e.editForm.dimension="0",Object(s.a)({url:c+"/fault/insertfault",method:"post",data:e.editForm}).then(function(t){e.$message({message:e.title+"成功",type:"success"}),e.editFormVisible=!1,e.editForm={},e.risk=0,e.initPage(),e.getFault()}).catch(function(t){console.log(t),e.$message({message:e.title+"失败",type:"error"}),e.editFormVisible=!1,e.editForm={},e.risk=0,e.initPage(),e.getFault()});else{for(var a in e.editForm)!e.editForm[a]&"risk"!=a&&(e.editForm[a]="null");Object(s.a)({url:c+"/fault/updatefaultid",method:"post",data:e.editForm}).then(function(t){e.editFormVisible=!1,e.editForm={},e.risk=0,e.$message.success("修改成功")}).catch(function(t){console.log(t),e.$message.error("请重新提交")})}})},closeDialog:function(){this.editFormVisible=!1,this.editForm={},this.risk=0,this.initPage(),this.getFault()},handleUploadSuccess:function(e){this.uploadUrlPath=N()(e),this.loading.close()},handleBeforeUpload:function(){this.loading=this.$loading({lock:!0,text:"上传中",background:"rgba(0, 0, 0, 0.7)"})},handleUploadError:function(){this.$message({type:"error",message:"上传失败"}),this.loading.close()},handleRemove:function(e,t){console.log(e,t)},handlePreview:function(e){console.log(e)},handleExceed:function(e,t){this.$message.warning("当前限制选择文件个数，本次选择了 "+e.length+" 个文件，共选择了 "+(e.length+t.length)+" 个文件")},beforeRemove:function(e,t){return this.$confirm("确定移除 "+e.name+"？")},handleSuccess:function(){this.getFault(),this.$message.success("导入成功")},handleError:function(){this.getFault(),this.$message.error("导入格式错误，请修改后重新导入！")},resetRisk:function(){this.risk=0},changeDimension:function(e,t){var a=this;this.$confirm("此操作将数据列为重点故障，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:" "+c+"/fault/changedimension",params:{id:e,dimension:t}}).then(function(e){a.$message.success("成功"),a.search()}).catch(function(e){a.$message.error("失败")})}).catch(function(){a.$message({type:"info",message:"已取消"})})},changeTrack:function(e){var t=this;this.$confirm("此操作将数据提交到故障遗留列表, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:" "+c+"/fault/changestate",params:{id:e,state:0,trackPerson:""}}).then(function(e){t.$message.success("已转移到故障遗留库"),t.search()}).catch(function(e){t.$message.error("重新提交")})}).catch(function(){t.$message({type:"info",message:"已取消提交"})})},showModal:function(e){var t=this;Object(s.a)({url:c+"/fault/fileList/"+e,method:"get"}).then(function(e){t.dialogVisible=!0,t.attachmentList=e.data.data||[]})},handleCloseFile:function(e){e()},downloadAttachment:function(e){console.log("下载附件",e),downloadFile(c+"/fault/download/"+e.faultFileMidId,e.fileName)}}},ye={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{ref:"searchForm",staticClass:"user-search",attrs:{inline:!0,model:e.pageparm}},[a("el-form-item",{attrs:{label:"处理结果：",prop:"result"}},[a("el-select",{attrs:{placeholder:"请选择处理结果"},on:{change:e.changeResultSelect},model:{value:e.pageparm.result,callback:function(t){e.$set(e.pageparm,"result",t)},expression:"pageparm.result"}},[a("el-option",{attrs:{label:"全部",value:"全部"}}),e._v(" "),a("el-option",{attrs:{label:"未处理",value:"未处理"}}),e._v(" "),a("el-option",{attrs:{label:"已处理",value:"已处理"}}),e._v(" "),a("el-option",{attrs:{label:"长期跟踪",value:"长期跟踪"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"标注",prop:"dimension"}},[a("el-select",{attrs:{placeholder:"请选择"},on:{change:e.changeUpdate},model:{value:e.pageparm.dimension,callback:function(t){e.$set(e.pageparm,"dimension",t)},expression:"pageparm.dimension"}},[a("el-option",{attrs:{label:"非重点关注",value:"0"}}),e._v(" "),a("el-option",{attrs:{label:"重点关注",value:"1"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"到料",prop:"material"}},[a("el-select",{attrs:{placeholder:"请选择到料情况"},model:{value:e.pageparm.material,callback:function(t){e.$set(e.pageparm,"material",t)},expression:"pageparm.material"}},[a("el-option",{attrs:{label:"无",value:"无"}}),e._v(" "),a("el-option",{attrs:{label:"否",value:"否"}}),e._v(" "),a("el-option",{attrs:{label:"是",value:"是"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"复核",prop:"review"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.pageparm.review,callback:function(t){e.$set(e.pageparm,"review",t)},expression:"pageparm.review"}},[a("el-option",{attrs:{label:"否",value:"0"}}),e._v(" "),a("el-option",{attrs:{label:"是",value:"1"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"车号",prop:"carNumber"}},[a("el-select",{attrs:{multiple:"",filterable:"",placeholder:"请选择车号"},model:{value:e.carNumbers,callback:function(t){e.carNumbers=t},expression:"carNumbers"}},e._l(e.carNumberList,function(e){return a("el-option",{key:e.value,attrs:{label:e.value,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"车厢号",prop:"carBodyNumber"}},[a("el-input",{attrs:{size:"small",placeholder:"输入车厢号"},model:{value:e.pageparm.carBodyNumber,callback:function(t){e.$set(e.pageparm,"carBodyNumber",t)},expression:"pageparm.carBodyNumber"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"责任人",prop:"trackPerson"}},[a("el-input",{attrs:{size:"small",placeholder:"输入责任人"},model:{value:e.pageparm.trackPerson,callback:function(t){e.$set(e.pageparm,"trackPerson",t)},expression:"pageparm.trackPerson"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"交修日期"}},[a("el-col",{attrs:{span:11}},[a("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.timeList,callback:function(t){e.timeList=t},expression:"timeList"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"故障描述：",prop:"faultDescription"}},[a("el-input",{attrs:{size:"small",placeholder:"输入故障描述"},model:{value:e.pageparm.faultDescription,callback:function(t){e.$set(e.pageparm,"faultDescription",t)},expression:"pageparm.faultDescription"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"影响进度原因：",prop:"schedule"}},[a("el-input",{attrs:{size:"small",placeholder:"输入影响进度原因"},model:{value:e.pageparm.schedule,callback:function(t){e.$set(e.pageparm,"schedule",t)},expression:"pageparm.schedule"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"故障来源：",prop:"source"}},[a("el-input",{attrs:{size:"small",placeholder:"输入故障来源"},model:{value:e.pageparm.source,callback:function(t){e.$set(e.pageparm,"source",t)},expression:"pageparm.source"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"处理方法：",prop:"method"}},[a("el-input",{attrs:{size:"small",placeholder:"输入处理方法"},model:{value:e.pageparm.method,callback:function(t){e.$set(e.pageparm,"method",t)},expression:"pageparm.method"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"处理班组",prop:"teamsGroups"},on:{change:e.changeUpdate}},[a("el-input",{attrs:{size:"small",placeholder:"输入处理班组"},model:{value:e.pageparm.teamsGroups,callback:function(t){e.$set(e.pageparm,"teamsGroups",t)},expression:"pageparm.teamsGroups"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"功能分类",prop:"funClass"}},[a("el-select",{attrs:{placeholder:"请选择功能分类"},on:{change:e.changeUpdate},model:{value:e.pageparm.funClass,callback:function(t){e.$set(e.pageparm,"funClass",t)},expression:"pageparm.funClass"}},[a("el-option",{attrs:{label:"整车",value:"整车"}}),e._v(" "),a("el-option",{attrs:{label:"车体",value:"车体"}}),e._v(" "),a("el-option",{attrs:{label:"车端连接",value:"车端连接"}}),e._v(" "),a("el-option",{attrs:{label:"转向架及其辅助",value:"转向架及其辅助"}}),e._v(" "),a("el-option",{attrs:{label:"主供电",value:"主供电"}}),e._v(" "),a("el-option",{attrs:{label:"牵引",value:"牵引"}}),e._v(" "),a("el-option",{attrs:{label:"辅助电气",value:"辅助电气"}}),e._v(" "),a("el-option",{attrs:{label:"供风制动",value:"供风制动"}}),e._v(" "),a("el-option",{attrs:{label:"网络及辅助监控",value:"网络及辅助监控"}}),e._v(" "),a("el-option",{attrs:{label:"旅客信息",value:"旅客信息"}}),e._v(" "),a("el-option",{attrs:{label:"空调",value:"空调"}}),e._v(" "),a("el-option",{attrs:{label:"给排水卫生",value:"给排水卫生"}}),e._v(" "),a("el-option",{attrs:{label:"外门及车内设施",value:"外门及车内设施"}}),e._v(" "),a("el-option",{attrs:{label:"驾驶设施",value:"驾驶设施"}}),e._v(" "),a("el-option",{attrs:{label:"电务车载",value:"电务车载"}}),e._v(" "),a("el-option",{attrs:{label:"其他",value:"其他"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"处置分类",prop:"handle"}},[a("el-input",{attrs:{size:"small",placeholder:"输入处置分类"},model:{value:e.pageparm.handle,callback:function(t){e.$set(e.pageparm,"handle",t)},expression:"pageparm.handle"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"风险等级",prop:"risk"}},[a("el-select",{attrs:{multiple:"",filterable:"",placeholder:"请选择风险等级"},on:{change:e.changeUpdate},model:{value:e.risks,callback:function(t){e.risks=t},expression:"risks"}},[a("el-option",{attrs:{label:"无风险",value:0}}),e._v(" "),e._l(e.riskList,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}},[a("span",{staticStyle:{float:"left"}},[a("el-rate",{attrs:{max:t.value,disabled:""},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}})],1)])})],2)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-search"},on:{click:function(t){return e.search()}}},[e._v("搜索")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-refresh-right"},on:{click:function(t){return e.resetForm("searchForm")}}},[e._v("重置")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"warning",icon:"el-icon-star-off"},on:{click:function(t){return e.exportExcel()}}},[e._v("导出")])],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"",height:"600","row-style":e.rowStyle}},[a("el-table-column",{attrs:{type:"index",label:"序号",align:"center",width:"70",index:e.indexMethod,fixed:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"deliveryDate",label:"交修日期",width:"100",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"carNumber",label:"车号",width:"70",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"carBodyNumber",label:"车厢号",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"trackPerson",label:"责任人",width:"100",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"trackRequire",label:"追踪要求",width:"180",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"feedback",label:"反馈实现",width:"100",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"faultDescription",label:"故障描述",width:"180",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"teamsGroups",label:"处理班组",width:"100",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"result",label:"处理结果",width:"180",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s("null"==t.row.result?"":t.row.result)+"\n            ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"method",label:"处理方法",width:"200",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s("null"==t.row.method?"":t.row.method)+"\n            ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"source",label:"故障来源",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s("null"==t.row.source?"":t.row.source)+"\n            ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"funClass",label:"功能分类",width:"130",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s("null"==t.row.funClass?"":t.row.funClass)+"\n            ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"risk",label:"风险等级",width:"100",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-rate",{attrs:{max:3,disabled:""},model:{value:t.row.risk,callback:function(a){e.$set(t.row,"risk",a)},expression:"scope.row.risk"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"handle",label:"处置分类",width:"150",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s("null"==t.row.handle?"":t.row.handle)+"\n            ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"notes",label:"备注",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s("null"==t.row.notes?"":t.row.notes)+"\n            ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"notes",label:"查看",align:"center",width:"130"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticClass:"icon-button",on:{click:function(a){return e.showModal(t.row.id)}}},[a("i",{staticClass:"el-icon-view"}),e._v("\n                    查看附件\n                ")])]}}])},[e._v(" "),a("el-dialog",{attrs:{title:"附件列表",visible:e.dialogVisible,width:"40%","before-close":e.handleCloseFile,"append-to-body":""},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.attachmentList}},[a("el-table-column",{attrs:{prop:"fileName",align:"center",label:"名称"},scopedSlots:e._u([{key:"default",fn:function(t){var l=t.row;return[a("el-link",{on:{click:function(t){return e.handleFileNameClick(l)}}},[e._v(e._s(l.fileName))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"fileType",align:"center",label:"类型"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var l=t.row;return[a("el-button",{attrs:{type:"primary",icon:"el-icon-download"},on:{click:function(t){return e.downloadAttachment(l)}}})]}}])})],1)],1)],1)],1),e._v(" "),a("Pagination",{attrs:{"child-msg":e.pageparm,total:e.total},on:{callFather:e.callFather}})],1)},staticRenderFns:[]};var Ne=a("VU/8")(_e,ye,!1,function(e){a("Dcuy")},"data-v-435ebb6f",null).exports,Fe={name:"Fault",components:{Pagination:T},data:function(){return{carNumbers:[],carNumberList:S,baseURL:c,timeList:[],tableData:[],editFormVisible:!1,dialogTrackVisible:!1,title:"编辑",editForm:{},editTrackForm:{},risk:0,result:"",rules:{deliveryDate:[{required:!0,message:"请输入日期",trigger:"blur"}],carNumber:[{required:!0,message:"请输入车号",trigger:"blur"}],carBodyNumber:[{required:!0,message:"请输入车厢号",trigger:"blur"}],faultDescription:[{required:!0,message:"请输入故障描述",trigger:"blur"}],teamsGroups:[{required:!0,message:"请选择班组",trigger:"blur"}],funClass:[{required:!0,message:"请选择功能分类",trigger:"blur"}],handle:[{required:!0,message:"请选择处置分类",trigger:"blur"}],method:[{required:!0,message:"请输入处理方法",trigger:"blur"}],source:[{required:!0,message:"请输入故障来源",trigger:"blur"}]},trackRules:{trackPerson:[{required:!0,message:"请输入责任人",trigger:"blur"}],trackRequire:[{required:!0,message:"请输入追踪要求",trigger:"blur"}],feedback:[{required:!0,message:"请输入反馈实现",trigger:"blur"}]},pageparm:{pageNo:1,pageSize:1e5,result:"未处理",state:0},total:0,allList:[],headers:"'Content-Type': 'multipart/form-data'",loading:!0,teamsList:[],riskList:[{label:"一星",value:1},{label:"二星",value:2},{label:"三星",value:3}],id:0}},created:function(){this.getFault(),this.getTeams()},computed:{indexMethod:function(){return(this.pageparm.pageNo-1)*this.pageparm.pageSize+1}},methods:{rowStyle:function(e){if(1==e.row.dimension)return{background:"antiquewhite"}},changeUpdate:function(){this.$forceUpdate()},changeResultSelect:function(){"全部"==this.pageparm.result&&delete this.pageparm.result},resetForm:function(e){this.$refs[e].resetFields(),this.timeList=[],delete this.pageparm.startTime,delete this.pageparm.endTime,this.pageparm.carNumbers&&delete this.pageparm.carNumbers,this.carNumbers=[]},getTeams:function(){var e=this;Object(s.a)({url:c+"/teams/selectall"}).then(function(t){e.teamsList=t.data.data,e.loading=!1}).catch(function(e){console.log(e)})},search:function(){var e=this;this.carNumbers.length&&(this.pageparm.carNumbers=this.carNumbers),this.loading=!0,this.timeList.length&&(this.pageparm.startTime=this.getYMDHMS(new Date(this.timeList[0].toString())),this.pageparm.endTime=this.getYMDHMS(new Date(this.timeList[1].toString()))),this.pageparm.pageNo=1,this.pageparm.pageSize=1e5,Object(s.a)({method:"post",url:c+"/tedsfault/screenfault",data:this.pageparm}).then(function(t){e.tableData=t.data.data.list,e.tableData=e.tableData.map(function(t){return t.deliveryDate=e.getYMDHMS(t.deliveryDate),t.risk="0"==t.risk?0:parseInt(t.risk),t.code="null"==t.code?"":t.code,t.schedule="null"==t.schedule?"":t.schedule,t.respDepart="null"==t.respDepart?"":t.respDepart,t.notes="null"==t.notes?"":t.notes,t}),e.total=t.data.data.size,e.loading=!1,e.$message.success("搜索成功")}).catch(function(t){e.initPage(),e.getFault(),e.$message.error("搜索失败"),console.log(t)})},initPage:function(){this.pageparm={pageNo:1,pageSize:1e5,state:0}},getYMDHMS:function(e){var t=new Date(e);return t.getFullYear()+"-"+(t.getMonth()+1).toString().padStart(2,"0")+"-"+t.getDate().toString().padStart(2,"0")},exportExcel:function(){"全部"==this.pageparm.result&&delete this.pageparm.result,this.carNumbers.length&&(this.pageparm.carNumbers=this.carNumbers),this.timeList.length&&(this.pageparm.startTime=this.getYMDHMS(new Date(this.timeList[0].toString())),this.pageparm.endTime=this.getYMDHMS(new Date(this.timeList[1].toString())));var e=c+"/tedsfault/export?";for(var t in this.pageparm)this.pageparm[t]&&(e+=t+"="+this.pageparm[t]+"&");console.log(e),s.a.get(e).then(function(t){console.log(e),window.location.href=e})},callFather:function(e){this.pageparm.pageNo=e.pageNo,this.pageparm.pageSize=e.pageSize,this.getFault()},getFault:function(){var e=this;this.carNumbers.length&&(this.pageparm.carNumbers=this.carNumbers),Object(s.a)({url:c+"/tedsfault/screenfault",method:"post",data:this.pageparm}).then(function(t){e.tableData=t.data.data.list||[],e.tableData=e.tableData.map(function(t){return t.deliveryDate=e.getYMDHMS(t.deliveryDate),t.risk="0"==t.risk?parseInt(0):parseInt(t.risk),t.code="null"==t.code?"":t.code,t.schedule="null"==t.schedule?"":t.schedule,t.respDepart="null"==t.respDepart?"":t.respDepart,t.notes="null"==t.notes?"":t.notes,t}),e.total=t.data.data.size,e.loading=!1}).catch(function(e){console.log(e)})},deleteById:function(e){var t=this;this.$confirm("此操作将永久删除, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:c+"/tedsfault/deletefaultid",params:{id:e.id}}).then(function(e){t.$message({message:"删除成功",type:"success"}),t.getFault()}).catch(function(e){console.log(e)})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},handleEdit:function(e,t){this.editFormVisible=!0,void 0!=t&&"undefined"!=t?(this.title="修改",this.editForm=t,"未处理"!=this.editForm.result&"长期跟踪"!=this.editForm.result?this.result="已处理":"未处理"==this.editForm.result?this.result="未处理":"长期跟踪"==this.editForm.result&&(this.result="长期跟踪"),this.risk=t.risk):(this.title="添加",this.editForm={},this.result="")},changeResult:function(){this.editForm.result=""},handelFault:function(){var e=this;this.$refs.editForm.validate(function(t){if(!t)return console.log("提交失败"),!1;if("已处理"!=e.result&&(e.editForm.result=e.result),e.editForm.risk=e.risk,"添加"==e.title)e.editForm.dimension="0",Object(s.a)({url:c+"/tedsfault/insertfault",method:"post",data:e.editForm}).then(function(t){e.$message({message:e.title+"成功",type:"success"}),e.editFormVisible=!1,e.editForm={},e.risk=0,e.initPage(),e.getFault()}).catch(function(t){console.log(t),e.$message({message:e.title+"失败",type:"error"}),e.editFormVisible=!1,e.editForm={},e.risk=0,e.initPage(),e.getFault()});else{for(var a in e.editForm)!e.editForm[a]&"risk"!=a&&(e.editForm[a]="null");Object(s.a)({url:c+"/tedsfault/updatefaultid",method:"post",data:e.editForm}).then(function(t){e.editFormVisible=!1,e.editForm={},e.risk=0,e.$message.success("修改成功")}).catch(function(t){console.log(t),e.$message.error("请重新提交")})}})},closeDialog:function(){this.editFormVisible=!1,this.editForm={},this.risk=0,this.initPage(),this.getFault()},handleUploadSuccess:function(e){this.uploadUrlPath=N()(e),this.loading.close()},handleBeforeUpload:function(){this.loading=this.$loading({lock:!0,text:"上传中",background:"rgba(0, 0, 0, 0.7)"})},handleUploadError:function(){this.$message({type:"error",message:"上传失败"}),this.loading.close()},handleRemove:function(e,t){console.log(e,t)},handlePreview:function(e){console.log(e)},handleExceed:function(e,t){this.$message.warning("当前限制选择文件个数，本次选择了 "+e.length+" 个文件，共选择了 "+(e.length+t.length)+" 个文件")},beforeRemove:function(e,t){return this.$confirm("确定移除 "+e.name+"？")},handleSuccess:function(){this.getFault(),this.$message.success("导入成功")},handleError:function(){this.getFault(),this.$message.error("导入格式错误，请修改后重新导入！")},resetRisk:function(){this.risk=0},changState:function(e,t){var a=this;this.$confirm("此操作将数据提交到高级修库, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:" "+c+"/tedsfault/changestate",params:{id:e,state:1}}).then(function(e){a.$message.success("已转移到高级修库"),a.search()}).catch(function(e){a.$message.error("重新提交")})}).catch(function(){a.$message({type:"info",message:"已取消提交"})})},changeTrack:function(){var e=this;this.$refs.editTrackForm.validate(function(t){if(!t)return console.log("请输入责任人"),!1;e.$confirm("此操作将数据提交到故障追踪列表, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:" "+c+"/tedsfault/changestate",params:{id:e.id,state:2,trackPerson:e.editTrackForm.trackPerson,trackRequire:e.editTrackForm.trackRequire,feedback:e.editTrackForm.feedback}}).then(function(t){e.$message.success("已转移到故障追踪列表"),e.search(),e.dialogTrackVisible=!1,e.editTrackForm={}}).catch(function(t){e.$message.error("请重新提交"),e.editTrackForm={}})}).catch(function(){e.$message({type:"info",message:"已取消提交"})})})},changeDimension:function(e,t){var a=this;this.$confirm("此操作将数据列为重点故障，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:" "+c+"/tedsfault/changedimension",params:{id:e,dimension:t}}).then(function(e){a.$message.success("成功"),a.search()}).catch(function(e){a.$message.error("失败")})}).catch(function(){a.$message({type:"info",message:"已取消"})})},handleTrack:function(e){this.dialogTrackVisible=!0,this.id=e},handleClose:function(){this.editTrackForm={},this.dialogTrackVisible=!1}}},we={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-upload",{staticClass:"upload-demo",attrs:{action:e.baseURL+"/tedsfault/import","on-preview":e.handlePreview,"on-remove":e.handleRemove,"before-remove":e.beforeRemove,multiple:"","on-exceed":e.handleExceed,"on-success":e.handleSuccess,"on-error":e.handleError}},[a("el-button",{attrs:{size:"small",type:"warning",icon:"el-icon-star-on"}},[e._v("导入")])],1),e._v(" "),a("br"),a("br"),e._v(" "),a("el-form",{ref:"searchForm",staticClass:"user-search",attrs:{inline:!0,model:e.pageparm}},[a("el-form-item",{attrs:{label:"处理结果：",prop:"result"}},[a("el-select",{attrs:{placeholder:"请选择处理结果"},on:{change:e.changeResultSelect},model:{value:e.pageparm.result,callback:function(t){e.$set(e.pageparm,"result",t)},expression:"pageparm.result"}},[a("el-option",{attrs:{label:"全部",value:"全部"}}),e._v(" "),a("el-option",{attrs:{label:"未处理",value:"未处理"}}),e._v(" "),a("el-option",{attrs:{label:"已处理",value:"已处理"}}),e._v(" "),a("el-option",{attrs:{label:"长期跟踪",value:"长期跟踪"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"标注",prop:"dimension"}},[a("el-select",{attrs:{placeholder:"请选择"},on:{change:e.changeUpdate},model:{value:e.pageparm.dimension,callback:function(t){e.$set(e.pageparm,"dimension",t)},expression:"pageparm.dimension"}},[a("el-option",{attrs:{label:"非重点关注",value:"0"}}),e._v(" "),a("el-option",{attrs:{label:"重点关注",value:"1"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"车号",prop:"carNumber"}},[a("el-select",{attrs:{multiple:"",filterable:"",placeholder:"请选择车号"},model:{value:e.carNumbers,callback:function(t){e.carNumbers=t},expression:"carNumbers"}},e._l(e.carNumberList,function(e){return a("el-option",{key:e.value,attrs:{label:e.value,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"车厢号",prop:"carBodyNumber"}},[a("el-input",{attrs:{size:"small",placeholder:"输入车厢号"},model:{value:e.pageparm.carBodyNumber,callback:function(t){e.$set(e.pageparm,"carBodyNumber",t)},expression:"pageparm.carBodyNumber"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"交修日期"}},[a("el-col",{attrs:{span:11}},[a("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.timeList,callback:function(t){e.timeList=t},expression:"timeList"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"故障描述：",prop:"faultDescription"}},[a("el-input",{attrs:{size:"small",placeholder:"输入故障描述"},model:{value:e.pageparm.faultDescription,callback:function(t){e.$set(e.pageparm,"faultDescription",t)},expression:"pageparm.faultDescription"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"影响进度原因：",prop:"schedule"}},[a("el-input",{attrs:{size:"small",placeholder:"输入影响进度原因"},model:{value:e.pageparm.schedule,callback:function(t){e.$set(e.pageparm,"schedule",t)},expression:"pageparm.schedule"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"故障来源：",prop:"source"}},[a("el-input",{attrs:{size:"small",placeholder:"输入故障来源："},model:{value:e.pageparm.source,callback:function(t){e.$set(e.pageparm,"source",t)},expression:"pageparm.source"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"处理方法：",prop:"method"}},[a("el-input",{attrs:{size:"small",placeholder:"输入处理方法"},model:{value:e.pageparm.method,callback:function(t){e.$set(e.pageparm,"method",t)},expression:"pageparm.method"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"处理班组",prop:"teamsGroups"},on:{change:e.changeUpdate}},[a("el-select",{attrs:{placeholder:"请选择处理班组"},model:{value:e.pageparm.teamsGroups,callback:function(t){e.$set(e.pageparm,"teamsGroups",t)},expression:"pageparm.teamsGroups"}},e._l(e.teamsList,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.name}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"功能分类",prop:"funClass"}},[a("el-select",{attrs:{placeholder:"请选择功能分类"},on:{change:e.changeUpdate},model:{value:e.pageparm.funClass,callback:function(t){e.$set(e.pageparm,"funClass",t)},expression:"pageparm.funClass"}},[a("el-option",{attrs:{label:"整车",value:"整车"}}),e._v(" "),a("el-option",{attrs:{label:"车体",value:"车体"}}),e._v(" "),a("el-option",{attrs:{label:"车端连接",value:"车端连接"}}),e._v(" "),a("el-option",{attrs:{label:"转向架及其辅助",value:"转向架及其辅助"}}),e._v(" "),a("el-option",{attrs:{label:"主供电",value:"主供电"}}),e._v(" "),a("el-option",{attrs:{label:"牵引",value:"牵引"}}),e._v(" "),a("el-option",{attrs:{label:"辅助电气",value:"辅助电气"}}),e._v(" "),a("el-option",{attrs:{label:"供风制动",value:"供风制动"}}),e._v(" "),a("el-option",{attrs:{label:"网络及辅助监控",value:"网络及辅助监控"}}),e._v(" "),a("el-option",{attrs:{label:"旅客信息",value:"旅客信息"}}),e._v(" "),a("el-option",{attrs:{label:"空调",value:"空调"}}),e._v(" "),a("el-option",{attrs:{label:"给排水卫生",value:"给排水卫生"}}),e._v(" "),a("el-option",{attrs:{label:"外门及车内设施",value:"外门及车内设施"}}),e._v(" "),a("el-option",{attrs:{label:"驾驶设施",value:"驾驶设施"}}),e._v(" "),a("el-option",{attrs:{label:"电务车载",value:"电务车载"}}),e._v(" "),a("el-option",{attrs:{label:"其他",value:"其他"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"处置分类",prop:"handle"}},[a("el-select",{attrs:{placeholder:"请选择处理分类"},on:{change:e.changeUpdate},model:{value:e.pageparm.handle,callback:function(t){e.$set(e.pageparm,"handle",t)},expression:"pageparm.handle"}},[a("el-option",{attrs:{label:"已处理",value:"已处理"}}),e._v(" "),a("el-option",{attrs:{label:"待处理",value:"待处理"}}),e._v(" "),a("el-option",{attrs:{label:"待二级修",value:"待二级修"}}),e._v(" "),a("el-option",{attrs:{label:"待高级修",value:"待高级修"}}),e._v(" "),a("el-option",{attrs:{label:"待集中处理",value:"待集中处理"}}),e._v(" "),a("el-option",{attrs:{label:"待售后处理",value:"待售后处理"}}),e._v(" "),a("el-option",{attrs:{label:"待料",value:"待料"}}),e._v(" "),a("el-option",{attrs:{label:"跟踪观察",value:"跟踪观察"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"风险等级",prop:"risk"}},[a("el-select",{attrs:{placeholder:"请选择风险等级"},on:{change:e.changeUpdate},model:{value:e.pageparm.risk,callback:function(t){e.$set(e.pageparm,"risk",t)},expression:"pageparm.risk"}},[a("el-option",{attrs:{label:"无风险",value:0}}),e._v(" "),e._l(e.riskList,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}},[a("span",{staticStyle:{float:"left"}},[a("el-rate",{attrs:{max:t.value,disabled:""},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}})],1)])})],2)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-search"},on:{click:function(t){return e.search()}}},[e._v("搜索")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-refresh-right"},on:{click:function(t){return e.resetForm("searchForm")}}},[e._v("重置")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-plus"},on:{click:function(t){return e.handleEdit()}}},[e._v("添加")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"warning",icon:"el-icon-star-off"},on:{click:function(t){return e.exportExcel()}}},[e._v("导出")])],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"",height:"600","row-style":e.rowStyle}},[a("el-table-column",{attrs:{type:"index",label:"序号",align:"center",width:"70",index:e.indexMethod,fixed:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"deliveryDate",label:"交修日期",width:"100",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"carNumber",label:"车号",width:"70",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"carBodyNumber",label:"车厢号",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"faultDescription",label:"故障描述",width:"180",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"teamsGroups",label:"处理班组",width:"100",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"result",label:"处理结果",width:"180",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s("null"==t.row.result?"":t.row.result)+"\n            ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"method",label:"处理方法",width:"200",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s("null"==t.row.method?"":t.row.method)+"\n            ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"code",label:"物料编码",width:"100",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s("null"==t.row.code?"":t.row.code)+"\n            ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"schedule",label:"影响进度原因",width:"180",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s("null"==t.row.schedule?"":t.row.schedule)+"\n            ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"respDepart",label:"责任部门（待料）",width:"180",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s("null"==t.row.respDepart?"":t.row.respDepart)+"\n            ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"source",label:"故障来源",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s("null"==t.row.source?"":t.row.source)+"\n            ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"funClass",label:"功能分类",width:"130",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s("null"==t.row.funClass?"":t.row.funClass)+"\n            ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"risk",label:"风险等级",width:"140",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-rate",{attrs:{max:3,disabled:""},model:{value:t.row.risk,callback:function(a){e.$set(t.row,"risk",a)},expression:"scope.row.risk"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"handle",label:"处置分类",width:"150",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s("null"==t.row.handle?"":t.row.handle)+"\n            ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"notes",label:"备注",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s("null"==t.row.notes?"":t.row.notes)+"\n            ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"",label:"操作",width:"180",align:"center",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary",icon:"el-icon-edit",circle:""},on:{click:function(a){return e.handleEdit(t.$index,t.row)}}}),e._v(" "),a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(a){return e.deleteById(t.row)}}}),e._v(" "),a("el-button",{attrs:{type:"success",icon:"el-icon-top",circle:""},on:{click:function(a){return e.changState(t.row.id,t.row.state)}}}),e._v(" "),1==t.row.dimension?a("el-button",{attrs:{type:"warning",icon:"el-icon-warning",circle:""},on:{click:function(a){return e.changeDimension(t.row.id,0)}}}):a("el-button",{attrs:{icon:"el-icon-warning-outline",circle:""},on:{click:function(a){return e.changeDimension(t.row.id,1)}}})]}}])})],1),e._v(" "),a("Pagination",{attrs:{"child-msg":e.pageparm,total:e.total},on:{callFather:e.callFather}}),e._v(" "),a("el-dialog",{attrs:{title:e.title,visible:e.editFormVisible,width:"50%"},on:{"update:visible":function(t){e.editFormVisible=t},click:function(t){return e.closeDialog("editForm")}}},[a("el-form",{ref:"editForm",attrs:{"label-width":"120px",model:e.editForm,rules:e.rules}},[a("el-form-item",{attrs:{label:"交修日期",prop:"deliveryDate"}},[a("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",type:"date",placeholder:"选择日期"},model:{value:e.editForm.deliveryDate,callback:function(t){e.$set(e.editForm,"deliveryDate",t)},expression:"editForm.deliveryDate"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"车号",prop:"carNumber"}},[a("el-input",{attrs:{"auto-complete":"off",placeholder:"请输入车号"},model:{value:e.editForm.carNumber,callback:function(t){e.$set(e.editForm,"carNumber",t)},expression:"editForm.carNumber"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"车厢号",prop:"carBodyNumber"}},[a("el-input",{attrs:{min:1,label:"",placeholder:"请输入车箱号"},model:{value:e.editForm.carBodyNumber,callback:function(t){e.$set(e.editForm,"carBodyNumber",t)},expression:"editForm.carBodyNumber"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"故障描述",prop:"faultDescription"}},[a("el-input",{attrs:{type:"textarea",label:"",placeholder:"请输入故障描述"},model:{value:e.editForm.faultDescription,callback:function(t){e.$set(e.editForm,"faultDescription",t)},expression:"editForm.faultDescription"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"处理班组",prop:"teamsGroups"}},[a("el-select",{attrs:{placeholder:"请选择处理班组"},model:{value:e.editForm.teamsGroups,callback:function(t){e.$set(e.editForm,"teamsGroups",t)},expression:"editForm.teamsGroups"}},e._l(e.teamsList,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.name}})}),1),e._v(" "),a("el-link",{attrs:{type:"primary",href:"http://localhost:8080/#/teams/index",underline:!1}},[e._v("添加班组")])],1),e._v(" "),a("el-form-item",{attrs:{label:"处理结果",prop:"result"}},[a("label",{attrs:{slot:"label"},slot:"label"},[a("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v(" 处理结果")]),e._v(" "),a("el-radio-group",{on:{change:e.changeResult},model:{value:e.result,callback:function(t){e.result=t},expression:"result"}},[a("el-radio",{staticClass:"radio",attrs:{label:"未处理"}},[e._v("未处理")]),e._v(" "),a("el-radio",{staticClass:"radio",attrs:{label:"长期跟踪"}},[e._v("长期跟踪")]),e._v(" "),a("el-radio",{staticClass:"radio",attrs:{label:"已处理"}},[e._v("已处理(填写处理时间)")])],1),e._v(" "),"已处理"==e.result?a("el-input",{attrs:{label:"",placeholder:"请输入处理结果",size:"mini"},model:{value:e.editForm.result,callback:function(t){e.$set(e.editForm,"result",t)},expression:"editForm.result"}}):e._e()],1),e._v(" "),a("el-form-item",{attrs:{label:"处置分类",prop:"handle"}},[a("el-select",{attrs:{placeholder:"请选择处置分类"},model:{value:e.editForm.handle,callback:function(t){e.$set(e.editForm,"handle",t)},expression:"editForm.handle"}},[a("el-option",{attrs:{label:"已处理",value:"已处理"}}),e._v(" "),a("el-option",{attrs:{label:"待处理",value:"待处理"}}),e._v(" "),a("el-option",{attrs:{label:"待二级修",value:"待二级修"}}),e._v(" "),a("el-option",{attrs:{label:"待高级修",value:"待高级修"}}),e._v(" "),a("el-option",{attrs:{label:"待集中处理",value:"待集中处理"}}),e._v(" "),a("el-option",{attrs:{label:"待售后处理",value:"待售后处理"}}),e._v(" "),a("el-option",{attrs:{label:"待料",value:"待料"}}),e._v(" "),a("el-option",{attrs:{label:"跟踪观察",value:"跟踪观察"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"功能分类",prop:"funClass"}},[a("el-select",{attrs:{placeholder:"请选择功能分类"},model:{value:e.editForm.funClass,callback:function(t){e.$set(e.editForm,"funClass",t)},expression:"editForm.funClass"}},[a("el-option",{attrs:{label:"整车",value:"整车"}}),e._v(" "),a("el-option",{attrs:{label:"车体",value:"车体"}}),e._v(" "),a("el-option",{attrs:{label:"车端连接",value:"车端连接"}}),e._v(" "),a("el-option",{attrs:{label:"转向架及其辅助",value:"转向架及其辅助"}}),e._v(" "),a("el-option",{attrs:{label:"主供电",value:"主供电"}}),e._v(" "),a("el-option",{attrs:{label:"牵引",value:"牵引"}}),e._v(" "),a("el-option",{attrs:{label:"辅助电气",value:"辅助电气"}}),e._v(" "),a("el-option",{attrs:{label:"供风制动",value:"供风制动"}}),e._v(" "),a("el-option",{attrs:{label:"网络及辅助监控",value:"网络及辅助监控"}}),e._v(" "),a("el-option",{attrs:{label:"旅客信息",value:"旅客信息"}}),e._v(" "),a("el-option",{attrs:{label:"空调",value:"空调"}}),e._v(" "),a("el-option",{attrs:{label:"给排水卫生",value:"给排水卫生"}}),e._v(" "),a("el-option",{attrs:{label:"外门及车内设施",value:"外门及车内设施"}}),e._v(" "),a("el-option",{attrs:{label:"驾驶设施",value:"驾驶设施"}}),e._v(" "),a("el-option",{attrs:{label:"电务车载",value:"电务车载"}}),e._v(" "),a("el-option",{attrs:{label:"其他",value:"其他"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"处理方法",prop:"method"}},[a("el-input",{attrs:{type:"textarea",size:"small","auto-complete":"off",placeholder:"请输入遗留原因；处理方法；物料情况；跟踪周期。"},model:{value:e.editForm.method,callback:function(t){e.$set(e.editForm,"method",t)},expression:"editForm.method"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"物料编码",prop:"code"}},[a("el-input",{attrs:{size:"small","auto-complete":"off",placeholder:"请输入物料编码"},model:{value:e.editForm.code,callback:function(t){e.$set(e.editForm,"code",t)},expression:"editForm.code"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"影响进度原因",prop:"schedule"}},[a("el-input",{attrs:{size:"small","auto-complete":"off",placeholder:"请输入影响进度原因"},model:{value:e.editForm.schedule,callback:function(t){e.$set(e.editForm,"schedule",t)},expression:"editForm.schedule"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"责任部门（待料）",prop:"respDepart"}},[a("el-input",{attrs:{label:"",placeholder:"请输入责任部门（待料）"},model:{value:e.editForm.respDepart,callback:function(t){e.$set(e.editForm,"respDepart",t)},expression:"editForm.respDepart"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"故障来源",prop:"source"}},[a("el-input",{attrs:{label:"",placeholder:"请输入故障来源"},model:{value:e.editForm.source,callback:function(t){e.$set(e.editForm,"source",t)},expression:"editForm.source"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"风险等级",prop:"risk"}},[a("div",{staticClass:"rate_wrap"},[a("el-rate",{attrs:{max:3},model:{value:e.risk,callback:function(t){e.risk=t},expression:"risk"}}),e._v(" "),a("el-button",{attrs:{size:"mini",icon:"el-icon-refresh-right",circle:""},on:{click:e.resetRisk}})],1)]),e._v(" "),a("el-form-item",{attrs:{label:"备注",prop:"node"}},[a("el-input",{attrs:{size:"small","auto-complete":"off",placeholder:"备注"},model:{value:e.editForm.notes,callback:function(t){e.$set(e.editForm,"notes",t)},expression:"editForm.notes"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){return e.closeDialog("editForm")}}},[e._v("取消")]),e._v(" "),a("el-button",{staticClass:"title",attrs:{size:"small",type:"primary"},on:{click:function(t){return e.handelFault("editForm")}}},[e._v("保存")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"移交追踪列表",visible:e.dialogTrackVisible,width:"45%","before-close":e.handleClose},on:{"update:visible":function(t){e.dialogTrackVisible=t}}},[a("el-form",{ref:"editTrackForm",attrs:{"label-width":"120px",model:e.editTrackForm,rules:e.trackRules}},[a("el-form-item",{attrs:{label:"责任人",prop:"trackPerson"}},[a("el-input",{attrs:{"auto-complete":"off",placeholder:"请输入责任人"},model:{value:e.editTrackForm.trackPerson,callback:function(t){e.$set(e.editTrackForm,"trackPerson",t)},expression:"editTrackForm.trackPerson"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"追踪要求",prop:"trackRequire"}},[a("el-input",{attrs:{type:"textarea","auto-complete":"off",placeholder:"请输入追踪要求"},model:{value:e.editTrackForm.trackRequire,callback:function(t){e.$set(e.editTrackForm,"trackRequire",t)},expression:"editTrackForm.trackRequire"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"反馈实现",prop:"feedback"}},[a("el-input",{attrs:{type:"textarea","auto-complete":"off",placeholder:"请输入反馈实现"},model:{value:e.editTrackForm.feedback,callback:function(t){e.$set(e.editTrackForm,"feedback",t)},expression:"editTrackForm.feedback"}})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogTrackVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.changeTrack}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var ke=a("VU/8")(Fe,we,!1,function(e){a("ac32")},"data-v-d1abe95a",null).exports,xe={name:"Fault",components:{Pagination:T},data:function(){return{carNumbers:[],carNumberList:S,baseURL:c,timeList:[],tableData:[],editFormVisible:!1,title:"编辑",editForm:{risk:0,state:1},risk:0,result:"",rules:{deliveryDate:[{required:!0,message:"请输入日期",trigger:"blur"}],carNumber:[{required:!0,message:"请输入车号",trigger:"blur"}],carBodyNumber:[{required:!0,message:"请输入车厢号",trigger:"blur"}],faultDescription:[{required:!0,message:"请输入故障描述",trigger:"blur"}],teamsGroups:[{required:!0,message:"请选择班组",trigger:"blur"}],funClass:[{required:!0,message:"请选择功能分类",trigger:"blur"}],handle:[{required:!0,message:"请选择处置分类",trigger:"blur"}]},pageparm:{pageNo:1,pageSize:50,state:1},total:0,allList:[],headers:"'Content-Type': 'multipart/form-data'",loading:!0,teamsList:[]}},created:function(){this.getFault(),this.getTeams()},computed:{indexMethod:function(){return(this.pageparm.pageNo-1)*this.pageparm.pageSize+1}},methods:{resetForm:function(e){this.$refs[e].resetFields(),this.timeList=[],delete this.pageparm.startTime,delete this.pageparm.endTime,this.pageparm.carNumbers&&delete this.pageparm.carNumbers,this.carNumbers=[]},getTeams:function(){var e=this;Object(s.a)({url:c+"/teams/selectall"}).then(function(t){e.teamsList=t.data.data,e.loading=!1}).catch(function(e){console.log(e)})},search:function(){var e=this;this.carNumbers.length&&(this.pageparm.carNumbers=this.carNumbers),this.loading=!0,this.timeList.length&&(this.pageparm.startTime=this.getYMDHMS(new Date(this.timeList[0].toString())),this.pageparm.endTime=this.getYMDHMS(new Date(this.timeList[1].toString()))),this.pageparm.state=1,this.pageparm.pageNo=1,this.pageparm.pageSize=50,Object(s.a)({method:"post",url:c+"/tedsfault/screenfault",data:this.pageparm}).then(function(t){e.$message.success("搜索成功"),e.tableData=t.data.data.list,e.tableData=e.tableData.map(function(t){return t.deliveryDate=e.getYMDHMS(t.deliveryDate),t.risk=(t.risk,0),t.code="null"==t.code?"":t.code,t.schedule="null"==t.schedule?"":t.schedule,t.respDepart="null"==t.respDepart?"":t.respDepart,t.notes="null"==t.notes?"":t.notes,t}),e.total=t.data.data.size,e.loading=!1}).catch(function(t){e.initPage(),e.getFault(),e.$message.error("搜索失败"),console.log(t)})},initPage:function(){this.pageparm={pageNo:1,pageSize:50}},getYMDHMS:function(e){var t=new Date(e);return t.getFullYear()+"-"+(t.getMonth()+1).toString().padStart(2,"0")+"-"+t.getDate().toString().padStart(2,"0")},exportExcel:function(){this.carNumbers.length&&(this.pageparm.carNumbers=this.carNumbers),this.timeList.length&&(this.pageparm.startTime=this.getYMDHMS(new Date(this.timeList[0].toString())),this.pageparm.endTime=this.getYMDHMS(new Date(this.timeList[1].toString())));var e=c+"/tedsfault/exportsenior?";for(var t in this.pageparm)this.pageparm[t]&&(e+=t+"="+this.pageparm[t]+"&");console.log(e),s.a.get(e).then(function(t){console.log(e),window.location.href=e})},callFather:function(e){this.pageparm.pageNo=e.pageNo,this.pageparm.pageSize=e.pageSize,this.getFault()},getFault:function(){var e=this;this.carNumbers.length&&(this.pageparm.carNumbers=this.carNumbers),this.pageparm.state=1,Object(s.a)({url:c+"/tedsfault/screenfault",method:"post",data:this.pageparm}).then(function(t){e.tableData=t.data.data.list,e.tableData=e.tableData.map(function(t){return t.deliveryDate=e.getYMDHMS(t.deliveryDate),t.risk=(t.risk,0),t.code="null"==t.code?"":t.code,t.schedule="null"==t.schedule?"":t.schedule,t.respDepart="null"==t.respDepart?"":t.respDepart,t.notes="null"==t.notes?"":t.notes,t}),e.total=t.data.data.size,e.loading=!1}).catch(function(e){console.log(e)})},deleteById:function(e){var t=this;this.$confirm("此操作将永久删除, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:c+"/tedsfault/deletefaultid",params:{id:e.id}}).then(function(e){t.$message({message:"删除成功",type:"success"}),t.getFault()}).catch(function(e){console.log(e)})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},handleEdit:function(e,t){this.editFormVisible=!0,void 0!=t&&"undefined"!=t?(this.title="修改",this.editForm=t,"未处理"!=this.editForm.result&"长期跟踪"!=this.editForm.result?this.result="已处理":"未处理"==this.editForm.result?this.result="未处理":"长期跟踪"==this.editForm.result&&(this.result="长期跟踪")):(this.title="添加",this.editForm={state:1})},changeResult:function(){this.editForm.result=""},handelFault:function(){var e=this;this.$refs.editForm.validate(function(t){if(!t)return console.log("提交失败"),!1;if("已处理"!=e.result&&(e.editForm.result=e.result),e.editForm.risk=e.risk,"添加"==e.title)Object(s.a)({url:c+"/tedsfault/insertfault",method:"post",data:e.editForm}).then(function(t){e.$message({message:e.title+"成功",type:"success"}),e.editFormVisible=!1,e.editForm={},e.initPage(),e.getFault()}).catch(function(t){console.log(t),e.$message({message:e.title+"失败",type:"error"}),e.editFormVisible=!1,e.editForm={},e.initPage(),e.getFault()});else{for(var a in e.editForm)!e.editForm[a]&"risk"!=a&&(e.editForm[a]="null");Object(s.a)({url:c+"/tedsfault/updatefaultid",method:"post",data:e.editForm}).then(function(t){e.editFormVisible=!1,e.editForm={}}).catch(function(e){console.log(e)})}})},closeDialog:function(){this.editFormVisible=!1,this.editForm={},this.initPage(),this.getFault()},handleUploadSuccess:function(e){this.uploadUrlPath=N()(e),this.loading.close()},handleBeforeUpload:function(){this.loading=this.$loading({lock:!0,text:"上传中",background:"rgba(0, 0, 0, 0.7)"})},handleUploadError:function(){this.$message({type:"error",message:"上传失败"}),this.loading.close()},handleRemove:function(e,t){console.log(e,t)},handlePreview:function(e){console.log(e)},handleExceed:function(e,t){this.$message.warning("当前限制选择文件个数，本次选择了 "+e.length+" 个文件，共选择了 "+(e.length+t.length)+" 个文件")},beforeRemove:function(e,t){return this.$confirm("确定移除 "+e.name+"？")},handleSuccess:function(){this.getFault(),this.$message.success("导入成功")},handleError:function(){this.getFault(),this.$message.error("导入格式错误，请修改后重新导入！")},resetRisk:function(){this.risk=0},changState:function(e,t){var a=this;this.$confirm("此操作将数据提交到故障遗留列表, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:" "+c+"/tedsfault/changestate",params:{id:e,state:0}}).then(function(e){a.$message.success("已转移到故障遗留库"),a.search()}).catch(function(e){a.$message.error("重新提交")})}).catch(function(){a.$message({type:"info",message:"已取消提交"})})}}},$e={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{ref:"searchForm",staticClass:"user-search",attrs:{inline:!0,model:e.pageparm}},[a("el-form-item",{attrs:{label:"处理结果：",prop:"result"}},[a("el-select",{attrs:{placeholder:"请选择处理结果"},model:{value:e.pageparm.result,callback:function(t){e.$set(e.pageparm,"result",t)},expression:"pageparm.result"}},[a("el-option",{attrs:{label:"未处理",value:"未处理"}}),e._v(" "),a("el-option",{attrs:{label:"已处理",value:"已处理"}}),e._v(" "),a("el-option",{attrs:{label:"长期跟踪",value:"长期跟踪"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"交修日期"}},[a("el-col",{attrs:{span:11}},[a("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.timeList,callback:function(t){e.timeList=t},expression:"timeList"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"车号",prop:"carNumber"}},[a("el-select",{attrs:{multiple:"",filterable:"",placeholder:"请选择车号"},model:{value:e.carNumbers,callback:function(t){e.carNumbers=t},expression:"carNumbers"}},e._l(e.carNumberList,function(e){return a("el-option",{key:e.value,attrs:{label:e.value,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"车箱号",prop:"carBodyNumber"}},[a("el-input",{attrs:{size:"small",placeholder:"输入车厢号"},model:{value:e.pageparm.carBodyNumber,callback:function(t){e.$set(e.pageparm,"carBodyNumber",t)},expression:"pageparm.carBodyNumber"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"故障描述：",prop:"faultDescription"}},[a("el-input",{attrs:{size:"small",placeholder:"输入故障描述"},model:{value:e.pageparm.faultDescription,callback:function(t){e.$set(e.pageparm,"faultDescription",t)},expression:"pageparm.faultDescription"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"故障来源：",prop:"source"}},[a("el-input",{attrs:{size:"small",placeholder:"输入故障来源："},model:{value:e.pageparm.source,callback:function(t){e.$set(e.pageparm,"source",t)},expression:"pageparm.source"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"处理方法：",prop:"method"}},[a("el-input",{attrs:{size:"small",placeholder:"输入处理方法"},model:{value:e.pageparm.method,callback:function(t){e.$set(e.pageparm,"method",t)},expression:"pageparm.method"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"处理班组",prop:"teamsGroups"}},[a("el-select",{attrs:{placeholder:"请选择处理班组"},model:{value:e.pageparm.teamsGroups,callback:function(t){e.$set(e.pageparm,"teamsGroups",t)},expression:"pageparm.teamsGroups"}},e._l(e.teamsList,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.name}})}),1)],1),e._v(" "),a("br"),e._v(" "),a("el-form-item",[a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-search"},on:{click:function(t){return e.search()}}},[e._v("搜索")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-refresh-right"},on:{click:function(t){return e.resetForm("searchForm")}}},[e._v("重置")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-plus"},on:{click:function(t){return e.handleEdit()}}},[e._v("添加")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"warning",icon:"el-icon-star-off"},on:{click:function(t){return e.exportExcel()}}},[e._v("导出")])],1)],1),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"",height:"600"}},[a("el-table-column",{attrs:{type:"index",label:"序号",align:"center",width:"130",index:e.indexMethod,fixed:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"deliveryDate",label:"交修日期",width:"180",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"carNumber",label:"车号",width:"180",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"carBodyNumber",label:"车厢号",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"faultDescription",label:"故障描述",width:"180",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"teamsGroups",label:"处理班组",width:"180",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"result",label:"处理结果",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"method",label:"处理方法",width:"180",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"source",label:"故障来源",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s("null"==t.row.source?"":t.row.source)+"\n            ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"notes",label:"车组预计送修时间",align:"center",width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s("null"==t.row.notes?"":t.row.notes)+"\n            ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"",label:"操作",width:"180",align:"center",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary",icon:"el-icon-edit",circle:""},on:{click:function(a){return e.handleEdit(t.$index,t.row)}}}),e._v(" "),a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(a){return e.deleteById(t.row)}}}),e._v(" "),a("el-button",{attrs:{type:"success",icon:"el-icon-bottom",circle:""},on:{click:function(a){return e.changState(t.row.id,t.row.state)}}})]}}])})],1),e._v(" "),a("Pagination",{attrs:{"child-msg":e.pageparm,total:e.total},on:{callFather:e.callFather}}),e._v(" "),a("el-dialog",{attrs:{title:e.title,visible:e.editFormVisible,width:"55%"},on:{"update:visible":function(t){e.editFormVisible=t},click:function(t){return e.closeDialog("editForm")}}},[a("el-form",{ref:"editForm",attrs:{"label-width":"120px",model:e.editForm,rules:e.rules}},[a("el-form-item",{attrs:{label:"交修日期",prop:"deliveryDate"}},[a("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",type:"date",placeholder:"选择日期"},model:{value:e.editForm.deliveryDate,callback:function(t){e.$set(e.editForm,"deliveryDate",t)},expression:"editForm.deliveryDate"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"车号",prop:"carNumber"}},[a("el-input",{attrs:{"auto-complete":"off",placeholder:"请输入车号"},model:{value:e.editForm.carNumber,callback:function(t){e.$set(e.editForm,"carNumber",t)},expression:"editForm.carNumber"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"车厢号",prop:"carBodyNumber"}},[a("el-input",{attrs:{min:1,label:"",placeholder:"请输入车箱号"},model:{value:e.editForm.carBodyNumber,callback:function(t){e.$set(e.editForm,"carBodyNumber",t)},expression:"editForm.carBodyNumber"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"故障描述",prop:"faultDescription"}},[a("el-input",{attrs:{type:"textarea",label:"",placeholder:"请输入故障描述"},model:{value:e.editForm.faultDescription,callback:function(t){e.$set(e.editForm,"faultDescription",t)},expression:"editForm.faultDescription"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"处理班组",prop:"teamsGroups"}},[a("el-select",{attrs:{placeholder:"请选择处理班组"},model:{value:e.editForm.teamsGroups,callback:function(t){e.$set(e.editForm,"teamsGroups",t)},expression:"editForm.teamsGroups"}},e._l(e.teamsList,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.name}})}),1),e._v(" "),a("el-link",{attrs:{type:"primary",href:"http://localhost:8080/#/teams/index",underline:!1}},[e._v("添加班组")])],1),e._v(" "),a("el-form-item",{attrs:{label:"处理结果",prop:"result"}},[a("label",{attrs:{slot:"label"},slot:"label"},[a("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v(" 处理结果")]),e._v(" "),a("el-radio-group",{on:{change:e.changeResult},model:{value:e.result,callback:function(t){e.result=t},expression:"result"}},[a("el-radio",{staticClass:"radio",attrs:{label:"未处理"}},[e._v("未处理")]),e._v(" "),a("el-radio",{staticClass:"radio",attrs:{label:"长期跟踪"}},[e._v("长期跟踪")]),e._v(" "),a("el-radio",{staticClass:"radio",attrs:{label:"已处理"}},[e._v("已处理(填写处理时间)")])],1),e._v(" "),"已处理"==e.result?a("el-input",{attrs:{label:"",placeholder:"请输入处理结果",size:"mini"},model:{value:e.editForm.result,callback:function(t){e.$set(e.editForm,"result",t)},expression:"editForm.result"}}):e._e()],1),e._v(" "),a("el-form-item",{attrs:{label:"处理方法",prop:"method"}},[a("el-input",{attrs:{type:"textarea",size:"small","auto-complete":"off",placeholder:"请输入处理结果"},model:{value:e.editForm.method,callback:function(t){e.$set(e.editForm,"method",t)},expression:"editForm.method"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"故障来源",prop:"respDepart"}},[a("el-input",{attrs:{label:"",placeholder:"请输入故障来源"},model:{value:e.editForm.source,callback:function(t){e.$set(e.editForm,"source",t)},expression:"editForm.source"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"车组预计送修时间",prop:"node"}},[a("el-input",{attrs:{size:"small","auto-complete":"off",placeholder:"车组预计送修时间"},model:{value:e.editForm.notes,callback:function(t){e.$set(e.editForm,"notes",t)},expression:"editForm.notes"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){return e.closeDialog("editForm")}}},[e._v("取消")]),e._v(" "),a("el-button",{staticClass:"title",attrs:{size:"small",type:"primary"},on:{click:function(t){return e.handelFault("editForm")}}},[e._v("保存")])],1)],1)],1)},staticRenderFns:[]};var Ce=a("VU/8")(xe,$e,!1,function(e){a("55QM")},"data-v-217d3e82",null).exports,Te={name:"Fault",data:function(){return{carNumbers:[],carNumberList:S,baseURL:c,timeList:[],tableData:[],editFormVisible:!1,dialogTrackVisible:!1,title:"编辑",editForm:{code:"无",schedule:"无",respDepart:"无"},editTrackForm:{},risk:0,result:"",rules:{deliveryDate:[{required:!0,message:"请输入日期",trigger:"blur"}],specialName:[{required:!0,message:"请输入专项名称",trigger:"blur"}]},pageparm:{pageNo:1,pageSize:1e5},total:0,allList:[],headers:"'Content-Type': 'multipart/form-data'",loading:!1,teamsList:[],riskList:[{label:"一星",value:1},{label:"二星",value:2},{label:"三星",value:3}],id:0}},created:function(){this.search()},computed:{indexMethod:function(){return(this.pageparm.pageNo-1)*this.pageparm.pageSize+1}},methods:{rowStyle:function(e){var t=e.row,a=Date.parse(t.deliveryDate),l=Date.now();if(console.log(a,l),a<=l)return{background:"antiquewhite"}},changeUpdate:function(){this.$forceUpdate()},changeResultSelect:function(){"全部"==this.pageparm.result&&delete this.pageparm.result},resetForm:function(e){this.$refs[e].resetFields(),this.timeList=[],delete this.pageparm.startTime,delete this.pageparm.endTime,this.pageparm.carNumbers&&delete this.pageparm.carNumbers,this.carNumbers=[]},search:function(){var e=this;this.loading=!0,this.timeList.length&&(this.pageparm.startTime=this.getYMDHMS(new Date(this.timeList[0].toString())),this.pageparm.endTime=this.getYMDHMS(new Date(this.timeList[1].toString()))),this.pageparm.pageNo=1,this.pageparm.pageSize=1e5,Object(s.a)({method:"post",url:c+"/special/screenall",data:this.pageparm}).then(function(t){e.tableData=t.data.data,e.tableData=e.tableData.map(function(t){return t.deliveryDate=e.getYMDHMS(t.deliveryDate),t}),e.loading=!1,e.$message.success("搜索成功")}).catch(function(t){e.initPage(),e.$message.error("搜索失败")})},initPage:function(){this.pageparm={pageNo:1,pageSize:1e5,state:0}},getYMDHMS:function(e){var t=new Date(e);return t.getFullYear()+"-"+(t.getMonth()+1).toString().padStart(2,"0")+"-"+t.getDate().toString().padStart(2,"0")},exportExcel:function(){"全部"==this.pageparm.result&&delete this.pageparm.result,this.carNumbers.length&&(this.pageparm.carNumbers=this.carNumbers),this.timeList.length&&(this.pageparm.startTime=this.getYMDHMS(new Date(this.timeList[0].toString())),this.pageparm.endTime=this.getYMDHMS(new Date(this.timeList[1].toString())));var e=c+"/fault/export?";for(var t in this.pageparm)this.pageparm[t]&&(e+=t+"="+this.pageparm[t]+"&");console.log(e),s.a.get(e).then(function(t){console.log(e),window.location.href=e})},getFault:function(){var e=this;this.carNumbers.length&&(this.pageparm.carNumbers=this.carNumbers),Object(s.a)({url:c+"/fault/screenfault",method:"post",data:this.pageparm}).then(function(t){e.tableData=t.data.data.list||[],e.tableData=e.tableData.map(function(t){return t.deliveryDate=e.getYMDHMS(t.deliveryDate),t.risk="0"==t.risk?parseInt(0):parseInt(t.risk),t.code="null"==t.code?"":t.code,t.schedule="null"==t.schedule?"":t.schedule,t.respDepart="null"==t.respDepart?"":t.respDepart,t.notes="null"==t.notes?"":t.notes,t}),e.total=t.data.data.size,e.loading=!1}).catch(function(e){console.log(e)})},deleteById:function(e){var t=this;console.log(e),this.$confirm("此操作将永久删除, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:c+"/special/deletespecialid",params:{id:e.id}}).then(function(e){t.$message({message:"删除成功",type:"success"}),t.search()}).catch(function(e){console.log(e)})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},handleEdit:function(e,t){this.editFormVisible=!0,void 0!=t&&"undefined"!=t?(this.title="修改",this.editForm=t):(this.title="添加",this.result="")},changeResult:function(){this.editForm.result=""},handelFault:function(){var e=this;this.$refs.editForm.validate(function(t){if(!t)return console.log("提交失败"),!1;"添加"==e.title?Object(s.a)({url:c+"/special/insertspecial",method:"post",data:e.editForm}).then(function(t){e.$message({message:e.title+"成功",type:"success"}),e.editFormVisible=!1,e.editForm={},e.search()}).catch(function(t){console.log(t),e.$message({message:e.title+"失败",type:"error"}),e.editFormVisible=!1,e.editForm={},e.initPage(),e.search()}):Object(s.a)({url:c+"/special/updatespecial",method:"post",data:e.editForm}).then(function(t){e.editFormVisible=!1,e.editForm={},e.$message.success("修改成功")}).catch(function(t){console.log(t),e.$message.error("请重新提交")})})},closeDialog:function(){this.editFormVisible=!1,this.editForm={},this.risk=0,this.initPage()},handleUploadSuccess:function(e){this.uploadUrlPath=N()(e),this.loading.close()},handleBeforeUpload:function(){this.loading=this.$loading({lock:!0,text:"上传中",background:"rgba(0, 0, 0, 0.7)"})},handleUploadError:function(){this.$message({type:"error",message:"上传失败"}),this.loading.close()},handleRemove:function(e,t){console.log(e,t)},handlePreview:function(e){console.log(e)},handleExceed:function(e,t){this.$message.warning("当前限制选择文件个数，本次选择了 "+e.length+" 个文件，共选择了 "+(e.length+t.length)+" 个文件")},beforeRemove:function(e,t){return this.$confirm("确定移除 "+e.name+"？")},handleSuccess:function(){this.$message.success("导入成功")},handleError:function(){this.$message.error("导入格式错误，请修改后重新导入！")},resetRisk:function(){this.risk=0},changState:function(e,t){var a=this;this.$confirm("此操作将数据提交到高级修库, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:" "+c+"/fault/changestate",params:{id:e,state:1}}).then(function(e){a.$message.success("已转移到高级修库"),a.search()}).catch(function(e){a.$message.error("重新提交")})}).catch(function(){a.$message({type:"info",message:"已取消提交"})})},changeTrack:function(){var e=this;this.$refs.editTrackForm.validate(function(t){if(!t)return console.log("请输入责任人"),!1;e.$confirm("此操作将数据提交到故障追踪列表, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:" "+c+"/fault/changestate",params:{id:e.id,state:2,trackPerson:e.editTrackForm.trackPerson,trackRequire:e.editTrackForm.trackRequire,feedback:e.editTrackForm.feedback}}).then(function(t){e.$message.success("已转移到故障追踪列表"),e.search(),e.dialogTrackVisible=!1,e.editTrackForm={}}).catch(function(t){e.$message.error("请重新提交"),e.editTrackForm={}})}).catch(function(){e.$message({type:"info",message:"已取消提交"})})})},changeDimension:function(e,t){var a=this;this.$confirm("此操作将数据列为重点故障，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:" "+c+"/fault/changedimension",params:{id:e,dimension:t}}).then(function(e){a.$message.success("成功"),a.search()}).catch(function(e){a.$message.error("失败")})}).catch(function(){a.$message({type:"info",message:"已取消"})})},handleTrack:function(e){this.dialogTrackVisible=!0,this.id=e},handleClose:function(){this.editTrackForm={},this.dialogTrackVisible=!1},handleMethod:function(){"修改"==this.title&&(this.editForm.handle="")}}},Se={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-upload",{staticClass:"upload-demo",attrs:{action:e.baseURL+"/fault/import","on-preview":e.handlePreview,"on-remove":e.handleRemove,"before-remove":e.beforeRemove,multiple:"","on-exceed":e.handleExceed,"on-success":e.handleSuccess,"on-error":e.handleError}},[a("el-button",{attrs:{size:"small",type:"warning",icon:"el-icon-star-on"}},[e._v("导入")])],1),e._v(" "),a("br"),a("br"),e._v(" "),a("el-form",{ref:"searchForm",staticClass:"user-search",attrs:{inline:!0,model:e.pageparm}},[a("el-form-item",{attrs:{label:"专项名称",prop:"specialName"}},[a("el-input",{attrs:{size:"small",placeholder:"输入专项名称"},model:{value:e.pageparm.specialName,callback:function(t){e.$set(e.pageparm,"specialName",t)},expression:"pageparm.specialName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"到期日期"}},[a("el-col",{attrs:{span:11}},[a("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"到期日期"},model:{value:e.timeList,callback:function(t){e.timeList=t},expression:"timeList"}})],1)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-search"},on:{click:function(t){return e.search()}}},[e._v("搜索")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-refresh-right"},on:{click:function(t){return e.resetForm("searchForm")}}},[e._v("重置")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-plus"},on:{click:function(t){return e.handleEdit()}}},[e._v("添加")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"warning",icon:"el-icon-star-off"},on:{click:function(t){return e.exportExcel()}}},[e._v("导出")])],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"abc",staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"",height:"600","row-style":e.rowStyle}},[a("el-table-column",{attrs:{type:"index",label:"序号",align:"center",width:"70",index:e.indexMethod,fixed:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"specialName",label:"专项名称",width:"300",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"deliveryDate",label:"交修日期",width:"200",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"notes",label:"备注",width:"200",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"",label:"操作",width:"180",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary",icon:"el-icon-edit",circle:""},on:{click:function(a){return e.handleEdit(t.$index,t.row)}}}),e._v(" "),a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(a){return e.deleteById(t.row)}}})]}}])})],1),e._v(" "),a("el-dialog",{attrs:{title:e.title,visible:e.editFormVisible,width:"50%","show-close":!1,"close-on-click-modal":!1},on:{"update:visible":function(t){e.editFormVisible=t}}},[a("el-form",{ref:"editForm",attrs:{"label-width":"120px",model:e.editForm,rules:e.rules}},[a("el-form-item",{attrs:{label:"专项名称",prop:"specialName"}},[a("el-input",{attrs:{"auto-complete":"off",placeholder:"请输入专项名称"},model:{value:e.editForm.specialName,callback:function(t){e.$set(e.editForm,"specialName",t)},expression:"editForm.specialName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"交修日期",prop:"deliveryDate"}},[a("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",type:"date",placeholder:"选择日期"},model:{value:e.editForm.deliveryDate,callback:function(t){e.$set(e.editForm,"deliveryDate",t)},expression:"editForm.deliveryDate"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"备注",prop:"node"}},[a("el-input",{attrs:{size:"small","auto-complete":"off",placeholder:"备注"},model:{value:e.editForm.notes,callback:function(t){e.$set(e.editForm,"notes",t)},expression:"editForm.notes"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){return e.closeDialog("editForm")}}},[e._v("取消")]),e._v(" "),a("el-button",{staticClass:"title",attrs:{size:"small",type:"primary"},on:{click:function(t){return e.handelFault("editForm")}}},[e._v("保存")])],1)],1)],1)},staticRenderFns:[]};var De=a("VU/8")(Te,Se,!1,function(e){a("hAkL")},"data-v-079309a0",null).exports,Ve=[{label:2217,value:2217},{label:2249,value:2249},{label:2250,value:2250},{label:2251,value:2251},{label:2256,value:2256},{label:2294,value:2294},{label:2295,value:2295},{label:2308,value:2308},{label:2309,value:2309},{label:2310,value:2310},{label:2311,value:2311},{label:2316,value:2316},{label:2317,value:2317},{label:2318,value:2318},{label:2319,value:2319},{label:4122,value:4122},{label:4123,value:4123},{label:4124,value:4124},{label:4125,value:4125},{label:4126,value:4126},{label:4127,value:4127},{label:4128,value:4128},{label:4129,value:4129},{label:4130,value:4130},{label:4131,value:4131},{label:2641,value:2641},{label:2642,value:2642},{label:2648,value:2648},{label:2654,value:2654},{label:2663,value:2663},{label:2664,value:2664},{label:2668,value:2668},{label:2669,value:2669},{label:2674,value:2674},{label:2675,value:2675},{label:2676,value:2676},{label:2677,value:2677},{label:2678,value:2678},{label:2679,value:2679},{label:2681,value:2681},{label:2689,value:2689},{label:2690,value:2690},{label:2721,value:2721},{label:2782,value:2782},{label:2798,value:2798},{label:2800,value:2800},{label:2814,value:2814},{label:2841,value:2841},{label:2845,value:2845},{label:2846,value:2846},{label:2847,value:2847},{label:2848,value:2848},{label:2861,value:2861},{label:2867,value:2867},{label:2879,value:2879},{label:2904,value:2904},{label:2908,value:2908},{label:2921,value:2921},{label:2922,value:2922},{label:2923,value:2923},{label:2924,value:2924},{label:2925,value:2925},{label:2931,value:2931},{label:2932,value:2932},{label:2933,value:2933},{label:2934,value:2934},{label:2935,value:2935}],Le=[2641,2642,2648,2654,2663,2664,2668,2668,2669,2669,2674,2675,2676,2676,2677,2677,2678,2679,2681,2689,2689,2690,2690,2721,2782,2798,2800,2800,2814,2814,2841,2845,2846,2846,2847,2847,2848,2861,2867,2867,2879,2904,2904,2908,2921,2922,2922,2923,2923,2924,2925,2931,2931,2932,2932,2933,2934,2935,2935],Be=[2217,2249,2250,2251,2256,2294,2295,2308,2309,2310,2311,2316,2317,2318,2319,4122,4123,4124,4125,4126,4127,4128,4129,4130,4131],Ie={name:"qualitySquare",data:function(){var e;return e={baseURL:c,carNumberList:S,classCarNumbers:R,squareCarNumberList:Ve,twoCarNumberList:Be,eightCarNumberList:Le,selectSquareCarNumberList:[],sid:0,carNumbers:[],tableData:[],loading:!1,pageparm:{type:1,pageNo:1,pageSize:1e5},pageparmcar:{},editFormVisible:!1,title:"编辑",editForm:{},total:0},x()(e,"loading",!1),x()(e,"carNumbersVisible",!1),x()(e,"props",{multiple:!0}),x()(e,"selectedCarNumbers",[]),x()(e,"inputVisible",!1),x()(e,"inputValue",""),x()(e,"carNumberComplTimeVisible",!1),x()(e,"carNumberComplForm",{}),x()(e,"carNumbersBySid",[]),x()(e,"carNumbersInfoVisible",!1),x()(e,"carNumbersInfoData",[]),x()(e,"ComplTimeVisible",!0),x()(e,"deleteCarNumbersInfoVisible",!1),x()(e,"selectLongCarNumberList",[]),x()(e,"updateTotal",0),x()(e,"updateIncompl",0),x()(e,"updateCompl",0),x()(e,"updateIncomplTwo",0),x()(e,"updateIncomplEight",0),x()(e,"updateComplTwo",0),x()(e,"updateComplEight",0),x()(e,"span",[]),x()(e,"index",null),x()(e,"uploadModalVisible",!1),x()(e,"fileList",[]),x()(e,"dialogVisible",!1),x()(e,"attachmentList",[]),x()(e,"previewDialogVisible",!1),x()(e,"previewFile",""),x()(e,"source",{}),x()(e,"deleteParams",{}),e},computed:{indexMethod:function(){return(this.pageparm.pageNo-1)*this.pageparm.pageSize+1}},created:function(){this.getQS()},methods:{changeInput:function(e){this.$forceUpdate()},rowStyle:function(e){if(1==e.row.dimension)return{background:"antiquewhite"}},search:function(){var e=this;this.carNumbers.length&&(this.pageparm.carNumbers=this.carNumbers),this.loading=!0,Object(s.a)({method:"post",url:c+"/source/selectallsourceinfo",data:this.pageparm}).then(function(t){var a=t.data.data;a=a.map(function(t){return t.sourceCarNumberDto.sort(e.compare("carNumber")),t}),e.tableData=a,e.loading=!1,e.$message.success("搜索成功")}).catch(function(t){e.initPage(),e.$message.error("搜索失败"),console.log(t)})},resetForm:function(e){this.$refs[e].resetFields(),this.carNumbers=[],this.pageparm.carNumbers&&delete this.pageparm.carNumbers},initPage:function(){this.pageparm={pageNo:1,pageSize:1e5,type:1}},getQS:function(){var e=this;Object(s.a)({url:c+"/source/selectallsourceinfo",method:"post",data:this.pageparm}).then(function(t){var a=t.data.data;a=a.map(function(t){return t.sourceCarNumberDto.sort(e.compare("carNumber")),t}),e.tableData=a,e.loading=!1}).catch(function(e){console.log(e)})},compare:function(e){return function(t,a){return t[e]-a[e]}},handleEdit:function(e,t){this.editFormVisible=!0,void 0!=t&&"undefined"!=t?(this.title="修改",this.editForm=t):(this.title="添加",this.editForm={})},changeResult:function(){this.editForm.result=""},handelSource:function(){var e=this;this.$refs.editForm.validate(function(t){if(!t)return console.log("提交失败"),!1;"添加"==e.title?Object(s.a)({url:c+"/source/insertsource",method:"post",data:e.editForm}).then(function(t){e.$message({message:e.title+"成功",type:"success"}),e.editFormVisible=!1,e.editForm={},e.getQS()}).catch(function(t){console.log(t),e.$message({message:e.title+"失败",type:"error"}),e.editFormVisible=!1,e.editForm={}}):Object(s.a)({url:c+"/source/updatesourceid",method:"post",data:e.editForm}).then(function(t){e.editFormVisible=!1,e.editForm={},e.$message.success("修改成功")}).catch(function(t){console.log(t),e.$message.error("请重新提交")})})},callFather:function(e){this.pageparm.pageNo=e.pageNo,this.pageparm.pageSize=e.pageSize},closeDialog:function(){this.editFormVisible=!1,this.editForm={}},handleCarNumbers:function(e){this.editForm=e,this.sid=e.sid,this.getCarNumbersBySid(e.sid),this.carNumbersVisible=!0},getCarNumbersBySid:function(e){var t=this;Object(s.a)({method:"post",url:c+"/source/selectallsourceinfo",data:w()({sid:e},this.pageparm)}).then(function(e){t.carNumbersBySid=e.data.data[0].sourceCarNumberDto,t.carNumbersInfoData=e.data.data[0].sourceCarNumberDto,t.carNumbersInfoData.sort(t.compare("carNumber"))}).catch(function(e){})},insertLongCarNumber:function(){var e=this;this.$confirm("是否提交该车号?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){if(e.selectSquareCarNumberList.length){for(var t=0;t<e.selectSquareCarNumberList.length;t++)Object(s.a)({url:c+"/source/insertsourcecarnumber",method:"post",data:{sid:e.sid,carNumber:e.selectSquareCarNumberList[t]}}).then(function(t){e.getQS(),e.getCarNumbersBySid(e.sid)}).catch(function(t){e.getQS(),e.getCarNumbersBySid(e.sid),console.log(t),e.$message.error("请重新提交")});e.selectSquareCarNumberList=[]}else e.$message.warning("请选择车号")}).then(function(){e.updateNumber(e.sid)}).catch(function(){e.$message({type:"info",message:"已取消提交"})})},toRemoveSpacing:function(e){if("string"==typeof e)var t=e.replace(/[\t\r\f\n\s]*/g,"");return t},updateNumber:function(e){var t=this;Object(s.a)({method:"post",url:c+"/source/selectallsourceinfo",data:{sid:e}}).then(function(e){var a=e.data.data[0].sourceCarNumberDto,l=a.length;t.updateTotal=l;for(var r=0,o=0,i=0,n=0,s=0,c=0,u=0;u<l;u++){var m=t.toRemoveSpacing(a[u].complTime);"null"==m.toLowerCase()||""==m||"N/A"==m||"未完成"==m?(r+=1,Be.includes(a[u].carNumber)?i+=1:n+=1):(o+=1,Be.includes(a[u].carNumber)?s+=1:c+=1)}t.updateIncompl=r,t.updateCompl=o,t.updateComplEight=c,t.updateComplTwo=s,t.updateIncomplTwo=i,t.updateIncomplEight=n}).then(function(){var a=void 0;a=0==t.updateIncompl&0!=t.updateTotal?1:0,Object(s.a)({url:c+"/source/updatesourceid",method:"post",data:w()({sid:e},t.editForm,{total:t.updateTotal,incomplTotal:t.updateIncompl,complTotal:t.updateCompl,complEight:t.updateComplEight,complTwo:t.updateComplTwo,incomplEight:t.updateIncomplEight,incomplTwo:t.updateIncomplTwo,state:a})}).then(function(e){t.editFormVisible=!1,t.search(),t.getCarNumbersBySid(t.sid)}).catch(function(e){console.log(e)})})},handleCarNumberForm:function(){var e=this;this.inputValue&&this.$confirm("是否提交该车号?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var t=e.inputValue;t&&(e.selectedCarNumbers.push(t),Object(s.a)({url:c+"/source/insertsourcecarnumber",method:"post",data:{sid:e.sid,carNumber:e.inputValue}}).then(function(t){e.getQS(),e.getCarNumbersBySid(e.sid),e.inputVisible=!1,e.$message.success("提交成功")}).catch(function(t){e.getQS(),e.editForm={},console.log(t),e.$message.error("请重新提交")})),e.inputValue=""}).catch(function(){e.$message({type:"info",message:"已取消提交"})})},handleClose:function(){this.carNumberComplForm={},this.carNumberComplTimeVisible=!1},handleSelectedCarNumbers:function(){this.carNumbersVisible=!1},handleCloseNumbers:function(e,t){var a=this;this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:c+"/source/deletesourcecarnumbersid",method:"post",params:{cid:e}}).then(function(e){a.$message({message:"删除成功",type:"success"}),a.getQS()}).catch(function(e){console.log(e)})}).catch(function(){a.$message({type:"info",message:"已取消删除"})})},deleteCarNumber:function(e,t){var a=this;this.$confirm("此操作将永久删除, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:c+"/source/deletesourcecarnumbersid",method:"post",params:{cid:e}}).then(function(e){a.$message({message:"删除成功",type:"success"}),a.getCarNumbersBySid(a.sid)}).then(function(){var e=a.editForm.total;e-=1,console.log(e);var l=void 0,r=void 0,o=void 0,i=void 0,n=a.toRemoveSpacing(t.complTime),u=void 0,m=void 0,p=void 0,d=void 0;"null"==n.toLowerCase()||""==n||"N/A"==n||"未完成"==n?(o=0!=e&0==(l=a.editForm.incomplTotal-1)?1:0,Be.includes(t.carNumber)?u=a.editForm.incomplTwo-1:m=a.editForm.incomplEight-1):(e==(r=a.editForm.complTotal-1)?(o=1,console.log(o)):(o=0,console.log(o)),Be.includes(t.carNumber)?p=a.editForm.complTwo-1:d=a.editForm.complEight-1),i=w()({},a.editForm,{total:e,incomplTotal:l,complTotal:r,state:o}),i="null"==n.toLowerCase()||""==n||"N/A"==n||"未完成"==n?Be.includes(t.carNumber)?w()({},a.editForm,{total:e,incomplTotal:l,incomplTwo:u,state:o}):w()({},a.editForm,{total:e,incomplTotal:l,incomplEight:m,state:o}):Be.includes(t.carNumber)?w()({},a.editForm,{total:e,complTotal:r,complTwo:p,state:o}):w()({},a.editForm,{total:e,complTotal:r,complEight:d,state:o}),Object(s.a)({url:c+"/source/updatesourceid",method:"post",data:w()({sid:a.sid},i)}).then(function(e){a.initPage(),a.getQS()}).then(function(){Object(s.a)({method:"post",url:c+"/source/selectallsourceinfo",data:{sid:a.sid}}).then(function(e){a.editForm=e.data.data[0],console.log(a.editForm),a.initPage(),a.getQS(),a.getCarNumbersBySid(a.sid)})})})}).catch(function(){a.$message({type:"info",message:"已取消删除"})})},handleInputConfirm:function(e){var t=this;this.$confirm("是否提交该车号?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var a=t.inputValue;a&&(t.selectedCarNumbers.push(a),Object(s.a)({url:c+"/source/insertsourcecarnumber",method:"post",data:{sid:e.sid,carNumber:t.inputValue}}).then(function(e){t.inputVisible=!1,t.$message.success("提交成功")}).catch(function(e){console.log(e),t.$message.error("请重新提交")})),t.inputValue=""}).catch(function(){t.$message({type:"info",message:"已取消提交"})})},showInput:function(){var e=this;this.inputVisible=!0,this.$nextTick(function(t){e.$refs.saveTagInput.$refs.input.focus()})},editCarNumber:function(e,t){this.carNumberComplForm=e},handleComplTime:function(){var e=this;this.carNumberComplTimeVisible=!1,Object(s.a)({url:c+"/source/updatesourcecarnumber",method:"post",data:this.carNumberComplForm}).then(function(t){e.getQS()}).catch(function(e){})},exportSourceExcel:function(){var e=c+"/source/exportsource?";for(var t in this.pageparm)this.pageparm[t]&&(e+=t+"="+this.pageparm[t]+"&");s.a.get(e).then(function(t){window.location.href=e})},exportSourceFinalExcel:function(){var e=c+"/source/exportsourcefinalqualitysquare?";for(var t in this.pageparm||0==this.pageparm[t])this.pageparm[t]&&(e+=t+"="+this.pageparm[t]+"&");s.a.get(e).then(function(t){window.location.href=e})},handleSourceExceed:function(e,t){this.$message.warning("当前限制选择文件个数，本次选择了 "+e.length+" 个文件，共选择了 "+(e.length+t.length)+" 个文件")},handleSourceSuccess:function(){this.getQS(),this.$message.success("导入成功")},handleError:function(){this.$message.error("导入格式错误，请修改后重新导入！")},handleCarNumbersInfo:function(e){this.carNumbersInfoVisible=!0,this.getCarNumbersBySid(e.sid),this.sid=e.sid,this.editForm=e},deleteCarNumbersInfo:function(e){this.deleteCarNumbersInfoVisible=!0,this.getCarNumbersBySid(e.sid),this.sid=e.sid,this.editForm=e},enditComplTime:function(){this.ComplTimeVisible=!1},editComplTime:function(e){var t=this;Object(s.a)({url:c+"/source/updatesourcecarnumber",method:"post",data:{cid:e.cid,complTime:e.complTime}}).then(function(e){t.$message.success("提交成功"),t.getQS()}).then(function(){t.updateNumber(t.sid)})},deleteSourceInfoBySID:function(e){var t=this;this.$confirm("此操作将永久删除, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:c+"/source/deletesourceinfosid",method:"post",params:{sid:e}}).then(function(e){t.$message.success("删除成功"),t.getQS()}).catch(function(e){t.$message.error("删除失败")})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},changeDimension:function(e,t){var a=this;this.$confirm("是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:" "+c+"/source/changedimension",params:{sid:e,dimension:t}}).then(function(e){a.$message.success("成功"),a.search()}).catch(function(e){a.$message.error("失败")})}).catch(function(){a.$message({type:"info",message:"已取消"})})},rowCarStyle:function(e){if(1==e.row.concern)return{background:"antiquewhite"}},changeCarConcern:function(e,t){var a=this;this.$confirm("是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:" "+c+"/source/changeconcern",params:{cid:e,concern:t}}).then(function(e){a.$message.success("标注成功"),a.getQS(),a.getCarNumbersBySid(a.sid),a.search()}).catch(function(e){a.getQS(),a.getCarNumbersBySid(a.sid),a.$message.error("标注失败")})}).catch(function(){a.$message({type:"info",message:"已取消"})})},closeCarNumbersInfoVisible:function(){this.carNumbersInfoVisible=!1,this.carNumbersInfoData=[]},showModal:function(e){var t=this;console.log(e),Object(s.a)({url:c+"/source/fileList/"+e,method:"get"}).then(function(e){console.log(e),t.dialogVisible=!0,t.attachmentList=e.data.data||[]})},handleCloseFile:function(e){e()},handleFileNameClick:function(e){var t=this;console.log(c+"/source/download/"+e.sourceFileMidId),console.log("点击文件名",e),this.$confirm("点击后下载，是否确定？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:c+"/source/getFileInfo/"+e.fileId,method:"get"}).then(function(a){console.log(a),200!==a.data.code&&(t.$message.error(a.data.msg),t.showModal(e.sourceId)),D(c+"/source/download/"+e.sourceFileMidId,e.fileName),console.log(c+"/source/download/"+e.sourceFileMidId)}).catch(function(e){t.$message.error(e)})})},downloadAttachment:function(e){console.log("下载附件",e),D(c+"/source/download/"+e.sourceFileMidId,e.fileName)},deleteAttachment:function(e){var t=this;console.log("删除附件",e),this.deleteParams={fileId:e.fileId,sourceFileMidId:e.sourceFileMidId},this.$confirm("点击后删除，是否确定？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:c+"/source/deleteFile",method:"post",data:t.deleteParams}).then(function(a){console.log(a),200!==a.data.code?t.$message.error(a.data.msg):(t.$message.success("操作成功!"),t.showModal(e.sourceId))}).catch(function(e){t.$message.error(e)})})},showUploadModal:function(e){this.source.sid=e.sid,this.uploadModalVisible=!0},beforeClose:function(e){e()},handleFileSuccess:function(e,t,a){console.log("success"),200!==e.code?(this.$message.error(e.msg),this.$refs.refName.uploadFiles.splice(this.$refs.refName.uploadFiles.indexOf(t),1)):this.$message.success("上传成功")},handleFileError:function(e,t,a){this.$message.error("文件超出大小限制，上传失败，请联系管理员!"),this.$refs.refName.uploadFiles.splice(this.$refs.refName.uploadFiles.indexOf(t),1),this.$refs.refName.clearFiles()},upload:function(){this.$refs.refName.clearFiles(),this.uploadModalVisible=!1}}},ze={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:6}},[a("div",{staticClass:"grid-content bg-purple"},[a("el-button",{attrs:{size:"small",type:"warning",icon:"el-icon-star-on"},on:{click:function(t){return e.exportSourceFinalExcel()}}},[e._v("导出")])],1)])],1),e._v(" "),a("el-form",{ref:"searchForm",staticClass:"user-search",attrs:{inline:!0,model:e.pageparm}},[a("el-form-item",{attrs:{label:"标注",prop:"dimension"}},[a("el-select",{attrs:{placeholder:"请选择"},on:{change:function(t){return e.changeInput(t)}},model:{value:e.pageparm.dimension,callback:function(t){e.$set(e.pageparm,"dimension",t)},expression:"pageparm.dimension"}},[a("el-option",{attrs:{label:"非重点关注",value:"0"}}),e._v(" "),a("el-option",{attrs:{label:"重点关注",value:"1"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"批次",prop:"batch"}},[a("el-input",{attrs:{placeholder:"输入批次"},on:{input:function(t){return e.changeInput(t)}},model:{value:e.pageparm.batch,callback:function(t){e.$set(e.pageparm,"batch",t)},expression:"pageparm.batch"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"总公司文号",prop:"headDocumentNumber"}},[a("el-input",{attrs:{placeholder:"输入总公司文号"},on:{input:function(t){return e.changeInput(t)}},model:{value:e.pageparm.headDocumentNumber,callback:function(t){e.$set(e.pageparm,"headDocumentNumber",t)},expression:"pageparm.headDocumentNumber"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"路局文号",prop:"roadDocumentNumber"}},[a("el-input",{attrs:{placeholder:"输入路局文号"},on:{input:function(t){return e.changeInput(t)}},model:{value:e.pageparm.roadDocumentNumber,callback:function(t){e.$set(e.pageparm,"roadDocumentNumber",t)},expression:"pageparm.roadDocumentNumber"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"申请单编号",prop:"applicNumber"}},[a("el-input",{attrs:{placeholder:"输入申请单编号"},on:{input:function(t){return e.changeInput(t)}},model:{value:e.pageparm.applicNumber,callback:function(t){e.$set(e.pageparm,"applicNumber",t)},expression:"pageparm.applicNumber"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"项目名称",prop:"entryName"}},[a("el-input",{attrs:{placeholder:"输入项目名称"},on:{input:function(t){return e.changeInput(t)}},model:{value:e.pageparm.entryName,callback:function(t){e.$set(e.pageparm,"entryName",t)},expression:"pageparm.entryName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"项目完成情况",prop:"state"}},[a("el-select",{attrs:{placeholder:"请选择项目完成情况"},on:{change:function(t){return e.changeInput(t)}},model:{value:e.pageparm.state,callback:function(t){e.$set(e.pageparm,"state",t)},expression:"pageparm.state"}},[a("el-option",{attrs:{label:"已完成",value:1}}),e._v(" "),a("el-option",{attrs:{label:"未完成",value:0}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"修程",prop:"repairProcedure"}},[a("el-input",{attrs:{placeholder:"输入修程"},on:{input:function(t){return e.changeInput(t)}},model:{value:e.pageparm.repairProcedure,callback:function(t){e.$set(e.pageparm,"repairProcedure",t)},expression:"pageparm.repairProcedure"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"车号",prop:"carNumber"}},[a("el-select",{attrs:{multiple:"",filterable:"",placeholder:"请选择车号"},on:{change:function(t){return e.changeInput(t)}},model:{value:e.carNumbers,callback:function(t){e.carNumbers=t},expression:"carNumbers"}},e._l(e.squareCarNumberList,function(e){return a("el-option",{key:e.value,attrs:{label:e.value,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"车号完成情况",prop:"complTime"}},[a("el-select",{attrs:{placeholder:"请选择车号完成情况"},on:{change:function(t){return e.changeInput(t)}},model:{value:e.pageparm.complTime,callback:function(t){e.$set(e.pageparm,"complTime",t)},expression:"pageparm.complTime"}},[a("el-option",{attrs:{label:"已完成",value:"已完成"}}),e._v(" "),a("el-option",{attrs:{label:"未完成",value:"未完成"}})],1)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-search"},on:{click:function(t){return e.search()}}},[e._v("搜索")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-refresh-right"},on:{click:function(t){return e.resetForm("searchForm")}}},[e._v("重置")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-plus"},on:{click:function(t){return e.handleEdit()}}},[e._v("添加")])],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"",height:"650","row-style":e.rowStyle}},[a("el-table-column",{attrs:{type:"index",label:"序号",align:"center",width:"70",index:e.indexMethod,fixed:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"batch",label:"批次",width:"80",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"headDocumentNumber",label:"总公司文号",width:"120",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"roadDocumentNumber",label:"路局文号",width:"120",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"applicNumber",label:"申请单编号",width:"120",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"entryName",label:"项目名称",width:"200",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"repairProcedure",label:"修程",width:"200",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"total",label:"总数",align:"center",width:"70"}}),e._v(" "),a("el-table-column",{attrs:{prop:"complEight",label:"CRH380A",width:"90",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"complTwo",label:"CRH2A",width:"90",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"complTotal",label:"已完成",width:"70",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"incomplEight",label:"CRH380A",width:"90",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"incomplTwo",label:"CRH2A",width:"90",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"incomplTotal",label:"未完成",width:"70",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"carNumbers",label:"车号",align:"center",width:"280"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.sourceCarNumberDto,function(t){return a("div",{key:t.cid,staticStyle:{display:"inline-block"}},["未完成"==t.complTime&0==t.concern?a("el-tag",{attrs:{type:"info"}},[e._v(e._s(t.carNumber))]):"未完成"!=t.complTime&0==t.concern?a("el-tag",{attrs:{type:"success"}},[e._v(e._s(t.carNumber))]):a("el-tag",{attrs:{type:"warning"}},[e._v(e._s(t.carNumber))])],1)})}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"note",label:"备注",align:"center",width:"220"}}),e._v(" "),a("el-dialog",{attrs:{title:"文件上传",visible:e.uploadModalVisible,width:"650px","before-close":e.beforeClose,"append-to-body":"","show-close":!1,"close-on-click-modal":!1},on:{"update:visible":function(t){e.uploadModalVisible=t}}},[a("el-upload",{ref:"refName",staticClass:"uploadFile",attrs:{action:e.baseURL+"/source/upload","on-success":e.handleFileSuccess,"on-error":e.handleFileError,"file-list":e.fileList,data:e.source,drag:"",multiple:""}},[a("i",{staticClass:"el-icon-upload"}),e._v(" "),a("div",{staticClass:"el-upload__text"},[e._v("将文件拖到此处，或"),a("em",[e._v("点击上传")])])]),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.upload}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.upload}},[e._v("确 定")])],1)],1),e._v(" "),a("el-table-column",{attrs:{prop:"",label:"操作",width:"180",align:"center",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("el-button",{attrs:{type:"primary",icon:"el-icon-circle-plus",circle:""},on:{click:function(a){return e.handleCarNumbersInfo(t.row)}}}),e._v(" "),a("el-button",{attrs:{type:"danger",icon:"el-icon-remove",circle:""},on:{click:function(a){return e.deleteCarNumbersInfo(t.row)}}})],1),e._v(" "),a("div",{staticStyle:{"margin-top":"10px"}},[a("el-button",{attrs:{type:"primary",icon:"el-icon-edit",circle:""},on:{click:function(a){return e.handleEdit(t.$index,t.row)}}}),e._v(" "),a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(a){return e.deleteSourceInfoBySID(t.row.sid)}}})],1),e._v(" "),a("div",{staticStyle:{"margin-top":"10px"}},[1==t.row.dimension?a("el-button",{attrs:{type:"warning",icon:"el-icon-warning",circle:""},on:{click:function(a){return e.changeDimension(t.row.sid,0)}}}):a("el-button",{attrs:{icon:"el-icon-warning-outline",circle:""},on:{click:function(a){return e.changeDimension(t.row.sid,1)}}})],1)]}}])})],1),e._v(" "),a("el-dialog",{attrs:{title:e.title,visible:e.editFormVisible,width:"50%"},on:{"update:visible":function(t){e.editFormVisible=t},click:function(t){return e.closeDialog("editForm")}}},[a("el-form",{ref:"editForm",attrs:{"label-width":"120px",model:e.editForm}},[a("el-form-item",{attrs:{label:"批次",prop:"batch"}},[a("el-input",{attrs:{"auto-complete":"off",placeholder:"请输入批次"},model:{value:e.editForm.batch,callback:function(t){e.$set(e.editForm,"batch",t)},expression:"editForm.batch"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"总公司文号",prop:"headDocumentNumber"}},[a("el-input",{attrs:{min:1,label:"",placeholder:"请输入总公司文号"},model:{value:e.editForm.headDocumentNumber,callback:function(t){e.$set(e.editForm,"headDocumentNumber",t)},expression:"editForm.headDocumentNumber"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"路局文号",prop:"roadDocumentNumber"}},[a("el-input",{attrs:{label:"",placeholder:"请输入路局文号"},model:{value:e.editForm.roadDocumentNumber,callback:function(t){e.$set(e.editForm,"roadDocumentNumber",t)},expression:"editForm.roadDocumentNumber"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"申请单编号",prop:"applicNumber"}},[a("el-input",{attrs:{"auto-complete":"off",placeholder:"请输入申请单编号"},model:{value:e.editForm.applicNumber,callback:function(t){e.$set(e.editForm,"applicNumber",t)},expression:"editForm.applicNumber"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"项目名称",prop:"entryName"}},[a("el-input",{attrs:{type:"textarea","auto-complete":"off",placeholder:"请输入项目名称"},model:{value:e.editForm.entryName,callback:function(t){e.$set(e.editForm,"entryName",t)},expression:"editForm.entryName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"修程",prop:"repairProcedure"}},[a("el-input",{attrs:{"auto-complete":"off",placeholder:"请输入修程"},model:{value:e.editForm.repairProcedure,callback:function(t){e.$set(e.editForm,"repairProcedure",t)},expression:"editForm.repairProcedure"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"总量",prop:"total"}},[a("el-input-number",{attrs:{min:0,max:1e3,"auto-complete":"off",placeholder:"请输入总量"},model:{value:e.editForm.total,callback:function(t){e.$set(e.editForm,"total",t)},expression:"editForm.total"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"CRH380A",prop:"complEight"}},[a("el-input-number",{attrs:{min:0,max:1e3,label:"",placeholder:"请输入CRH380A"},model:{value:e.editForm.complEight,callback:function(t){e.$set(e.editForm,"complEight",t)},expression:"editForm.complEight"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"CRH2A",prop:"complTwo"}},[a("el-input-number",{attrs:{min:0,max:1e3,label:"",placeholder:"请输入CRH2A"},model:{value:e.editForm.complTwo,callback:function(t){e.$set(e.editForm,"complTwo",t)},expression:"editForm.complTwo"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"已完成",prop:"complTotal"}},[a("el-input-number",{attrs:{min:0,max:1e3,"auto-complete":"off",placeholder:"请输入已完成"},model:{value:e.editForm.complTotal,callback:function(t){e.$set(e.editForm,"complTotal",t)},expression:"editForm.complTotal"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"CRH380A",prop:"incomplEight"}},[a("el-input-number",{attrs:{min:0,max:1e3,label:"",placeholder:"请输入CRH380A"},model:{value:e.editForm.incomplEight,callback:function(t){e.$set(e.editForm,"incomplEight",t)},expression:"editForm.incomplEight"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"CRH2A ",prop:"incomplTwo"}},[a("el-input-number",{attrs:{min:0,max:1e3,label:"",placeholder:"请输入CRH2A"},model:{value:e.editForm.incomplTwo,callback:function(t){e.$set(e.editForm,"incomplTwo",t)},expression:"editForm.incomplTwo"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"未完成",prop:"incomplTotal"}},[a("el-input-number",{attrs:{"auto-complete":"off",placeholder:"请输入未完成"},model:{value:e.editForm.incomplTotal,callback:function(t){e.$set(e.editForm,"incomplTotal",t)},expression:"editForm.incomplTotal"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"备注",prop:"node"}},[a("el-input",{attrs:{type:"textarea","auto-complete":"off",placeholder:"备注"},model:{value:e.editForm.note,callback:function(t){e.$set(e.editForm,"note",t)},expression:"editForm.note"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){return e.closeDialog("editForm")}}},[e._v("取消")]),e._v(" "),a("el-button",{staticClass:"title",attrs:{size:"small",type:"primary"},on:{click:function(t){return e.handelSource("editForm")}}},[e._v("保存")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"查看车号",visible:e.carNumbersInfoVisible,width:"50%","before-close":e.closeCarNumbersInfoVisible},on:{"update:visible":function(t){e.carNumbersInfoVisible=t}}},[a("div",[a("el-form",{ref:"searchForm",staticClass:"user-search",attrs:{inline:!0,model:e.pageparmcar}},[a("el-form-item",{attrs:{label:"",prop:""}},[a("el-select",{attrs:{multiple:"",placeholder:"请选择车号"},model:{value:e.selectSquareCarNumberList,callback:function(t){e.selectSquareCarNumberList=t},expression:"selectSquareCarNumberList"}},e._l(e.squareCarNumberList,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-search"},on:{click:function(t){return e.insertLongCarNumber()}}},[e._v("添加")])],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.carNumbersInfoData,border:"",height:"500","row-style":e.rowCarStyle}},[a("el-table-column",{attrs:{type:"index",label:"序号",align:"center",width:"70",index:e.indexMethod,fixed:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"carNumber",label:"车号",width:"180",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"complTime",label:"完成时间",width:"240",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{ref:"saveTagInput",staticClass:"input-new-tag",attrs:{type:"textarea"},on:{blur:function(a){return e.editComplTime(t.row)}},model:{value:t.row.complTime,callback:function(a){e.$set(t.row,"complTime",a)},expression:"scope.row.complTime"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"",label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[1==t.row.concern?a("el-button",{attrs:{type:"warning",icon:"el-icon-warning",circle:""},on:{click:function(a){return e.changeCarConcern(t.row.cid,0)}}}):a("el-button",{attrs:{icon:"el-icon-warning-outline",circle:""},on:{click:function(a){return e.changeCarConcern(t.row.cid,1)}}})]}}])})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){return e.closeCarNumbersInfoVisible()}}},[e._v("取 消")])],1)]),e._v(" "),a("el-dialog",{attrs:{title:"删除车号",visible:e.deleteCarNumbersInfoVisible,width:"50%","before-close":function(){e.deleteCarNumbersInfoVisible=!1}},on:{"update:visible":function(t){e.deleteCarNumbersInfoVisible=t}}},[a("div",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.carNumbersInfoData,border:"",height:"500","row-style":e.rowCarStyle}},[a("el-table-column",{attrs:{type:"index",label:"序号",align:"center",width:"70",index:e.indexMethod,fixed:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"carNumber",label:"车号",width:"180",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"complTime",label:"完成时间",width:"240",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{ref:"saveTagInput",staticClass:"input-new-tag",attrs:{type:"textarea",disabled:""},on:{blur:function(a){return e.editComplTime(t.row)}},model:{value:t.row.complTime,callback:function(a){e.$set(t.row,"complTime",a)},expression:"scope.row.complTime"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"",label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(a){return e.deleteCarNumber(t.row.cid,t.row)}}})]}}])})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.deleteCarNumbersInfoVisible=!1}}},[e._v("取 消")])],1)])],1)},staticRenderFns:[]};var Me=a("VU/8")(Ie,ze,!1,function(e){a("8bd0")},"data-v-4e7d435b",null).exports,qe=[{label:5025,value:5025},{label:5027,value:5027},{label:5031,value:5031},{label:5032,value:5032},{label:5034,value:5034},{label:5040,value:5040},{label:5058,value:5058},{label:5059,value:5059},{label:5060,value:5060},{label:5066,value:5066},{label:5075,value:5075},{label:5080,value:5080},{label:5083,value:5083},{label:5084,value:5084},{label:5085,value:5085},{label:5086,value:5086},{label:5087,value:5087},{label:5095,value:5095},{label:5096,value:5096},{label:5098,value:5098},{label:5122,value:5122},{label:5133,value:5133}],Oe={name:"qualitylong",inject:["reload"],data:function(){var e;return e={baseURL:c,carNumberList:S,longCarNumberList:qe,selectLongCarNumberList:[],classCarNumbers:R,sid:0,carNumbers:[],tableData:[],loading:!1,pageparm:{type:2,pageNo:1,pageSize:1e5},pageparmcar:{},editFormVisible:!1,title:"编辑",editForm:{type:2},total:0},x()(e,"loading",!1),x()(e,"carNumbersVisible",!1),x()(e,"props",{multiple:!0}),x()(e,"selectedCarNumbers",[]),x()(e,"inputVisible",!1),x()(e,"inputValue",""),x()(e,"carNumberComplTimeVisible",!1),x()(e,"carNumberComplForm",{}),x()(e,"carNumbersBySid",[]),x()(e,"carNumbersInfoVisible",!1),x()(e,"carNumbersInfoData",[]),x()(e,"ComplTimeVisible",!0),x()(e,"updateTotal",0),x()(e,"updateIncompl",0),x()(e,"updateCompl",0),x()(e,"deleteCarNumbersInfoVisible",!1),e},computed:{indexMethod:function(){return(this.pageparm.pageNo-1)*this.pageparm.pageSize+1}},created:function(){this.getQL()},methods:{changeInput:function(e){this.$forceUpdate()},search:function(){var e=this;this.carNumbers.length&&(this.pageparm.carNumbers=this.carNumbers),this.loading=!0,Object(s.a)({method:"post",url:c+"/source/selectallsourceinfo",data:this.pageparm}).then(function(t){var a=t.data.data;a=a.map(function(t){return t.sourceCarNumberDto.sort(e.compare("carNumber")),t}),e.tableData=a,e.loading=!1,e.$message.success("搜索成功")}).catch(function(t){e.initPage(),e.$message.error("搜索失败"),console.log(t)})},resetForm:function(e){this.$refs[e].resetFields(),this.carNumbers=[],this.pageparm.carNumbers&&delete this.pageparm.carNumbers},initPage:function(){this.pageparm={pageNo:1,pageSize:1e5,type:2}},getQL:function(){var e=this;Object(s.a)({url:c+"/source/selectallsourceinfo",method:"post",data:this.pageparm}).then(function(t){var a=t.data.data;a=a.map(function(t){return t.sourceCarNumberDto.sort(e.compare("carNumber")),t}),e.tableData=a,e.loading=!1}).catch(function(e){console.log(e)})},compare:function(e){return function(t,a){return t[e]-a[e]}},handleEdit:function(e,t){this.editFormVisible=!0,void 0!=t&&"undefined"!=t?(this.title="修改",this.editForm=t):(this.title="添加",this.editForm={})},changeResult:function(){this.editForm.result=""},handelSource:function(){var e=this;this.$refs.editForm.validate(function(t){if(!t)return console.log("提交失败"),!1;"添加"==e.title?Object(s.a)({url:c+"/source/insertsource",method:"post",data:w()({},e.editForm,{type:2})}).then(function(t){e.$message({message:e.title+"成功",type:"success"}),e.editFormVisible=!1,e.editForm={type:2},e.getQL()}).catch(function(t){console.log(t),e.$message({message:e.title+"失败",type:"error"}),e.editFormVisible=!1,e.editForm={type:2}}):Object(s.a)({url:c+"/source/updatesourceid",method:"post",data:e.editForm}).then(function(t){e.editFormVisible=!1,e.editForm={},e.$message.success("修改成功")}).catch(function(t){console.log(t),e.$message.error("请重新提交")})})},closeDialog:function(){this.editFormVisible=!1,this.editForm={}},handleCarNumbers:function(e){this.editForm=e,this.sid=e.sid,this.getCarNumbersBySid(e.sid),this.carNumbersVisible=!0},getCarNumbersBySid:function(e){var t=this;Object(s.a)({method:"post",url:c+"/source/selectallsourceinfo",data:w()({sid:e},this.pageparm)}).then(function(e){t.carNumbersBySid=e.data.data[0].sourceCarNumberDto,t.carNumbersInfoData=e.data.data[0].sourceCarNumberDto,t.carNumbersInfoData.sort(t.compare("carNumber"))}).catch(function(e){})},insertLongCarNumber:function(){var e=this;this.$confirm("是否提交该车号?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){if(e.selectLongCarNumberList.length){for(var t=0;t<e.selectLongCarNumberList.length;t++)Object(s.a)({url:c+"/source/insertsourcecarnumber",method:"post",data:{sid:e.sid,carNumber:e.selectLongCarNumberList[t]}}).then(function(t){e.getQL(),e.getCarNumbersBySid(e.sid)}).catch(function(t){e.getQL(),e.editForm={},console.log(t),e.$message.error("请重新提交")});e.selectLongCarNumberList=[]}else e.$message.warning("请选择车号")}).then(function(){e.updateNumber(e.sid)}).catch(function(){e.$message({type:"info",message:"已取消提交"})})},toRemoveSpacing:function(e){if("string"==typeof e)var t=e.replace(/[\t\r\f\n\s]*/g,"");return t},updateNumber:function(e){var t=this;Object(s.a)({method:"post",url:c+"/source/selectallsourceinfo",data:{sid:e}}).then(function(e){console.log(e.data.data[0].sourceCarNumberDto);var a=e.data.data[0].sourceCarNumberDto,l=e.data.data[0].sourceCarNumberDto.length;t.updateTotal=l,console.log("total",l);for(var r=0,o=0,i=0;i<l;i++){var n=t.toRemoveSpacing(a[i].complTime);"null"==n.toLowerCase()||""==n||"N/A"==n||"未完成"==n?r+=1:o+=1}console.log("incoml",r),t.updateIncompl=r,t.updateCompl=o}).then(function(){var a=void 0;a=0==t.updateIncompl&0!=t.updateTotal?1:0,Object(s.a)({url:c+"/source/updatesourceid",method:"post",data:w()({sid:e},t.editForm,{total:t.updateTotal,incomplTotal:t.updateIncompl,complTotal:t.updateCompl,state:a})}).then(function(e){t.editFormVisible=!1,t.search(),t.getCarNumbersBySid(t.sid)}).catch(function(e){console.log(e)})})},handleCarNumberForm:function(){var e=this;this.inputValue&&this.$confirm("是否提交该车号?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var t=e.inputValue;t&&(e.selectedCarNumbers.push(t),Object(s.a)({url:c+"/source/insertsourcecarnumber",method:"post",data:{sid:e.sid,carNumber:e.inputValue}}).then(function(t){e.getQL(),e.getCarNumbersBySid(e.sid),e.inputVisible=!1,e.$message.success("提交成功")}).catch(function(t){e.getQL(),e.editForm={},console.log(t),e.$message.error("请重新提交")})),e.inputValue=""}).catch(function(){e.$message({type:"info",message:"已取消提交"})})},deleteCarNumbersInfo:function(e){this.deleteCarNumbersInfoVisible=!0,this.getCarNumbersBySid(e.sid),this.sid=e.sid,this.editForm=e},handleClose:function(e){this.carNumberComplForm={},this.carNumberComplTimeVisible=!1},handleSelectedCarNumbers:function(){this.carNumbersVisible=!1},handleCloseNumbers:function(e,t){var a=this;this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:c+"/source/deletesourcecarnumbersid",method:"post",params:{cid:e}}).then(function(e){a.$message({message:"删除成功",type:"success"}),a.getQL()}).catch(function(e){console.log(e)})}).catch(function(){a.$message({type:"info",message:"已取消删除"})})},deleteCarNumber:function(e,t){var a=this;this.$confirm("此操作将永久删除, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:c+"/source/deletesourcecarnumbersid",method:"post",params:{cid:e}}).then(function(e){a.$message({message:"删除成功",type:"success"}),a.getCarNumbersBySid(a.sid)}).then(function(){var e=a.editForm.total;e-=1,console.log(e);var l=void 0,r=void 0,o=void 0,i=void 0,n=a.toRemoveSpacing(t.complTime);"null"==n.toLowerCase()||""==n||"N/A"==n||"未完成"==n?o=0!=e&0==(l=a.editForm.incomplTotal-1)?1:0:e==(r=a.editForm.complTotal-1)?(o=1,console.log(o)):(o=0,console.log(o)),console.log(t),console.log(e,l,r),i=w()({},a.editForm,{total:e,incomplTotal:l,complTotal:r,state:o}),"null"==n.toLowerCase()||""==n||"N/A"==n||"未完成"==n?(i=w()({},a.editForm,{total:e,incomplTotal:l,state:o}),console.log(i)):(i=w()({},a.editForm,{total:e,complTotal:r,state:o}),console.log(i)),Object(s.a)({url:c+"/source/updatesourceid",method:"post",data:w()({sid:a.sid},i)}).then(function(e){a.initPage(),a.getQL(),a.getCarNumbersBySid(a.sid)}).then(function(){Object(s.a)({method:"post",url:c+"/source/selectallsourceinfo",data:{sid:a.sid}}).then(function(e){a.editForm=e.data.data[0],console.log(a.editForm),a.initPage(),a.getQL(),a.getCarNumbersBySid(a.sid)})})})}).catch(function(){a.$message({type:"info",message:"已取消删除"})})},handleInputConfirm:function(e){var t=this;this.$confirm("是否提交该车号?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var a=t.inputValue;a&&(t.selectedCarNumbers.push(a),Object(s.a)({url:c+"/source/insertsourcecarnumber",method:"post",data:{sid:e.sid,carNumber:t.inputValue}}).then(function(e){t.inputVisible=!1,t.$message.success("提交成功")}).catch(function(e){console.log(e),t.$message.error("请重新提交")})),t.inputValue=""}).catch(function(){t.$message({type:"info",message:"已取消提交"})})},showInput:function(){var e=this;this.inputVisible=!0,this.$nextTick(function(t){e.$refs.saveTagInput.$refs.input.focus()})},editCarNumber:function(e,t){this.carNumberComplForm=e},handleComplTime:function(){var e=this;this.carNumberComplTimeVisible=!1,Object(s.a)({url:c+"/source/updatesourcecarnumber",method:"post",data:this.carNumberComplForm}).then(function(t){e.getQL()}).catch(function(e){})},exportSourceExcel:function(){var e=c+"/source/exportsource?";for(var t in this.pageparm)this.pageparm[t]&&(e+=t+"="+this.pageparm[t]+"&");s.a.get(e).then(function(t){console.log(e),window.location.href=e})},exportSourceFinalExcel:function(){var e=c+"/source/exportsourcefinalqualitylong?";for(var t in this.pageparm)(this.pageparm[t]||0==this.pageparm[t])&&(e+=t+"="+this.pageparm[t]+"&");s.a.get(e).then(function(t){window.location.href=e})},handleSourceExceed:function(e,t){this.$message.warning("当前限制选择文件个数，本次选择了 "+e.length+" 个文件，共选择了 "+(e.length+t.length)+" 个文件")},handleSourceSuccess:function(){this.getQL(),this.$message.success("导入成功")},handleError:function(){this.$message.error("导入格式错误，请修改后重新导入！")},handleCarNumbersInfo:function(e){this.carNumbersInfoVisible=!0,this.getCarNumbersBySid(e.sid),this.sid=e.sid,this.editForm=e},enditComplTime:function(){this.ComplTimeVisible=!1},editComplTime:function(e){var t=this;Object(s.a)({url:c+"/source/updatesourcecarnumber",method:"post",data:{cid:e.cid,complTime:e.complTime}}).then(function(e){t.$message.success("提交成功")}).then(function(){t.updateNumber(t.sid)})},deleteSourceInfoBySID:function(e){var t=this;this.$confirm("此操作将永久删除, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:c+"/source/deletesourceinfosid",method:"post",params:{sid:e}}).then(function(e){t.$message.success("删除成功"),t.getQL()}).catch(function(e){t.$message.error("删除失败")})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},changeDimension:function(e,t){var a=this;this.$confirm("是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:" "+c+"/source/changedimension",params:{sid:e,dimension:t}}).then(function(e){a.$message.success("成功"),a.search()}).catch(function(e){a.$message.error("失败")})}).catch(function(){a.$message({type:"info",message:"已取消"})})},rowStyle:function(e){if(1==e.row.dimension)return{background:"antiquewhite"}},rowCarStyle:function(e){if(1==e.row.concern)return{background:"antiquewhite"}},changeCarConcern:function(e,t){var a=this;this.$confirm("是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:" "+c+"/source/changeconcern",params:{cid:e,concern:t}}).then(function(e){a.$message.success("标注成功"),a.getQL(),a.getCarNumbersBySid(a.sid),a.search()}).catch(function(e){a.getQL(),a.getCarNumbersBySid(a.sid),a.$message.error("标注失败")})}).catch(function(){a.$message({type:"info",message:"已取消"})})},closeCarNumbersInfoVisible:function(){this.carNumbersInfoVisible=!1,this.carNumbersInfoData=[]}}},je={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:6}},[a("div",{staticClass:"grid-content bg-purple"},[a("el-button",{attrs:{size:"small",type:"warning",icon:"el-icon-star-on"},on:{click:function(t){return e.exportSourceFinalExcel()}}},[e._v("导出")])],1)])],1),e._v(" "),a("el-form",{ref:"searchForm",staticClass:"user-search",attrs:{inline:!0,model:e.pageparm}},[a("el-form-item",{attrs:{label:"标注",prop:"dimension"}},[a("el-select",{attrs:{placeholder:"请选择"},on:{change:function(t){return e.changeInput(t)}},model:{value:e.pageparm.dimension,callback:function(t){e.$set(e.pageparm,"dimension",t)},expression:"pageparm.dimension"}},[a("el-option",{attrs:{label:"非重点关注",value:"0"}}),e._v(" "),a("el-option",{attrs:{label:"重点关注",value:"1"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"批次",prop:"batch"}},[a("el-input",{attrs:{placeholder:"输入批次"},on:{input:function(t){return e.changeInput(t)}},model:{value:e.pageparm.batch,callback:function(t){e.$set(e.pageparm,"batch",t)},expression:"pageparm.batch"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"总公司文号",prop:"headDocumentNumber"}},[a("el-input",{attrs:{placeholder:"输入总公司文号"},on:{input:function(t){return e.changeInput(t)}},model:{value:e.pageparm.headDocumentNumber,callback:function(t){e.$set(e.pageparm,"headDocumentNumber",t)},expression:"pageparm.headDocumentNumber"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"路局文号",prop:"roadDocumentNumber"}},[a("el-input",{attrs:{placeholder:"输入路局文号"},on:{input:function(t){return e.changeInput(t)}},model:{value:e.pageparm.roadDocumentNumber,callback:function(t){e.$set(e.pageparm,"roadDocumentNumber",t)},expression:"pageparm.roadDocumentNumber"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"申请单编号",prop:"applicNumber"}},[a("el-input",{attrs:{placeholder:"输入申请单编号"},on:{input:function(t){return e.changeInput(t)}},model:{value:e.pageparm.applicNumber,callback:function(t){e.$set(e.pageparm,"applicNumber",t)},expression:"pageparm.applicNumber"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"项目名称",prop:"entryName"}},[a("el-input",{attrs:{placeholder:"输入项目名称"},on:{input:function(t){return e.changeInput(t)}},model:{value:e.pageparm.entryName,callback:function(t){e.$set(e.pageparm,"entryName",t)},expression:"pageparm.entryName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"项目完成情况",prop:"state"}},[a("el-select",{attrs:{placeholder:"请选择项目完成情况"},on:{change:function(t){return e.changeInput(t)}},model:{value:e.pageparm.state,callback:function(t){e.$set(e.pageparm,"state",t)},expression:"pageparm.state"}},[a("el-option",{attrs:{label:"已完成",value:1}}),e._v(" "),a("el-option",{attrs:{label:"未完成",value:0}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"修程",prop:"repairProcedure"}},[a("el-input",{attrs:{placeholder:"输入修程"},on:{input:function(t){return e.changeInput(t)}},model:{value:e.pageparm.repairProcedure,callback:function(t){e.$set(e.pageparm,"repairProcedure",t)},expression:"pageparm.repairProcedure"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"车号",prop:"carNumber"}},[a("el-select",{attrs:{multiple:"",filterable:"",placeholder:"请选择车号"},on:{change:function(t){return e.changeInput(t)}},model:{value:e.carNumbers,callback:function(t){e.carNumbers=t},expression:"carNumbers"}},e._l(e.longCarNumberList,function(e){return a("el-option",{key:e.value,attrs:{label:e.value,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"车号完成情况",prop:"complTime"}},[a("el-select",{attrs:{placeholder:"请选择车号完成情况"},on:{change:function(t){return e.changeInput(t)}},model:{value:e.pageparm.complTime,callback:function(t){e.$set(e.pageparm,"complTime",t)},expression:"pageparm.complTime"}},[a("el-option",{attrs:{label:"已完成",value:"已完成"}}),e._v(" "),a("el-option",{attrs:{label:"未完成",value:"未完成"}})],1)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-search"},on:{click:function(t){return e.search()}}},[e._v("搜索")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-refresh-right"},on:{click:function(t){return e.resetForm("searchForm")}}},[e._v("重置")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-plus"},on:{click:function(t){return e.handleEdit()}}},[e._v("添加")])],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"",height:"650","row-style":e.rowStyle}},[a("el-table-column",{attrs:{type:"index",label:"序号",align:"center",width:"70",index:e.indexMethod,fixed:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"batch",label:"批次",width:"80",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"headDocumentNumber",label:"总公司文号",width:"120",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"roadDocumentNumber",label:"路局文号",width:"120",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"applicNumber",label:"申请单编号",width:"120",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"entryName",label:"项目名称",width:"200",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"repairProcedure",label:"修程",width:"200",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"total",label:"总数",align:"center",width:"70"}}),e._v(" "),a("el-table-column",{attrs:{prop:"complTotal",label:"已完成",width:"70",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"incomplTotal",label:"未完成",width:"70",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"carNumbers",label:"车号",align:"center",width:"280"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.sourceCarNumberDto,function(t){return a("div",{key:t.cid,staticStyle:{display:"inline-block"}},["未完成"==t.complTime&0==t.concern?a("el-tag",{attrs:{type:"info"}},[e._v(e._s(t.carNumber))]):"未完成"!=t.complTime&0==t.concern?a("el-tag",{attrs:{type:"success"}},[e._v(e._s(t.carNumber))]):a("el-tag",{attrs:{type:"warning"}},[e._v(e._s(t.carNumber))])],1)})}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"note",label:"备注",align:"center",width:"220"}}),e._v(" "),a("el-table-column",{attrs:{prop:"",label:"操作",width:"180",align:"center",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("el-button",{attrs:{type:"primary",icon:"el-icon-circle-plus",circle:""},on:{click:function(a){return e.handleCarNumbersInfo(t.row)}}}),e._v(" "),a("el-button",{attrs:{type:"danger",icon:"el-icon-remove",circle:""},on:{click:function(a){return e.deleteCarNumbersInfo(t.row)}}})],1),e._v(" "),a("div",{staticStyle:{"margin-top":"10px"}},[a("el-button",{attrs:{type:"primary",icon:"el-icon-edit",circle:""},on:{click:function(a){return e.handleEdit(t.$index,t.row)}}}),e._v(" "),a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(a){return e.deleteSourceInfoBySID(t.row.sid)}}})],1),e._v(" "),a("div",{staticStyle:{"margin-top":"10px"}},[1==t.row.dimension?a("el-button",{attrs:{type:"warning",icon:"el-icon-warning",circle:""},on:{click:function(a){return e.changeDimension(t.row.sid,0)}}}):a("el-button",{attrs:{icon:"el-icon-warning-outline",circle:""},on:{click:function(a){return e.changeDimension(t.row.sid,1)}}})],1)]}}])})],1),e._v(" "),a("el-dialog",{attrs:{title:e.title,visible:e.editFormVisible,width:"50%"},on:{"update:visible":function(t){e.editFormVisible=t},click:function(t){return e.closeDialog("editForm")}}},[a("el-form",{ref:"editForm",attrs:{"label-width":"120px",model:e.editForm}},[a("el-form-item",{attrs:{label:"批次",prop:"batch"}},[a("el-input",{attrs:{"auto-complete":"off",placeholder:"请输入批次"},model:{value:e.editForm.batch,callback:function(t){e.$set(e.editForm,"batch",t)},expression:"editForm.batch"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"总公司文号",prop:"headDocumentNumber"}},[a("el-input",{attrs:{min:1,label:"",placeholder:"请输入总公司文号"},model:{value:e.editForm.headDocumentNumber,callback:function(t){e.$set(e.editForm,"headDocumentNumber",t)},expression:"editForm.headDocumentNumber"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"路局文号",prop:"roadDocumentNumber"}},[a("el-input",{attrs:{label:"",placeholder:"请输入路局文号"},model:{value:e.editForm.roadDocumentNumber,callback:function(t){e.$set(e.editForm,"roadDocumentNumber",t)},expression:"editForm.roadDocumentNumber"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"申请单编号",prop:"applicNumber"}},[a("el-input",{attrs:{"auto-complete":"off",placeholder:"请输入申请单编号"},model:{value:e.editForm.applicNumber,callback:function(t){e.$set(e.editForm,"applicNumber",t)},expression:"editForm.applicNumber"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"项目名称",prop:"entryName"}},[a("el-input",{attrs:{type:"textarea","auto-complete":"off",placeholder:"请输入项目名称"},model:{value:e.editForm.entryName,callback:function(t){e.$set(e.editForm,"entryName",t)},expression:"editForm.entryName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"修程",prop:"repairProcedure"}},[a("el-input",{attrs:{"auto-complete":"off",placeholder:"请输入修程"},model:{value:e.editForm.repairProcedure,callback:function(t){e.$set(e.editForm,"repairProcedure",t)},expression:"editForm.repairProcedure"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"总数",prop:"total"}},[a("el-input-number",{attrs:{min:0,max:1e3,"auto-complete":"off",placeholder:"请输入总量"},model:{value:e.editForm.total,callback:function(t){e.$set(e.editForm,"total",t)},expression:"editForm.total"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"已完成",prop:"complTotal"}},[a("el-input-number",{attrs:{min:0,max:1e3,"auto-complete":"off",placeholder:"请输入已完成"},model:{value:e.editForm.complTotal,callback:function(t){e.$set(e.editForm,"complTotal",t)},expression:"editForm.complTotal"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"未完成",prop:"incomplTotal"}},[a("el-input-number",{attrs:{min:0,max:1e3,"auto-complete":"off",placeholder:"请输入未完成"},model:{value:e.editForm.incomplTotal,callback:function(t){e.$set(e.editForm,"incomplTotal",t)},expression:"editForm.incomplTotal"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"备注",prop:"node"}},[a("el-input",{attrs:{type:"textarea","auto-complete":"off",placeholder:"备注"},model:{value:e.editForm.note,callback:function(t){e.$set(e.editForm,"note",t)},expression:"editForm.note"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){return e.closeDialog("editForm")}}},[e._v("取消")]),e._v(" "),a("el-button",{staticClass:"title",attrs:{size:"small",type:"primary"},on:{click:function(t){return e.handelSource("editForm")}}},[e._v("保存")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"查看车号",visible:e.carNumbersInfoVisible,width:"50%","before-close":e.closeCarNumbersInfoVisible},on:{"update:visible":function(t){e.carNumbersInfoVisible=t}}},[a("div",[a("el-form",{ref:"searchForm",staticClass:"user-search",attrs:{inline:!0,model:e.pageparmcar}},[a("el-form-item",{attrs:{label:"",prop:""}},[a("el-select",{attrs:{multiple:"",placeholder:"请选择车号"},model:{value:e.selectLongCarNumberList,callback:function(t){e.selectLongCarNumberList=t},expression:"selectLongCarNumberList"}},e._l(e.longCarNumberList,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-search"},on:{click:function(t){return e.insertLongCarNumber()}}},[e._v("添加")])],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.carNumbersInfoData,border:"",height:"500","row-style":e.rowCarStyle}},[a("el-table-column",{attrs:{type:"index",label:"序号",align:"center",width:"70",index:e.indexMethod,fixed:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"carNumber",label:"车号",width:"180",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"complTime",label:"完成时间",width:"240",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{ref:"saveTagInput",staticClass:"input-new-tag",attrs:{type:"textarea"},on:{blur:function(a){return e.editComplTime(t.row)}},model:{value:t.row.complTime,callback:function(a){e.$set(t.row,"complTime",a)},expression:"scope.row.complTime"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"",label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[1==t.row.concern?a("el-button",{attrs:{type:"warning",icon:"el-icon-warning",circle:""},on:{click:function(a){return e.changeCarConcern(t.row.cid,0)}}}):a("el-button",{attrs:{icon:"el-icon-warning-outline",circle:""},on:{click:function(a){return e.changeCarConcern(t.row.cid,1)}}})]}}])})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.closeCarNumbersInfoVisible}},[e._v("取 消")])],1)]),e._v(" "),a("el-dialog",{attrs:{title:"删除车号",visible:e.deleteCarNumbersInfoVisible,width:"50%","before-close":function(){e.deleteCarNumbersInfoVisible=!1}},on:{"update:visible":function(t){e.deleteCarNumbersInfoVisible=t}}},[a("div",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.carNumbersInfoData,border:"",height:"500","row-style":e.rowCarStyle}},[a("el-table-column",{attrs:{type:"index",label:"序号",align:"center",width:"70",index:e.indexMethod,fixed:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"carNumber",label:"车号",width:"180",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"complTime",label:"完成时间",width:"240",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{ref:"saveTagInput",staticClass:"input-new-tag",attrs:{type:"textarea",disabled:""},on:{blur:function(a){return e.editComplTime(t.row)}},model:{value:t.row.complTime,callback:function(a){e.$set(t.row,"complTime",a)},expression:"scope.row.complTime"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"",label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(a){return e.deleteCarNumber(t.row.cid,t.row)}}})]}}])})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.deleteCarNumbersInfoVisible=!1}}},[e._v("取 消")])],1)])],1)},staticRenderFns:[]};var Re=a("VU/8")(Oe,je,!1,function(e){a("RXzw")},"data-v-61dc27f5",null).exports,Ee={name:"techSquare",data:function(){var e;return e={baseURL:c,carNumberList:S,classCarNumbers:R,squareCarNumberList:Ve,selectSquareCarNumberList:[],sid:0,carNumbers:[],tableData:[],loading:!1,pageparm:{type:3,pageNo:1,pageSize:1e5},pageparmcar:{},editFormVisible:!1,title:"编辑",editForm:{type:3},total:0},x()(e,"loading",!1),x()(e,"carNumbersVisible",!1),x()(e,"props",{multiple:!0}),x()(e,"selectedCarNumbers",[]),x()(e,"inputVisible",!1),x()(e,"inputValue",""),x()(e,"carNumberComplTimeVisible",!1),x()(e,"carNumberComplForm",{}),x()(e,"carNumbersBySid",[]),x()(e,"carNumbersInfoVisible",!1),x()(e,"carNumbersInfoData",[]),x()(e,"ComplTimeVisible",!0),x()(e,"updateTotal",0),x()(e,"updateIncompl",0),x()(e,"updateCompl",0),x()(e,"deleteCarNumbersInfoVisible",!1),e},computed:{indexMethod:function(){return(this.pageparm.pageNo-1)*this.pageparm.pageSize+1}},created:function(){this.getTS()},methods:{changeInput:function(e){this.$forceUpdate()},search:function(){var e=this;this.carNumbers.length&&(this.pageparm.carNumbers=this.carNumbers),this.loading=!0,Object(s.a)({method:"post",url:c+"/source/selectallsourceinfo",data:this.pageparm}).then(function(t){var a=t.data.data;a=a.map(function(t){return t.sourceCarNumberDto.sort(e.compare("carNumber")),t}),e.tableData=a,e.loading=!1,e.$message.success("搜索成功")}).catch(function(t){e.initPage(),e.getFault(),e.$message.error("搜索失败"),console.log(t)})},resetForm:function(e){this.$refs[e].resetFields(),this.carNumbers=[],this.pageparm.carNumbers&&delete this.pageparm.carNumbers},initPage:function(){this.pageparm={pageNo:1,pageSize:1e5,type:3}},getTS:function(){var e=this;Object(s.a)({url:c+"/source/selectallsourceinfo",method:"post",data:this.pageparm}).then(function(t){var a=t.data.data;a=a.map(function(t){return t.sourceCarNumberDto.sort(e.compare("carNumber")),t}),e.tableData=a,e.loading=!1}).catch(function(e){console.log(e)})},compare:function(e){return function(t,a){return t[e]-a[e]}},handleEdit:function(e,t){this.editFormVisible=!0,void 0!=t&&"undefined"!=t?(this.title="修改",this.editForm=t):(this.title="添加",this.editForm={})},changeResult:function(){this.editForm.result=""},handelSource:function(){var e=this;this.$refs.editForm.validate(function(t){if(!t)return console.log("提交失败"),!1;"添加"==e.title?Object(s.a)({url:c+"/source/insertsource",method:"post",data:w()({},e.editForm,{type:3})}).then(function(t){e.$message({message:e.title+"成功",type:"success"}),e.editFormVisible=!1,e.editForm={type:3},e.getTS()}).catch(function(t){console.log(t),e.$message({message:e.title+"失败",type:"error"}),e.editFormVisible=!1,e.editForm={type:3}}):Object(s.a)({url:c+"/source/updatesourceid",method:"post",data:e.editForm}).then(function(t){e.editFormVisible=!1,e.editForm={},e.$message.success("修改成功")}).catch(function(t){console.log(t),e.$message.error("请重新提交")})})},callFather:function(e){this.pageparm.pageNo=e.pageNo,this.pageparm.pageSize=e.pageSize},closeDialog:function(){this.editFormVisible=!1,this.editForm={}},handleCarNumbers:function(e){this.editForm=e,this.sid=e.sid,this.getCarNumbersBySid(e.sid),this.carNumbersVisible=!0},getCarNumbersBySid:function(e){var t=this;Object(s.a)({method:"post",url:c+"/source/selectallsourceinfo",data:w()({sid:e},this.pageparm)}).then(function(e){t.carNumbersBySid=e.data.data[0].sourceCarNumberDto,t.carNumbersInfoData=e.data.data[0].sourceCarNumberDto,t.carNumbersInfoData.sort(t.compare("carNumber")),console.log(t.carNumbersInfoData)}).catch(function(e){})},insertLongCarNumber:function(){var e=this;this.$confirm("是否提交该车号?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){if(e.selectSquareCarNumberList.length){for(var t=0;t<e.selectSquareCarNumberList.length;t++)Object(s.a)({url:c+"/source/insertsourcecarnumber",method:"post",data:{sid:e.sid,carNumber:e.selectSquareCarNumberList[t]}}).then(function(t){e.getTS(),e.getCarNumbersBySid(e.sid)}).catch(function(t){e.getTS(),e.editForm={},console.log(t),e.$message.error("请重新提交")});e.selectSquareCarNumberList=[]}else e.$message.warning("请选择车号")}).then(function(){e.updateNumber(e.sid)}).catch(function(){e.$message({type:"info",message:"已取消提交"})})},handleCarNumberForm:function(){var e=this;this.inputValue&&this.$confirm("是否提交该车号?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var t=e.inputValue;t&&(e.selectedCarNumbers.push(t),Object(s.a)({url:c+"/source/insertsourcecarnumber",method:"post",data:{sid:e.sid,carNumber:e.inputValue}}).then(function(t){e.getTS(),e.getCarNumbersBySid(e.sid),e.inputVisible=!1,e.$message.success("提交成功")}).catch(function(t){e.getTS(),e.editForm={},console.log(t),e.$message.error("请重新提交")})),e.inputValue=""}).catch(function(){e.$message({type:"info",message:"已取消提交"})})},handleClose:function(){this.carNumberComplForm={},this.carNumberComplTimeVisible=!1},handleSelectedCarNumbers:function(){this.carNumbersVisible=!1},handleCloseNumbers:function(e,t){var a=this;console.log(e),this.$confirm("此操作将永久删除, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:c+"/source/deletesourcecarnumbersid",method:"post",params:{cid:e}}).then(function(e){a.$message({message:"删除成功",type:"success"}),a.getTS()}).catch(function(e){console.log(e)})}).catch(function(){a.$message({type:"info",message:"已取消删除"})})},deleteCarNumber:function(e,t){var a=this;this.$confirm("此操作将永久删除, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:c+"/source/deletesourcecarnumbersid",method:"post",params:{cid:e}}).then(function(e){a.$message({message:"删除成功",type:"success"}),a.getCarNumbersBySid(a.sid)}).then(function(){var e=a.editForm.total;e-=1,console.log(e);var l=void 0,r=void 0,o=void 0,i=void 0,n=a.toRemoveSpacing(t.complTime);"null"==n.toLowerCase()||""==n||"N/A"==n||"未完成"==n?o=0!=e&0==(l=a.editForm.incomplTotal-1)?1:0:e==(r=a.editForm.complTotal-1)?(o=1,console.log(o)):(o=0,console.log(o)),console.log(t),console.log(e,l,r),i=w()({},a.editForm,{total:e,incomplTotal:l,complTotal:r,state:o}),"null"==n.toLowerCase()||""==n||"N/A"==n||"未完成"==n?(i=w()({},a.editForm,{total:e,incomplTotal:l,state:o}),console.log(i)):(i=w()({},a.editForm,{total:e,complTotal:r,state:o}),console.log(i)),Object(s.a)({url:c+"/source/updatesourceid",method:"post",data:w()({sid:a.sid},i)}).then(function(e){a.initPage(),a.getTS(),a.getCarNumbersBySid(a.sid)}).then(function(){Object(s.a)({method:"post",url:c+"/source/selectallsourceinfo",data:{sid:a.sid}}).then(function(e){a.editForm=e.data.data[0],console.log(a.editForm),a.initPage(),a.getTS(),a.getCarNumbersBySid(a.sid)})})})}).catch(function(){a.$message({type:"info",message:"已取消删除"})})},deleteCarNumbersInfo:function(e){this.deleteCarNumbersInfoVisible=!0,this.getCarNumbersBySid(e.sid),this.sid=e.sid,this.editForm=e},handleInputConfirm:function(e){var t=this;this.$confirm("是否提交该车号?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var a=t.inputValue;a&&(t.selectedCarNumbers.push(a),Object(s.a)({url:c+"/source/insertsourcecarnumber",method:"post",data:{sid:e.sid,carNumber:t.inputValue}}).then(function(e){t.inputVisible=!1,t.$message.success("提交成功")}).catch(function(e){console.log(e),t.$message.error("请重新提交")})),t.inputValue=""}).catch(function(){t.$message({type:"info",message:"已取消提交"})})},showInput:function(){var e=this;this.inputVisible=!0,this.$nextTick(function(t){e.$refs.saveTagInput.$refs.input.focus()})},editCarNumber:function(e,t){this.carNumberComplForm=e,this.sid=t.sid},handleComplTime:function(){var e=this;this.carNumberComplTimeVisible=!1,Object(s.a)({url:c+"/source/updatesourcecarnumber",method:"post",data:this.carNumberComplForm}).then(function(t){e.getTS()}).then(function(){})},exportSourceExcel:function(){var e=c+"/source/exportsource?";for(var t in this.pageparm)this.pageparm[t]&&(e+=t+"="+this.pageparm[t]+"&");s.a.get(e).then(function(t){window.location.href=e})},exportSourceFinalExcel:function(){var e=c+"/source/exportsourcefinaltechnologysquare?";for(var t in this.pageparm||0==this.pageparm[t])this.pageparm[t]&&(e+=t+"="+this.pageparm[t]+"&");s.a.get(e).then(function(t){window.location.href=e})},handleSourceExceed:function(e,t){this.$message.warning("当前限制选择文件个数，本次选择了 "+e.length+" 个文件，共选择了 "+(e.length+t.length)+" 个文件")},handleSourceSuccess:function(){this.getTS(),this.$message.success("导入成功")},handleError:function(){this.getFault(),this.$message.error("导入格式错误，请修改后重新导入！")},handleCarNumbersInfo:function(e){this.carNumbersInfoVisible=!0,this.getCarNumbersBySid(e.sid),this.sid=e.sid,this.editForm=e},enditComplTime:function(){this.ComplTimeVisible=!1},editComplTime:function(e){var t=this;Object(s.a)({url:c+"/source/updatesourcecarnumber",method:"post",data:{cid:e.cid,complTime:e.complTime}}).then(function(e){t.search(),t.$message.success("提交成功")}).then(function(){t.updateNumber(t.sid)})},deleteSourceInfoBySID:function(e){var t=this;this.$confirm("此操作将永久删除, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:c+"/source/deletesourceinfosid",method:"post",params:{sid:e}}).then(function(e){t.$message.success("删除成功"),t.getTS()}).catch(function(e){t.$message.error("删除失败")})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},toRemoveSpacing:function(e){if("string"==typeof e)var t=e.replace(/[\t\r\f\n\s]*/g,"");return t},updateNumber:function(e){var t=this;Object(s.a)({method:"post",url:c+"/source/selectallsourceinfo",data:{sid:e}}).then(function(e){console.log(e.data.data[0].sourceCarNumberDto);var a=e.data.data[0].sourceCarNumberDto,l=e.data.data[0].sourceCarNumberDto.length;t.updateTotal=l,console.log("total",l);for(var r=0,o=0,i=0;i<l;i++){var n=t.toRemoveSpacing(a[i].complTime);"null"==n.toLowerCase()||""==n||"N/A"==n||"未完成"==n?r+=1:o+=1}console.log("incoml",r),t.updateIncompl=r,t.updateCompl=o}).then(function(){delete t.editForm.total,delete t.editForm.complTotal,delete t.editForm.incompl;var a=void 0;a=0==t.updateIncompl&0!=t.updateTotal?1:0,Object(s.a)({url:c+"/source/updatesourceid",method:"post",data:w()({sid:e},t.editForm,{total:t.updateTotal,incomplTotal:t.updateIncompl,complTotal:t.updateCompl,state:a})}).then(function(e){t.editFormVisible=!1,t.search(),t.getCarNumbersBySid(t.sid)}).catch(function(e){console.log(e)})})},changeDimension:function(e,t){var a=this;this.$confirm("是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:" "+c+"/source/changedimension",params:{sid:e,dimension:t}}).then(function(e){a.$message.success("成功"),a.search()}).catch(function(e){a.$message.error("失败")})}).catch(function(){a.$message({type:"info",message:"已取消"})})},rowStyle:function(e){if(1==e.row.dimension)return{background:"antiquewhite"}},rowCarStyle:function(e){if(1==e.row.concern)return{background:"antiquewhite"}},changeCarConcern:function(e,t){var a=this;this.$confirm("是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:" "+c+"/source/changeconcern",params:{cid:e,concern:t}}).then(function(e){a.$message.success("标注成功"),a.getTS(),a.getCarNumbersBySid(a.sid),a.search()}).catch(function(e){a.getTS(),a.getCarNumbersBySid(a.sid),a.$message.error("标注失败")})}).catch(function(){a.$message({type:"info",message:"已取消"})})},closeCarNumbersInfoVisible:function(){this.carNumbersInfoVisible=!1,this.carNumbersInfoData=[]}}},Ae={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:6}},[a("div",{staticClass:"grid-content bg-purple"},[a("el-button",{attrs:{size:"small",type:"warning",icon:"el-icon-star-on"},on:{click:function(t){return e.exportSourceFinalExcel()}}},[e._v("导出")])],1)])],1),e._v(" "),a("el-form",{ref:"searchForm",staticClass:"user-search",attrs:{inline:!0,model:e.pageparm}},[a("el-form-item",{attrs:{label:"标注",prop:"dimension"}},[a("el-select",{attrs:{placeholder:"请选择"},on:{change:function(t){return e.changeInput(t)}},model:{value:e.pageparm.dimension,callback:function(t){e.$set(e.pageparm,"dimension",t)},expression:"pageparm.dimension"}},[a("el-option",{attrs:{label:"非重点关注",value:"0"}}),e._v(" "),a("el-option",{attrs:{label:"重点关注",value:"1"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"文号",prop:"motorDocumentNumber"}},[a("el-input",{attrs:{placeholder:"输入文号"},on:{input:function(t){return e.changeInput(t)}},model:{value:e.pageparm.motorDocumentNumber,callback:function(t){e.$set(e.pageparm,"motorDocumentNumber",t)},expression:"pageparm.motorDocumentNumber"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"项目名称",prop:"entryName"}},[a("el-input",{attrs:{placeholder:"输入项目名称"},on:{input:function(t){return e.changeInput(t)}},model:{value:e.pageparm.entryName,callback:function(t){e.$set(e.pageparm,"entryName",t)},expression:"pageparm.entryName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"项目完成情况",prop:"state"}},[a("el-select",{attrs:{placeholder:"请选择项目完成情况"},on:{change:function(t){return e.changeInput(t)}},model:{value:e.pageparm.state,callback:function(t){e.$set(e.pageparm,"state",t)},expression:"pageparm.state"}},[a("el-option",{attrs:{label:"已完成",value:1}}),e._v(" "),a("el-option",{attrs:{label:"未完成",value:0}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"车号",prop:"carNumber"}},[a("el-select",{attrs:{multiple:"",filterable:"",placeholder:"请选择车号"},on:{change:function(t){return e.changeInput(t)}},model:{value:e.carNumbers,callback:function(t){e.carNumbers=t},expression:"carNumbers"}},e._l(e.squareCarNumberList,function(e){return a("el-option",{key:e.value,attrs:{label:e.value,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"车号完成情况",prop:"complTime"}},[a("el-select",{attrs:{placeholder:"请选择车号完成情况"},on:{change:function(t){return e.changeInput(t)}},model:{value:e.pageparm.complTime,callback:function(t){e.$set(e.pageparm,"complTime",t)},expression:"pageparm.complTime"}},[a("el-option",{attrs:{label:"已完成",value:"已完成"}}),e._v(" "),a("el-option",{attrs:{label:"未完成",value:"未完成"}})],1)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-search"},on:{click:function(t){return e.search()}}},[e._v("搜索")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-refresh-right"},on:{click:function(t){return e.resetForm("searchForm")}}},[e._v("重置")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-plus"},on:{click:function(t){return e.handleEdit()}}},[e._v("添加")])],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"",height:"650","row-style":e.rowStyle}},[a("el-table-column",{attrs:{type:"index",label:"序号",align:"center",width:"70",index:e.indexMethod,fixed:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"motorDocumentNumber",label:"文号",width:"120",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"entryName",label:"项目名称",width:"200",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"total",label:"总数",align:"center",width:"70"}}),e._v(" "),a("el-table-column",{attrs:{prop:"complTotal",label:"已完成",width:"70",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"incomplTotal",label:"未完成",width:"70",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"carNumbers",label:"车号",align:"center",width:"280"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.sourceCarNumberDto,function(t){return a("div",{key:t.cid,staticStyle:{display:"inline-block"}},["未完成"==t.complTime&0==t.concern?a("el-tag",{attrs:{type:"info"}},[e._v(e._s(t.carNumber))]):"未完成"!=t.complTime&0==t.concern?a("el-tag",{attrs:{type:"success"}},[e._v(e._s(t.carNumber))]):a("el-tag",{attrs:{type:"warning"}},[e._v(e._s(t.carNumber))])],1)})}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"note",label:"备注",align:"center",width:"220"}}),e._v(" "),a("el-table-column",{attrs:{prop:"",label:"操作",width:"180",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("el-button",{attrs:{type:"primary",icon:"el-icon-circle-plus",circle:""},on:{click:function(a){return e.handleCarNumbersInfo(t.row)}}}),e._v(" "),a("el-button",{attrs:{type:"danger",icon:"el-icon-remove",circle:""},on:{click:function(a){return e.deleteCarNumbersInfo(t.row)}}})],1),e._v(" "),a("div",{staticStyle:{"margin-top":"10px"}},[a("el-button",{attrs:{type:"primary",icon:"el-icon-edit",circle:""},on:{click:function(a){return e.handleEdit(t.$index,t.row)}}}),e._v(" "),a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(a){return e.deleteSourceInfoBySID(t.row.sid)}}})],1),e._v(" "),a("div",{staticStyle:{"margin-top":"10px"}},[1==t.row.dimension?a("el-button",{attrs:{type:"warning",icon:"el-icon-warning",circle:""},on:{click:function(a){return e.changeDimension(t.row.sid,0)}}}):a("el-button",{attrs:{icon:"el-icon-warning-outline",circle:""},on:{click:function(a){return e.changeDimension(t.row.sid,1)}}})],1)]}}])})],1),e._v(" "),a("el-dialog",{attrs:{title:e.title,visible:e.editFormVisible,width:"50%"},on:{"update:visible":function(t){e.editFormVisible=t},click:function(t){return e.closeDialog("editForm")}}},[a("el-form",{ref:"editForm",attrs:{"label-width":"120px",model:e.editForm}},[a("el-form-item",{attrs:{label:"文号",prop:"motorDocumentNumber"}},[a("el-input",{attrs:{min:1,label:"",placeholder:"请输入文号"},model:{value:e.editForm.motorDocumentNumber,callback:function(t){e.$set(e.editForm,"motorDocumentNumber",t)},expression:"editForm.motorDocumentNumber"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"项目名称",prop:"entryName"}},[a("el-input",{attrs:{type:"textarea","auto-complete":"off",placeholder:"请输入项目名称"},model:{value:e.editForm.entryName,callback:function(t){e.$set(e.editForm,"entryName",t)},expression:"editForm.entryName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"总量",prop:"total"}},[a("el-input-number",{attrs:{min:0,max:1e4,"auto-complete":"off",placeholder:"请输入总量"},model:{value:e.editForm.total,callback:function(t){e.$set(e.editForm,"total",t)},expression:"editForm.total"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"已完成",prop:"complTotal"}},[a("el-input-number",{attrs:{min:0,max:1e4,"auto-complete":"off",placeholder:"请输入已完成"},model:{value:e.editForm.complTotal,callback:function(t){e.$set(e.editForm,"complTotal",t)},expression:"editForm.complTotal"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"未完成",prop:"incomplTotal"}},[a("el-input-number",{attrs:{min:0,max:1e4,"auto-complete":"off",placeholder:"请输入未完成"},model:{value:e.editForm.incomplTotal,callback:function(t){e.$set(e.editForm,"incomplTotal",t)},expression:"editForm.incomplTotal"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"备注",prop:"node"}},[a("el-input",{attrs:{type:"textarea","auto-complete":"off",placeholder:"备注"},model:{value:e.editForm.note,callback:function(t){e.$set(e.editForm,"note",t)},expression:"editForm.note"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){return e.closeDialog("editForm")}}},[e._v("取消")]),e._v(" "),a("el-button",{staticClass:"title",attrs:{size:"small",type:"primary"},on:{click:function(t){return e.handelSource("editForm")}}},[e._v("保存")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"查看车号",visible:e.carNumbersInfoVisible,width:"50%","before-close":e.closeCarNumbersInfoVisible},on:{"update:visible":function(t){e.carNumbersInfoVisible=t}}},[a("div",[a("el-form",{ref:"searchForm",staticClass:"user-search",attrs:{inline:!0,model:e.pageparmcar}},[a("el-form-item",{attrs:{label:"",prop:""}},[a("el-select",{attrs:{multiple:"",placeholder:"请选择车号"},model:{value:e.selectSquareCarNumberList,callback:function(t){e.selectSquareCarNumberList=t},expression:"selectSquareCarNumberList"}},e._l(e.squareCarNumberList,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-search"},on:{click:function(t){return e.insertLongCarNumber()}}},[e._v("添加")])],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.carNumbersInfoData,border:"",height:"500","row-style":e.rowCarStyle}},[a("el-table-column",{attrs:{type:"index",label:"序号",align:"center",width:"70",index:e.indexMethod,fixed:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"carNumber",label:"车号",width:"180",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"complTime",label:"完成时间",width:"240",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{ref:"saveTagInput",staticClass:"input-new-tag",attrs:{type:"textarea"},on:{blur:function(a){return e.editComplTime(t.row)}},model:{value:t.row.complTime,callback:function(a){e.$set(t.row,"complTime",a)},expression:"scope.row.complTime"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"",label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[1==t.row.concern?a("el-button",{attrs:{type:"warning",icon:"el-icon-warning",circle:""},on:{click:function(a){return e.changeCarConcern(t.row.cid,0)}}}):a("el-button",{attrs:{icon:"el-icon-warning-outline",circle:""},on:{click:function(a){return e.changeCarConcern(t.row.cid,1)}}})]}}])})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){return e.closeCarNumbersInfoVisible()}}},[e._v("取 消")])],1)]),e._v(" "),a("el-dialog",{attrs:{title:"删除车号",visible:e.deleteCarNumbersInfoVisible,width:"50%","before-close":function(){e.deleteCarNumbersInfoVisible=!1}},on:{"update:visible":function(t){e.deleteCarNumbersInfoVisible=t}}},[a("div",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.carNumbersInfoData,border:"",height:"500","row-style":e.rowCarStyle}},[a("el-table-column",{attrs:{type:"index",label:"序号",align:"center",width:"70",index:e.indexMethod,fixed:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"carNumber",label:"车号",width:"180",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"complTime",label:"完成时间",width:"240",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{ref:"saveTagInput",staticClass:"input-new-tag",attrs:{type:"textarea",disabled:""},on:{blur:function(a){return e.editComplTime(t.row)}},model:{value:t.row.complTime,callback:function(a){e.$set(t.row,"complTime",a)},expression:"scope.row.complTime"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"",label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(a){return e.deleteCarNumber(t.row.cid,t.row)}}})]}}])})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.deleteCarNumbersInfoVisible=!1}}},[e._v("取 消")])],1)])],1)},staticRenderFns:[]};var Pe=a("VU/8")(Ee,Ae,!1,function(e){a("4dvx")},"data-v-5b2ef108",null).exports,Ue={name:"techlong",data:function(){var e;return e={baseURL:c,longCarNumberList:qe,carNumberList:S,classCarNumbers:R,selectLongCarNumberList:[],sid:0,carNumbers:[],tableData:[],loading:!1,pageparm:{type:4,pageNo:1,pageSize:1e5},pageparmcar:{},editFormVisible:!1,title:"编辑",editForm:{type:4},total:0},x()(e,"loading",!1),x()(e,"carNumbersVisible",!1),x()(e,"props",{multiple:!0}),x()(e,"selectedCarNumbers",[]),x()(e,"inputVisible",!1),x()(e,"inputValue",""),x()(e,"carNumberComplTimeVisible",!1),x()(e,"carNumberComplForm",{}),x()(e,"carNumbersBySid",[]),x()(e,"carNumbersInfoVisible",!1),x()(e,"carNumbersInfoData",[]),x()(e,"ComplTimeVisible",!0),x()(e,"updateTotal",0),x()(e,"updateIncompl",0),x()(e,"updateCompl",0),x()(e,"deleteCarNumbersInfoVisible",!1),e},computed:{indexMethod:function(){return(this.pageparm.pageNo-1)*this.pageparm.pageSize+1}},created:function(){this.getTL()},methods:{changeInput:function(e){this.$forceUpdate()},search:function(){var e=this;this.carNumbers.length&&(this.pageparm.carNumbers=this.carNumbers),this.loading=!0,Object(s.a)({method:"post",url:c+"/source/selectallsourceinfo",data:this.pageparm}).then(function(t){var a=t.data.data;a=a.map(function(t){return t.sourceCarNumberDto.sort(e.compare("carNumber")),t}),e.tableData=a,e.loading=!1,e.$message.success("搜索成功")}).catch(function(t){e.initPage(),e.$message.error("搜索失败"),console.log(t)})},resetForm:function(e){this.$refs[e].resetFields(),this.carNumbers=[],this.pageparm.carNumbers&&delete this.pageparm.carNumbers},initPage:function(){this.pageparm={pageNo:1,pageSize:1e5,type:4}},getTL:function(){var e=this;Object(s.a)({url:c+"/source/selectallsourceinfo",method:"post",data:this.pageparm}).then(function(t){var a=t.data.data;a=a.map(function(t){return t.sourceCarNumberDto.sort(e.compare("carNumber")),t}),e.tableData=a,e.loading=!1}).catch(function(e){console.log(e)})},compare:function(e){return function(t,a){return t[e]-a[e]}},handleEdit:function(e,t){this.editFormVisible=!0,void 0!=t&&"undefined"!=t?(this.title="修改",this.editForm=t):(this.title="添加",this.editForm={})},changeResult:function(){this.editForm.result=""},handelSource:function(){var e=this;this.$refs.editForm.validate(function(t){if(!t)return console.log("提交失败"),!1;"添加"==e.title?Object(s.a)({url:c+"/source/insertsource",method:"post",data:w()({},e.editForm,{type:4})}).then(function(t){e.$message({message:e.title+"成功",type:"success"}),e.editFormVisible=!1,e.editForm={type:4},e.getTL()}).catch(function(t){console.log(t),e.$message({message:e.title+"失败",type:"error"}),e.editFormVisible=!1,e.editForm={type:4}}):Object(s.a)({url:c+"/source/updatesourceid",method:"post",data:e.editForm}).then(function(t){e.editFormVisible=!1,e.editForm={},e.$message.success("修改成功")}).catch(function(t){console.log(t),e.$message.error("请重新提交")})})},closeDialog:function(){this.editFormVisible=!1,this.editForm={}},handleCarNumbers:function(e){this.editForm=e,this.sid=e.sid,this.getCarNumbersBySid(e.sid),this.carNumbersVisible=!0},getCarNumbersBySid:function(e){var t=this;Object(s.a)({method:"post",url:c+"/source/selectallsourceinfo",data:w()({sid:e},this.pageparm)}).then(function(e){t.carNumbersBySid=e.data.data[0].sourceCarNumberDto,t.carNumbersInfoData=e.data.data[0].sourceCarNumberDto,console.log(t.carNumbersInfoData),t.carNumbersInfoData.sort(t.compare("carNumber")),console.log(t.carNumbersInfoData)}).catch(function(e){})},insertLongCarNumber:function(){var e=this;this.$confirm("是否提交该车号?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){if(e.selectLongCarNumberList.length){for(var t=0;t<e.selectLongCarNumberList.length;t++)Object(s.a)({url:c+"/source/insertsourcecarnumber",method:"post",data:{sid:e.sid,carNumber:e.selectLongCarNumberList[t]}}).then(function(t){e.getTL(),e.getCarNumbersBySid(e.sid)}).catch(function(t){e.getTL(),e.getCarNumbersBySid(e.sid),console.log(t),e.$message.error("请重新提交")});e.selectLongCarNumberList=[]}else e.$message.warning("请选择车号")}).then(function(){e.updateNumber(e.sid)}).catch(function(){e.$message({type:"info",message:"已取消提交"})})},toRemoveSpacing:function(e){if("string"==typeof e)var t=e.replace(/[\t\r\f\n\s]*/g,"");return t},updateNumber:function(e){var t=this;Object(s.a)({method:"post",url:c+"/source/selectallsourceinfo",data:{sid:e}}).then(function(e){var a=e.data.data[0].sourceCarNumberDto;console.log(e.data.data[0].sourceCarNumberDto);var l=a.length;console.log(l),t.updateTotal=l,console.log("total",l);for(var r=0,o=0,i=0;i<l;i++){var n=t.toRemoveSpacing(a[i].complTime);"null"==n.toLowerCase()||""==n||"N/A"==n||"未完成"==n?r+=1:o+=1}console.log("incoml",r),t.updateIncompl=r,t.updateCompl=o}).then(function(){var a=void 0;a=0==t.updateIncompl&0!=t.updateTotal?1:0,Object(s.a)({url:c+"/source/updatesourceid",method:"post",data:w()({sid:e},t.editForm,{total:t.updateTotal,incomplTotal:t.updateIncompl,complTotal:t.updateCompl,state:a})}).then(function(e){t.editFormVisible=!1,t.search(),t.getCarNumbersBySid(t.sid)}).catch(function(e){console.log(e)})})},handleCarNumberForm:function(){var e=this;this.inputValue&&this.$confirm("是否提交该车号?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var t=e.inputValue;t&&(e.selectedCarNumbers.push(t),Object(s.a)({url:c+"/source/insertsourcecarnumber",method:"post",data:{sid:e.sid,carNumber:e.inputValue}}).then(function(t){e.getTL(),e.getCarNumbersBySid(e.sid),e.inputVisible=!1,e.$message.success("提交成功")}).catch(function(t){e.getTL(),e.editForm={},console.log(t),e.$message.error("请重新提交")})),e.inputValue=""}).catch(function(){e.$message({type:"info",message:"已取消提交"})})},handleClose:function(e){this.carNumberComplForm={},this.carNumberComplTimeVisible=!1},handleSelectedCarNumbers:function(){this.carNumbersVisible=!1},handleCloseNumbers:function(e,t){var a=this;this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:c+"/source/deletesourcecarnumbersid",method:"post",params:{cid:e}}).then(function(e){a.$message({message:"删除成功",type:"success"}),a.getTL()}).catch(function(e){console.log(e)})}).catch(function(){a.$message({type:"info",message:"已取消删除"})})},deleteCarNumber:function(e,t){var a=this;this.$confirm("此操作将永久删除, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:c+"/source/deletesourcecarnumbersid",method:"post",params:{cid:e}}).then(function(e){a.$message({message:"删除成功",type:"success"}),a.getCarNumbersBySid(a.sid)}).then(function(){var e=a.editForm.total;e-=1,console.log(e);var l=void 0,r=void 0,o=void 0,i=void 0,n=a.toRemoveSpacing(t.complTime);"null"==n.toLowerCase()||""==n||"N/A"==n||"未完成"==n?o=0!=e&0==(l=a.editForm.incomplTotal-1)?1:0:e==(r=a.editForm.complTotal-1)?(o=1,console.log(o)):(o=0,console.log(o)),console.log(t),console.log(e,l,r),i=w()({},a.editForm,{total:e,incomplTotal:l,complTotal:r,state:o}),"null"==n.toLowerCase()||""==n||"N/A"==n||"未完成"==n?(i=w()({},a.editForm,{total:e,incomplTotal:l,state:o}),console.log(i)):(i=w()({},a.editForm,{total:e,complTotal:r,state:o}),console.log(i)),Object(s.a)({url:c+"/source/updatesourceid",method:"post",data:w()({sid:a.sid},i)}).then(function(e){a.initPage(),a.getTL(),a.getCarNumbersBySid(a.sid)}).then(function(){Object(s.a)({method:"post",url:c+"/source/selectallsourceinfo",data:{sid:a.sid}}).then(function(e){a.editForm=e.data.data[0],a.initPage(),a.getTL(),a.getCarNumbersBySid(a.sid)})})})}).catch(function(){a.$message({type:"info",message:"已取消删除"})})},handleInputConfirm:function(e){var t=this;this.$confirm("是否提交该车号?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var a=t.inputValue;a&&(t.selectedCarNumbers.push(a),Object(s.a)({url:c+"/source/insertsourcecarnumber",method:"post",data:{sid:e.sid,carNumber:t.inputValue}}).then(function(e){t.inputVisible=!1,t.$message.success("提交成功")}).catch(function(e){console.log(e),t.$message.error("请重新提交")})),t.inputValue=""}).catch(function(){t.$message({type:"info",message:"已取消提交"})})},showInput:function(){var e=this;this.inputVisible=!0,this.$nextTick(function(t){e.$refs.saveTagInput.$refs.input.focus()})},editCarNumber:function(e,t){this.editForm=t,console.log(e,t),this.carNumberComplForm=e,this.sid=t.sid},handleComplTime:function(){var e=this;this.carNumberComplTimeVisible=!1,Object(s.a)({url:c+"/source/updatesourcecarnumber",method:"post",data:this.carNumberComplForm}).then(function(t){e.getTL()})},exportSourceExcel:function(){var e=c+"/source/exportsource?";for(var t in this.pageparm)this.pageparm[t]&&(e+=t+"="+this.pageparm[t]+"&");s.a.get(e).then(function(t){console.log(e),window.location.href=e})},exportSourceFinalExcel:function(){var e=c+"/source/exportsourcefinaltechnologylong?";for(var t in this.pageparm||0==this.pageparm[t])this.pageparm[t]&&(e+=t+"="+this.pageparm[t]+"&");s.a.get(e).then(function(t){console.log(e),window.location.href=e})},handleSourceExceed:function(e,t){this.$message.warning("当前限制选择文件个数，本次选择了 "+e.length+" 个文件，共选择了 "+(e.length+t.length)+" 个文件")},handleSourceSuccess:function(){this.getTL(),this.$message.success("导入成功")},handleError:function(){this.$message.error("导入格式错误，请修改后重新导入！")},handleCarNumbersInfo:function(e){this.carNumbersInfoVisible=!0,this.getCarNumbersBySid(e.sid),this.sid=e.sid,this.editForm=e},deleteCarNumbersInfo:function(e){this.deleteCarNumbersInfoVisible=!0,this.getCarNumbersBySid(e.sid),this.sid=e.sid,this.editForm=e},enditComplTime:function(){this.ComplTimeVisible=!1},editComplTime:function(e){var t=this;Object(s.a)({url:c+"/source/updatesourcecarnumber",method:"post",data:{cid:e.cid,complTime:e.complTime}}).then(function(e){t.getTL(),t.$message.success("提交成功")}).then(function(){t.updateNumber(t.sid)})},deleteSourceInfoBySID:function(e){var t=this;this.$confirm("此操作将永久删除, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:c+"/source/deletesourceinfosid",method:"post",params:{sid:e}}).then(function(e){t.$message.success("删除成功"),t.getTL()}).catch(function(e){t.$message.error("删除失败")})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},changeDimension:function(e,t){var a=this;this.$confirm("是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:" "+c+"/source/changedimension",params:{sid:e,dimension:t}}).then(function(e){a.$message.success("成功"),a.search()}).catch(function(e){a.$message.error("失败")})}).catch(function(){a.$message({type:"info",message:"已取消"})})},rowStyle:function(e){if(1==e.row.dimension)return{background:"antiquewhite"}},rowCarStyle:function(e){if(1==e.row.concern)return{background:"antiquewhite"}},changeCarConcern:function(e,t){var a=this;this.$confirm("是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:" "+c+"/source/changeconcern",params:{cid:e,concern:t}}).then(function(e){a.$message.success("标注成功"),a.getTL(),a.getCarNumbersBySid(a.sid),a.search()}).catch(function(e){a.getTL(),a.getCarNumbersBySid(a.sid),a.search(),a.$message.error("标注失败")})}).catch(function(){a.$message({type:"info",message:"已取消"})})},closeCarNumbersInfoVisible:function(){this.carNumbersInfoVisible=!1,this.carNumbersInfoData=[]}}},He={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:6}},[a("div",{staticClass:"grid-content bg-purple"},[a("el-button",{attrs:{size:"small",type:"warning",icon:"el-icon-star-on"},on:{click:function(t){return e.exportSourceFinalExcel()}}},[e._v("导出")])],1)])],1),e._v(" "),a("el-form",{ref:"searchForm",staticClass:"user-search",attrs:{inline:!0,model:e.pageparm}},[a("el-form-item",{attrs:{label:"标注",prop:"dimension"}},[a("el-select",{attrs:{placeholder:"请选择"},on:{change:function(t){return e.changeInput(t)}},model:{value:e.pageparm.dimension,callback:function(t){e.$set(e.pageparm,"dimension",t)},expression:"pageparm.dimension"}},[a("el-option",{attrs:{label:"非重点关注",value:"0"}}),e._v(" "),a("el-option",{attrs:{label:"重点关注",value:"1"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"文号",prop:"motorDocumentNumber"}},[a("el-input",{attrs:{placeholder:"输入文号"},on:{input:function(t){return e.changeInput(t)}},model:{value:e.pageparm.motorDocumentNumber,callback:function(t){e.$set(e.pageparm,"motorDocumentNumber",t)},expression:"pageparm.motorDocumentNumber"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"项目名称",prop:"entryName"}},[a("el-input",{attrs:{placeholder:"输入项目名称"},on:{input:function(t){return e.changeInput(t)}},model:{value:e.pageparm.entryName,callback:function(t){e.$set(e.pageparm,"entryName",t)},expression:"pageparm.entryName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"项目完成情况",prop:"state"}},[a("el-select",{attrs:{placeholder:"请选择项目完成情况"},on:{change:function(t){return e.changeInput(t)}},model:{value:e.pageparm.state,callback:function(t){e.$set(e.pageparm,"state",t)},expression:"pageparm.state"}},[a("el-option",{attrs:{label:"已完成",value:1}}),e._v(" "),a("el-option",{attrs:{label:"未完成",value:0}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"车号",prop:"carNumber"}},[a("el-select",{attrs:{multiple:"",filterable:"",placeholder:"请选择车号"},on:{change:function(t){return e.changeInput(t)}},model:{value:e.carNumbers,callback:function(t){e.carNumbers=t},expression:"carNumbers"}},e._l(e.longCarNumberList,function(e){return a("el-option",{key:e.value,attrs:{label:e.value,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"车号完成情况",prop:"complTime"}},[a("el-select",{attrs:{placeholder:"请选择车号完成情况"},on:{change:function(t){return e.changeInput(t)}},model:{value:e.pageparm.complTime,callback:function(t){e.$set(e.pageparm,"complTime",t)},expression:"pageparm.complTime"}},[a("el-option",{attrs:{label:"已完成",value:"已完成"}}),e._v(" "),a("el-option",{attrs:{label:"未完成",value:"未完成"}})],1)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-search"},on:{click:function(t){return e.search()}}},[e._v("搜索")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-refresh-right"},on:{click:function(t){return e.resetForm("searchForm")}}},[e._v("重置")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-plus"},on:{click:function(t){return e.handleEdit()}}},[e._v("添加")])],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"",height:"650","row-style":e.rowStyle}},[a("el-table-column",{attrs:{type:"index",label:"序号",align:"center",width:"70",index:e.indexMethod,fixed:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"motorDocumentNumber",label:"文号",width:"120",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"entryName",label:"项目名称",width:"200",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"total",label:"总数",align:"center",width:"70"}}),e._v(" "),a("el-table-column",{attrs:{prop:"complTotal",label:"已完成",width:"70",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"incomplTotal",label:"未完成",width:"70",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"carNumbers",label:"车号",align:"center",width:"280"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.sourceCarNumberDto,function(t){return a("div",{key:t.cid,staticStyle:{display:"inline-block"}},["未完成"==t.complTime&0==t.concern?a("el-tag",{attrs:{type:"info"}},[e._v(e._s(t.carNumber))]):"未完成"!=t.complTime&0==t.concern?a("el-tag",{attrs:{type:"success"}},[e._v(e._s(t.carNumber))]):a("el-tag",{attrs:{type:"warning"}},[e._v(e._s(t.carNumber))])],1)})}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"note",label:"备注",align:"center",width:"220"}}),e._v(" "),a("el-table-column",{attrs:{prop:"",label:"操作",width:"180",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("el-button",{attrs:{type:"primary",icon:"el-icon-circle-plus",circle:""},on:{click:function(a){return e.handleCarNumbersInfo(t.row)}}}),e._v(" "),a("el-button",{attrs:{type:"danger",icon:"el-icon-remove",circle:""},on:{click:function(a){return e.deleteCarNumbersInfo(t.row)}}})],1),e._v(" "),a("div",{staticStyle:{"margin-top":"10px"}},[a("el-button",{attrs:{type:"primary",icon:"el-icon-edit",circle:""},on:{click:function(a){return e.handleEdit(t.$index,t.row)}}}),e._v(" "),a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(a){return e.deleteSourceInfoBySID(t.row.sid)}}})],1),e._v(" "),a("div",{staticStyle:{"margin-top":"10px"}},[1==t.row.dimension?a("el-button",{attrs:{type:"warning",icon:"el-icon-warning",circle:""},on:{click:function(a){return e.changeDimension(t.row.sid,0)}}}):a("el-button",{attrs:{icon:"el-icon-warning-outline",circle:""},on:{click:function(a){return e.changeDimension(t.row.sid,1)}}})],1)]}}])})],1),e._v(" "),a("el-dialog",{attrs:{title:e.title,visible:e.editFormVisible,width:"50%"},on:{"update:visible":function(t){e.editFormVisible=t},click:function(t){return e.closeDialog("editForm")}}},[a("el-form",{ref:"editForm",attrs:{"label-width":"120px",model:e.editForm}},[a("el-form-item",{attrs:{label:"文号",prop:"motorDocumentNumber"}},[a("el-input",{attrs:{label:"",placeholder:"请输入文号"},model:{value:e.editForm.motorDocumentNumber,callback:function(t){e.$set(e.editForm,"motorDocumentNumber",t)},expression:"editForm.motorDocumentNumber"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"项目名称",prop:"entryName"}},[a("el-input",{attrs:{type:"textarea","auto-complete":"off",placeholder:"请输入项目名称"},model:{value:e.editForm.entryName,callback:function(t){e.$set(e.editForm,"entryName",t)},expression:"editForm.entryName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"总量",prop:"total"}},[a("el-input-number",{attrs:{"auto-complete":"off",placeholder:"请输入总量"},model:{value:e.editForm.total,callback:function(t){e.$set(e.editForm,"total",t)},expression:"editForm.total"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"已完成",prop:"complTotal"}},[a("el-input-number",{attrs:{"auto-complete":"off",placeholder:"请输入已完成"},model:{value:e.editForm.complTotal,callback:function(t){e.$set(e.editForm,"complTotal",t)},expression:"editForm.complTotal"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"未完成",prop:"incomplTotal"}},[a("el-input-number",{attrs:{"auto-complete":"off",placeholder:"请输入未完成"},model:{value:e.editForm.incomplTotal,callback:function(t){e.$set(e.editForm,"incomplTotal",t)},expression:"editForm.incomplTotal"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"备注",prop:"node"}},[a("el-input",{attrs:{type:"textarea","auto-complete":"off",placeholder:"备注"},model:{value:e.editForm.note,callback:function(t){e.$set(e.editForm,"note",t)},expression:"editForm.note"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){return e.closeDialog("editForm")}}},[e._v("取消")]),e._v(" "),a("el-button",{staticClass:"title",attrs:{size:"small",type:"primary"},on:{click:function(t){return e.handelSource("editForm")}}},[e._v("保存")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"查看车号",visible:e.carNumbersInfoVisible,width:"50%","before-close":e.closeCarNumbersInfoVisible},on:{"update:visible":function(t){e.carNumbersInfoVisible=t}}},[a("div",[a("el-form",{ref:"searchForm",staticClass:"user-search",attrs:{inline:!0,model:e.pageparmcar}},[a("el-form-item",{attrs:{label:"",prop:""}},[a("el-select",{attrs:{multiple:"",placeholder:"请选择车号"},model:{value:e.selectLongCarNumberList,callback:function(t){e.selectLongCarNumberList=t},expression:"selectLongCarNumberList"}},e._l(e.longCarNumberList,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-search"},on:{click:function(t){return e.insertLongCarNumber()}}},[e._v("添加")])],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.carNumbersInfoData,border:"",height:"500","row-style":e.rowCarStyle}},[a("el-table-column",{attrs:{type:"index",label:"序号",align:"center",width:"70",index:e.indexMethod,fixed:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"carNumber",label:"车号",width:"180",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"complTime",label:"完成时间",width:"240",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{ref:"saveTagInput",staticClass:"input-new-tag",attrs:{type:"textarea"},on:{blur:function(a){return e.editComplTime(t.row)}},model:{value:t.row.complTime,callback:function(a){e.$set(t.row,"complTime",a)},expression:"scope.row.complTime"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"",label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[1==t.row.concern?a("el-button",{attrs:{type:"warning",icon:"el-icon-warning",circle:""},on:{click:function(a){return e.changeCarConcern(t.row.cid,0)}}}):a("el-button",{attrs:{icon:"el-icon-warning-outline",circle:""},on:{click:function(a){return e.changeCarConcern(t.row.cid,1)}}})]}}])})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){return e.closeCarNumbersInfoVisible()}}},[e._v("取 消")])],1)]),e._v(" "),a("el-dialog",{attrs:{title:"删除车号",visible:e.deleteCarNumbersInfoVisible,width:"50%","before-close":function(){e.deleteCarNumbersInfoVisible=!1}},on:{"update:visible":function(t){e.deleteCarNumbersInfoVisible=t}}},[a("div",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.carNumbersInfoData,border:"",height:"500","row-style":e.rowCarStyle}},[a("el-table-column",{attrs:{type:"index",label:"序号",align:"center",width:"70",index:e.indexMethod,fixed:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"carNumber",label:"车号",width:"180",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"complTime",label:"完成时间",width:"240",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{ref:"saveTagInput",staticClass:"input-new-tag",attrs:{type:"textarea",disabled:""},model:{value:t.row.complTime,callback:function(a){e.$set(t.row,"complTime",a)},expression:"scope.row.complTime"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"",label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(a){return e.deleteCarNumber(t.row.cid,t.row)}}})]}}])})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.deleteCarNumbersInfoVisible=!1}}},[e._v("取 消")])],1)])],1)},staticRenderFns:[]};var Ye=a("VU/8")(Ue,He,!1,function(e){a("5UNP")},"data-v-e6698974",null).exports,Qe={name:"qualityConcentra",inject:["reload"],data:function(){var e;return e={baseURL:c,carNumberList:S,longCarNumberList:qe,selectLongCarNumberList:[],classCarNumbers:R,sid:0,carNumbers:[],tableData:[],loading:!1,pageparm:{type:5,pageNo:1,pageSize:1e5},pageparmcar:{},editFormVisible:!1,title:"编辑",editForm:{type:5},total:0},x()(e,"loading",!1),x()(e,"carNumbersVisible",!1),x()(e,"props",{multiple:!0}),x()(e,"selectedCarNumbers",[]),x()(e,"inputVisible",!1),x()(e,"inputValue",""),x()(e,"carNumberComplTimeVisible",!1),x()(e,"carNumberComplForm",{}),x()(e,"carNumbersBySid",[]),x()(e,"carNumbersInfoVisible",!1),x()(e,"carNumbersInfoData",[]),x()(e,"ComplTimeVisible",!0),x()(e,"updateTotal",0),x()(e,"updateIncompl",0),x()(e,"updateCompl",0),x()(e,"deleteCarNumbersInfoVisible",!1),e},computed:{indexMethod:function(){return(this.pageparm.pageNo-1)*this.pageparm.pageSize+1}},created:function(){this.getQL()},methods:{changeInput:function(e){this.$forceUpdate()},search:function(){var e=this;this.carNumbers.length&&(this.pageparm.carNumbers=this.carNumbers),this.loading=!0,Object(s.a)({method:"post",url:c+"/source/selectallsourceinfo",data:this.pageparm}).then(function(t){var a=t.data.data;a=a.map(function(t){return t.sourceCarNumberDto.sort(e.compare("carNumber")),t}),e.tableData=a,e.loading=!1,e.$message.success("搜索成功")}).catch(function(t){e.initPage(),e.$message.error("搜索失败"),console.log(t)})},resetForm:function(e){this.$refs[e].resetFields(),this.carNumbers=[],this.pageparm.carNumbers&&delete this.pageparm.carNumbers},initPage:function(){this.pageparm={pageNo:1,pageSize:1e5,type:5}},getQL:function(){var e=this;Object(s.a)({url:c+"/source/selectallsourceinfo",method:"post",data:this.pageparm}).then(function(t){var a=t.data.data;a=a.map(function(t){return t.sourceCarNumberDto.sort(e.compare("carNumber")),t}),e.tableData=a,e.loading=!1}).catch(function(e){console.log(e)})},compare:function(e){return function(t,a){return t[e]-a[e]}},handleEdit:function(e,t){this.editFormVisible=!0,void 0!=t&&"undefined"!=t?(this.title="修改",this.editForm=t):(this.title="添加",this.editForm={})},changeResult:function(){this.editForm.result=""},handelSource:function(){var e=this;this.$refs.editForm.validate(function(t){if(!t)return console.log("提交失败"),!1;"添加"==e.title?Object(s.a)({url:c+"/source/insertsource",method:"post",data:w()({},e.editForm,{type:5})}).then(function(t){e.$message({message:e.title+"成功",type:"success"}),e.editFormVisible=!1,e.editForm={type:5},e.getQL()}).catch(function(t){console.log(t),e.$message({message:e.title+"失败",type:"error"}),e.editFormVisible=!1,e.editForm={type:5}}):Object(s.a)({url:c+"/source/updatesourceid",method:"post",data:e.editForm}).then(function(t){e.editFormVisible=!1,e.editForm={},e.$message.success("修改成功")}).catch(function(t){console.log(t),e.$message.error("请重新提交")})})},closeDialog:function(){this.editFormVisible=!1,this.editForm={}},handleCarNumbers:function(e){this.editForm=e,this.sid=e.sid,this.getCarNumbersBySid(e.sid),this.carNumbersVisible=!0},getCarNumbersBySid:function(e){var t=this;Object(s.a)({method:"post",url:c+"/source/selectallsourceinfo",data:w()({sid:e},this.pageparm)}).then(function(e){t.carNumbersBySid=e.data.data[0].sourceCarNumberDto,t.carNumbersInfoData=e.data.data[0].sourceCarNumberDto,t.carNumbersInfoData.sort(t.compare("carNumber"))}).catch(function(e){})},insertLongCarNumber:function(){var e=this;this.$confirm("是否提交该车号?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){if(e.selectLongCarNumberList.length){for(var t=0;t<e.selectLongCarNumberList.length;t++)Object(s.a)({url:c+"/source/insertsourcecarnumber",method:"post",data:{sid:e.sid,carNumber:e.selectLongCarNumberList[t]}}).then(function(t){e.getQL(),e.getCarNumbersBySid(e.sid)}).catch(function(t){e.getQL(),e.editForm={},console.log(t),e.$message.error("请重新提交")});e.selectLongCarNumberList=[]}else e.$message.warning("请选择车号")}).then(function(){e.updateNumber(e.sid)}).catch(function(){e.$message({type:"info",message:"已取消提交"})})},toRemoveSpacing:function(e){if("string"==typeof e)var t=e.replace(/[\t\r\f\n\s]*/g,"");return t},updateNumber:function(e){var t=this;Object(s.a)({method:"post",url:c+"/source/selectallsourceinfo",data:{sid:e}}).then(function(e){console.log(e.data.data[0].sourceCarNumberDto);var a=e.data.data[0].sourceCarNumberDto,l=e.data.data[0].sourceCarNumberDto.length;t.updateTotal=l,console.log("total",l);for(var r=0,o=0,i=0;i<l;i++){var n=t.toRemoveSpacing(a[i].complTime);"null"==n.toLowerCase()||""==n||"N/A"==n||"未完成"==n?r+=1:o+=1}console.log("incoml",r),t.updateIncompl=r,t.updateCompl=o}).then(function(){var a=void 0;a=0==t.updateIncompl&0!=t.updateTotal?1:0,Object(s.a)({url:c+"/source/updatesourceid",method:"post",data:w()({sid:e},t.editForm,{total:t.updateTotal,incomplTotal:t.updateIncompl,complTotal:t.updateCompl,state:a})}).then(function(e){t.editFormVisible=!1,t.search(),t.getCarNumbersBySid(t.sid)}).catch(function(e){console.log(e)})})},handleCarNumberForm:function(){var e=this;this.inputValue&&this.$confirm("是否提交该车号?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var t=e.inputValue;t&&(e.selectedCarNumbers.push(t),Object(s.a)({url:c+"/source/insertsourcecarnumber",method:"post",data:{sid:e.sid,carNumber:e.inputValue}}).then(function(t){e.getQL(),e.getCarNumbersBySid(e.sid),e.inputVisible=!1,e.$message.success("提交成功")}).catch(function(t){e.getQL(),e.editForm={},console.log(t),e.$message.error("请重新提交")})),e.inputValue=""}).catch(function(){e.$message({type:"info",message:"已取消提交"})})},deleteCarNumbersInfo:function(e){this.deleteCarNumbersInfoVisible=!0,this.getCarNumbersBySid(e.sid),this.sid=e.sid,this.editForm=e},handleClose:function(e){this.carNumberComplForm={},this.carNumberComplTimeVisible=!1},handleSelectedCarNumbers:function(){this.carNumbersVisible=!1},handleCloseNumbers:function(e,t){var a=this;this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:c+"/source/deletesourcecarnumbersid",method:"post",params:{cid:e}}).then(function(e){a.$message({message:"删除成功",type:"success"}),a.getQL()}).catch(function(e){console.log(e)})}).catch(function(){a.$message({type:"info",message:"已取消删除"})})},deleteCarNumber:function(e,t){var a=this;this.$confirm("此操作将永久删除, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:c+"/source/deletesourcecarnumbersid",method:"post",params:{cid:e}}).then(function(e){a.$message({message:"删除成功",type:"success"}),a.getCarNumbersBySid(a.sid)}).then(function(){var e=a.editForm.total;e-=1,console.log(e);var l=void 0,r=void 0,o=void 0,i=void 0,n=a.toRemoveSpacing(t.complTime);"null"==n.toLowerCase()||""==n||"N/A"==n||"未完成"==n?o=0!=e&0==(l=a.editForm.incomplTotal-1)?1:0:e==(r=a.editForm.complTotal-1)?(o=1,console.log(o)):(o=0,console.log(o)),console.log(t),console.log(e,l,r),i=w()({},a.editForm,{total:e,incomplTotal:l,complTotal:r,state:o}),"null"==n.toLowerCase()||""==n||"N/A"==n||"未完成"==n?(i=w()({},a.editForm,{total:e,incomplTotal:l,state:o}),console.log(i)):(i=w()({},a.editForm,{total:e,complTotal:r,state:o}),console.log(i)),Object(s.a)({url:c+"/source/updatesourceid",method:"post",data:w()({sid:a.sid},i)}).then(function(e){a.initPage(),a.getQL(),a.getCarNumbersBySid(a.sid)}).then(function(){Object(s.a)({method:"post",url:c+"/source/selectallsourceinfo",data:{sid:a.sid}}).then(function(e){a.editForm=e.data.data[0],console.log(a.editForm),a.initPage(),a.getQL(),a.getCarNumbersBySid(a.sid)})})})}).catch(function(){a.$message({type:"info",message:"已取消删除"})})},handleInputConfirm:function(e){var t=this;this.$confirm("是否提交该车号?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var a=t.inputValue;a&&(t.selectedCarNumbers.push(a),Object(s.a)({url:c+"/source/insertsourcecarnumber",method:"post",data:{sid:e.sid,carNumber:t.inputValue}}).then(function(e){t.inputVisible=!1,t.$message.success("提交成功")}).catch(function(e){console.log(e),t.$message.error("请重新提交")})),t.inputValue=""}).catch(function(){t.$message({type:"info",message:"已取消提交"})})},showInput:function(){var e=this;this.inputVisible=!0,this.$nextTick(function(t){e.$refs.saveTagInput.$refs.input.focus()})},editCarNumber:function(e,t){this.carNumberComplForm=e},handleComplTime:function(){var e=this;this.carNumberComplTimeVisible=!1,Object(s.a)({url:c+"/source/updatesourcecarnumber",method:"post",data:this.carNumberComplForm}).then(function(t){e.getQL()}).catch(function(e){})},exportSourceExcel:function(){var e=c+"/source/exportsource?";for(var t in this.pageparm)this.pageparm[t]&&(e+=t+"="+this.pageparm[t]+"&");s.a.get(e).then(function(t){console.log(e),window.location.href=e})},exportSourceFinalExcel:function(){var e=c+"/source/exportsourcefinalqualityconcentra?";for(var t in this.pageparm)(this.pageparm[t]||0==this.pageparm[t])&&(e+=t+"="+this.pageparm[t]+"&");s.a.get(e).then(function(t){window.location.href=e})},handleSourceExceed:function(e,t){this.$message.warning("当前限制选择文件个数，本次选择了 "+e.length+" 个文件，共选择了 "+(e.length+t.length)+" 个文件")},handleSourceSuccess:function(){this.getQL(),this.$message.success("导入成功")},handleError:function(){this.$message.error("导入格式错误，请修改后重新导入！")},handleCarNumbersInfo:function(e){this.carNumbersInfoVisible=!0,this.getCarNumbersBySid(e.sid),this.sid=e.sid,this.editForm=e},enditComplTime:function(){this.ComplTimeVisible=!1},editComplTime:function(e){var t=this;Object(s.a)({url:c+"/source/updatesourcecarnumber",method:"post",data:{cid:e.cid,complTime:e.complTime}}).then(function(e){t.$message.success("提交成功")}).then(function(){t.updateNumber(t.sid)})},deleteSourceInfoBySID:function(e){var t=this;this.$confirm("此操作将永久删除, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:c+"/source/deletesourceinfosid",method:"post",params:{sid:e}}).then(function(e){t.$message.success("删除成功"),t.getQL()}).catch(function(e){t.$message.error("删除失败")})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},changeDimension:function(e,t){var a=this;this.$confirm("是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:" "+c+"/source/changedimension",params:{sid:e,dimension:t}}).then(function(e){a.$message.success("成功"),a.search()}).catch(function(e){a.$message.error("失败")})}).catch(function(){a.$message({type:"info",message:"已取消"})})},rowStyle:function(e){if(1==e.row.dimension)return{background:"antiquewhite"}},rowCarStyle:function(e){if(1==e.row.concern)return{background:"antiquewhite"}},changeCarConcern:function(e,t){var a=this;this.$confirm("是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:" "+c+"/source/changeconcern",params:{cid:e,concern:t}}).then(function(e){a.$message.success("标注成功"),a.getQL(),a.getCarNumbersBySid(a.sid),a.search()}).catch(function(e){a.getQL(),a.getCarNumbersBySid(a.sid),a.$message.error("标注失败")})}).catch(function(){a.$message({type:"info",message:"已取消"})})},closeCarNumbersInfoVisible:function(){this.carNumbersInfoVisible=!1,this.carNumbersInfoData=[]}}},Ge={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:6}},[a("div",{staticClass:"grid-content bg-purple"},[a("el-button",{attrs:{size:"small",type:"warning",icon:"el-icon-star-on"},on:{click:function(t){return e.exportSourceFinalExcel()}}},[e._v("导出")])],1)])],1),e._v(" "),a("el-form",{ref:"searchForm",staticClass:"user-search",attrs:{inline:!0,model:e.pageparm}},[a("el-form-item",{attrs:{label:"标注",prop:"dimension"}},[a("el-select",{attrs:{placeholder:"请选择"},on:{change:function(t){return e.changeInput(t)}},model:{value:e.pageparm.dimension,callback:function(t){e.$set(e.pageparm,"dimension",t)},expression:"pageparm.dimension"}},[a("el-option",{attrs:{label:"非重点关注",value:"0"}}),e._v(" "),a("el-option",{attrs:{label:"重点关注",value:"1"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"批次",prop:"batch"}},[a("el-input",{attrs:{placeholder:"输入批次"},on:{input:function(t){return e.changeInput(t)}},model:{value:e.pageparm.batch,callback:function(t){e.$set(e.pageparm,"batch",t)},expression:"pageparm.batch"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"总公司文号",prop:"headDocumentNumber"}},[a("el-input",{attrs:{placeholder:"输入总公司文号"},on:{input:function(t){return e.changeInput(t)}},model:{value:e.pageparm.headDocumentNumber,callback:function(t){e.$set(e.pageparm,"headDocumentNumber",t)},expression:"pageparm.headDocumentNumber"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"路局文号",prop:"roadDocumentNumber"}},[a("el-input",{attrs:{placeholder:"输入路局文号"},on:{input:function(t){return e.changeInput(t)}},model:{value:e.pageparm.roadDocumentNumber,callback:function(t){e.$set(e.pageparm,"roadDocumentNumber",t)},expression:"pageparm.roadDocumentNumber"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"申请单编号",prop:"applicNumber"}},[a("el-input",{attrs:{placeholder:"输入申请单编号"},on:{input:function(t){return e.changeInput(t)}},model:{value:e.pageparm.applicNumber,callback:function(t){e.$set(e.pageparm,"applicNumber",t)},expression:"pageparm.applicNumber"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"项目名称",prop:"entryName"}},[a("el-input",{attrs:{placeholder:"输入项目名称"},on:{input:function(t){return e.changeInput(t)}},model:{value:e.pageparm.entryName,callback:function(t){e.$set(e.pageparm,"entryName",t)},expression:"pageparm.entryName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"项目完成情况",prop:"state"}},[a("el-select",{attrs:{placeholder:"请选择项目完成情况"},on:{change:function(t){return e.changeInput(t)}},model:{value:e.pageparm.state,callback:function(t){e.$set(e.pageparm,"state",t)},expression:"pageparm.state"}},[a("el-option",{attrs:{label:"已完成",value:1}}),e._v(" "),a("el-option",{attrs:{label:"未完成",value:0}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"车号",prop:"carNumber"}},[a("el-select",{attrs:{multiple:"",filterable:"",placeholder:"请选择车号"},on:{change:function(t){return e.changeInput(t)}},model:{value:e.carNumbers,callback:function(t){e.carNumbers=t},expression:"carNumbers"}},[a("el-option",{attrs:{label:"2048",value:2048}}),e._v(" "),a("el-option",{attrs:{label:"2049",value:2049}}),e._v(" "),a("el-option",{attrs:{label:"2050",value:2050}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"车号完成情况",prop:"complTime"}},[a("el-select",{attrs:{placeholder:"请选择车号完成情况"},on:{change:function(t){return e.changeInput(t)}},model:{value:e.pageparm.complTime,callback:function(t){e.$set(e.pageparm,"complTime",t)},expression:"pageparm.complTime"}},[a("el-option",{attrs:{label:"已完成",value:"已完成"}}),e._v(" "),a("el-option",{attrs:{label:"未完成",value:"未完成"}})],1)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-search"},on:{click:function(t){return e.search()}}},[e._v("搜索")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-refresh-right"},on:{click:function(t){return e.resetForm("searchForm")}}},[e._v("重置")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-plus"},on:{click:function(t){return e.handleEdit()}}},[e._v("添加")])],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"",height:"650","row-style":e.rowStyle}},[a("el-table-column",{attrs:{type:"index",label:"序号",align:"center",width:"70",index:e.indexMethod,fixed:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"batch",label:"批次",width:"80",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"headDocumentNumber",label:"总公司文号",width:"120",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"roadDocumentNumber",label:"路局文号",width:"120",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"applicNumber",label:"申请单编号",width:"120",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"entryName",label:"项目名称",width:"200",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"total",label:"总数",align:"center",width:"70"}}),e._v(" "),a("el-table-column",{attrs:{prop:"complTotal",label:"已完成",width:"70",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"incomplTotal",label:"未完成",width:"70",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"carNumbers",label:"车号",align:"center",width:"280"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.sourceCarNumberDto,function(t){return a("div",{key:t.cid,staticStyle:{display:"inline-block"}},["未完成"==t.complTime&0==t.concern?a("el-tag",{attrs:{type:"info"}},[e._v(e._s(t.carNumber))]):"未完成"!=t.complTime&0==t.concern?a("el-tag",{attrs:{type:"success"}},[e._v(e._s(t.carNumber))]):a("el-tag",{attrs:{type:"warning"}},[e._v(e._s(t.carNumber))])],1)})}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"note",label:"备注",align:"center",width:"220"}}),e._v(" "),a("el-table-column",{attrs:{prop:"",label:"操作",width:"180",align:"center",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("el-button",{attrs:{type:"primary",icon:"el-icon-circle-plus",circle:""},on:{click:function(a){return e.handleCarNumbersInfo(t.row)}}}),e._v(" "),a("el-button",{attrs:{type:"danger",icon:"el-icon-remove",circle:""},on:{click:function(a){return e.deleteCarNumbersInfo(t.row)}}})],1),e._v(" "),a("div",{staticStyle:{"margin-top":"10px"}},[a("el-button",{attrs:{type:"primary",icon:"el-icon-edit",circle:""},on:{click:function(a){return e.handleEdit(t.$index,t.row)}}}),e._v(" "),a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(a){return e.deleteSourceInfoBySID(t.row.sid)}}})],1),e._v(" "),a("div",{staticStyle:{"margin-top":"10px"}},[1==t.row.dimension?a("el-button",{attrs:{type:"warning",icon:"el-icon-warning",circle:""},on:{click:function(a){return e.changeDimension(t.row.sid,0)}}}):a("el-button",{attrs:{icon:"el-icon-warning-outline",circle:""},on:{click:function(a){return e.changeDimension(t.row.sid,1)}}})],1)]}}])})],1),e._v(" "),a("el-dialog",{attrs:{title:e.title,visible:e.editFormVisible,width:"50%"},on:{"update:visible":function(t){e.editFormVisible=t},click:function(t){return e.closeDialog("editForm")}}},[a("el-form",{ref:"editForm",attrs:{"label-width":"120px",model:e.editForm}},[a("el-form-item",{attrs:{label:"批次",prop:"batch"}},[a("el-input",{attrs:{"auto-complete":"off",placeholder:"请输入批次"},model:{value:e.editForm.batch,callback:function(t){e.$set(e.editForm,"batch",t)},expression:"editForm.batch"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"总公司文号",prop:"headDocumentNumber"}},[a("el-input",{attrs:{min:1,label:"",placeholder:"请输入总公司文号"},model:{value:e.editForm.headDocumentNumber,callback:function(t){e.$set(e.editForm,"headDocumentNumber",t)},expression:"editForm.headDocumentNumber"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"路局文号",prop:"roadDocumentNumber"}},[a("el-input",{attrs:{label:"",placeholder:"请输入路局文号"},model:{value:e.editForm.roadDocumentNumber,callback:function(t){e.$set(e.editForm,"roadDocumentNumber",t)},expression:"editForm.roadDocumentNumber"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"申请单编号",prop:"applicNumber"}},[a("el-input",{attrs:{"auto-complete":"off",placeholder:"请输入申请单编号"},model:{value:e.editForm.applicNumber,callback:function(t){e.$set(e.editForm,"applicNumber",t)},expression:"editForm.applicNumber"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"项目名称",prop:"entryName"}},[a("el-input",{attrs:{type:"textarea","auto-complete":"off",placeholder:"请输入项目名称"},model:{value:e.editForm.entryName,callback:function(t){e.$set(e.editForm,"entryName",t)},expression:"editForm.entryName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"总数",prop:"total"}},[a("el-input-number",{attrs:{min:0,max:1e3,"auto-complete":"off",placeholder:"请输入总量"},model:{value:e.editForm.total,callback:function(t){e.$set(e.editForm,"total",t)},expression:"editForm.total"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"已完成",prop:"complTotal"}},[a("el-input-number",{attrs:{min:0,max:1e3,"auto-complete":"off",placeholder:"请输入已完成"},model:{value:e.editForm.complTotal,callback:function(t){e.$set(e.editForm,"complTotal",t)},expression:"editForm.complTotal"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"未完成",prop:"incomplTotal"}},[a("el-input-number",{attrs:{min:0,max:1e3,"auto-complete":"off",placeholder:"请输入未完成"},model:{value:e.editForm.incomplTotal,callback:function(t){e.$set(e.editForm,"incomplTotal",t)},expression:"editForm.incomplTotal"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"备注",prop:"node"}},[a("el-input",{attrs:{type:"textarea","auto-complete":"off",placeholder:"备注"},model:{value:e.editForm.note,callback:function(t){e.$set(e.editForm,"note",t)},expression:"editForm.note"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){return e.closeDialog("editForm")}}},[e._v("取消")]),e._v(" "),a("el-button",{staticClass:"title",attrs:{size:"small",type:"primary"},on:{click:function(t){return e.handelSource("editForm")}}},[e._v("保存")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"查看车号",visible:e.carNumbersInfoVisible,width:"50%","before-close":e.closeCarNumbersInfoVisible},on:{"update:visible":function(t){e.carNumbersInfoVisible=t}}},[a("div",[a("el-form",{ref:"searchForm",staticClass:"user-search",attrs:{inline:!0,model:e.pageparmcar}},[a("el-form-item",{attrs:{label:"",prop:""}},[a("el-select",{attrs:{multiple:"",placeholder:"请选择车号"},model:{value:e.selectLongCarNumberList,callback:function(t){e.selectLongCarNumberList=t},expression:"selectLongCarNumberList"}},[a("el-option",{attrs:{label:"2048",value:2048}}),e._v(" "),a("el-option",{attrs:{label:"2049",value:2049}}),e._v(" "),a("el-option",{attrs:{label:"2050",value:2050}})],1)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-search"},on:{click:function(t){return e.insertLongCarNumber()}}},[e._v("添加")])],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.carNumbersInfoData,border:"",height:"500","row-style":e.rowCarStyle}},[a("el-table-column",{attrs:{type:"index",label:"序号",align:"center",width:"70",index:e.indexMethod,fixed:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"carNumber",label:"车号",width:"180",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"complTime",label:"完成时间",width:"240",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{ref:"saveTagInput",staticClass:"input-new-tag",attrs:{type:"textarea"},on:{blur:function(a){return e.editComplTime(t.row)}},model:{value:t.row.complTime,callback:function(a){e.$set(t.row,"complTime",a)},expression:"scope.row.complTime"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"",label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[1==t.row.concern?a("el-button",{attrs:{type:"warning",icon:"el-icon-warning",circle:""},on:{click:function(a){return e.changeCarConcern(t.row.cid,0)}}}):a("el-button",{attrs:{icon:"el-icon-warning-outline",circle:""},on:{click:function(a){return e.changeCarConcern(t.row.cid,1)}}})]}}])})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.closeCarNumbersInfoVisible}},[e._v("取 消")])],1)]),e._v(" "),a("el-dialog",{attrs:{title:"删除车号",visible:e.deleteCarNumbersInfoVisible,width:"50%","before-close":function(){e.deleteCarNumbersInfoVisible=!1}},on:{"update:visible":function(t){e.deleteCarNumbersInfoVisible=t}}},[a("div",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.carNumbersInfoData,border:"",height:"500","row-style":e.rowCarStyle}},[a("el-table-column",{attrs:{type:"index",label:"序号",align:"center",width:"70",index:e.indexMethod,fixed:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"carNumber",label:"车号",width:"180",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"complTime",label:"完成时间",width:"240",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{ref:"saveTagInput",staticClass:"input-new-tag",attrs:{type:"textarea",disabled:""},on:{blur:function(a){return e.editComplTime(t.row)}},model:{value:t.row.complTime,callback:function(a){e.$set(t.row,"complTime",a)},expression:"scope.row.complTime"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"",label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(a){return e.deleteCarNumber(t.row.cid,t.row)}}})]}}])})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.deleteCarNumbersInfoVisible=!1}}},[e._v("取 消")])],1)])],1)},staticRenderFns:[]};var We=a("VU/8")(Qe,Ge,!1,function(e){a("TwP2")},"data-v-dd759d3c",null).exports,Ke={name:"techlong",data:function(){var e;return e={baseURL:c,longCarNumberList:qe,carNumberList:S,classCarNumbers:R,selectLongCarNumberList:[],sid:0,carNumbers:[],tableData:[],loading:!1,pageparm:{type:6,pageNo:1,pageSize:1e5},pageparmcar:{},editFormVisible:!1,title:"编辑",editForm:{type:6},total:0},x()(e,"loading",!1),x()(e,"carNumbersVisible",!1),x()(e,"props",{multiple:!0}),x()(e,"selectedCarNumbers",[]),x()(e,"inputVisible",!1),x()(e,"inputValue",""),x()(e,"carNumberComplTimeVisible",!1),x()(e,"carNumberComplForm",{}),x()(e,"carNumbersBySid",[]),x()(e,"carNumbersInfoVisible",!1),x()(e,"carNumbersInfoData",[]),x()(e,"ComplTimeVisible",!0),x()(e,"updateTotal",0),x()(e,"updateIncompl",0),x()(e,"updateCompl",0),x()(e,"deleteCarNumbersInfoVisible",!1),e},computed:{indexMethod:function(){return(this.pageparm.pageNo-1)*this.pageparm.pageSize+1}},created:function(){this.getTL()},methods:{changeInput:function(e){this.$forceUpdate()},search:function(){var e=this;this.carNumbers.length&&(this.pageparm.carNumbers=this.carNumbers),this.loading=!0,Object(s.a)({method:"post",url:c+"/source/selectallsourceinfo",data:this.pageparm}).then(function(t){var a=t.data.data;a=a.map(function(t){return t.sourceCarNumberDto.sort(e.compare("carNumber")),t}),e.tableData=a,e.loading=!1,e.$message.success("搜索成功")}).catch(function(t){e.initPage(),e.$message.error("搜索失败"),console.log(t)})},resetForm:function(e){this.$refs[e].resetFields(),this.carNumbers=[],this.pageparm.carNumbers&&delete this.pageparm.carNumbers},initPage:function(){this.pageparm={pageNo:1,pageSize:1e5,type:6}},getTL:function(){var e=this;Object(s.a)({url:c+"/source/selectallsourceinfo",method:"post",data:this.pageparm}).then(function(t){var a=t.data.data;a=a.map(function(t){return t.sourceCarNumberDto.sort(e.compare("carNumber")),t}),e.tableData=a,e.loading=!1}).catch(function(e){console.log(e)})},compare:function(e){return function(t,a){return t[e]-a[e]}},handleEdit:function(e,t){this.editFormVisible=!0,void 0!=t&&"undefined"!=t?(this.title="修改",this.editForm=t):(this.title="添加",this.editForm={})},changeResult:function(){this.editForm.result=""},handelSource:function(){var e=this;this.$refs.editForm.validate(function(t){if(!t)return console.log("提交失败"),!1;"添加"==e.title?Object(s.a)({url:c+"/source/insertsource",method:"post",data:w()({},e.editForm,{type:6})}).then(function(t){e.$message({message:e.title+"成功",type:"success"}),e.editFormVisible=!1,e.editForm={type:6},e.getTL()}).catch(function(t){console.log(t),e.$message({message:e.title+"失败",type:"error"}),e.editFormVisible=!1,e.editForm={type:6}}):Object(s.a)({url:c+"/source/updatesourceid",method:"post",data:e.editForm}).then(function(t){e.editFormVisible=!1,e.editForm={},e.$message.success("修改成功")}).catch(function(t){console.log(t),e.$message.error("请重新提交")})})},closeDialog:function(){this.editFormVisible=!1,this.editForm={}},handleCarNumbers:function(e){this.editForm=e,this.sid=e.sid,this.getCarNumbersBySid(e.sid),this.carNumbersVisible=!0},getCarNumbersBySid:function(e){var t=this;Object(s.a)({method:"post",url:c+"/source/selectallsourceinfo",data:w()({sid:e},this.pageparm)}).then(function(e){t.carNumbersBySid=e.data.data[0].sourceCarNumberDto,t.carNumbersInfoData=e.data.data[0].sourceCarNumberDto,console.log(t.carNumbersInfoData),t.carNumbersInfoData.sort(t.compare("carNumber")),console.log(t.carNumbersInfoData)}).catch(function(e){})},insertLongCarNumber:function(){var e=this;this.$confirm("是否提交该车号?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){if(e.selectLongCarNumberList.length){for(var t=0;t<e.selectLongCarNumberList.length;t++)Object(s.a)({url:c+"/source/insertsourcecarnumber",method:"post",data:{sid:e.sid,carNumber:e.selectLongCarNumberList[t]}}).then(function(t){e.getTL(),e.getCarNumbersBySid(e.sid)}).catch(function(t){e.getTL(),e.getCarNumbersBySid(e.sid),console.log(t),e.$message.error("请重新提交")});e.selectLongCarNumberList=[]}else e.$message.warning("请选择车号")}).then(function(){e.updateNumber(e.sid)}).catch(function(){e.$message({type:"info",message:"已取消提交"})})},toRemoveSpacing:function(e){if("string"==typeof e)var t=e.replace(/[\t\r\f\n\s]*/g,"");return t},updateNumber:function(e){var t=this;Object(s.a)({method:"post",url:c+"/source/selectallsourceinfo",data:{sid:e}}).then(function(e){var a=e.data.data[0].sourceCarNumberDto;console.log(e.data.data[0].sourceCarNumberDto);var l=a.length;console.log(l),t.updateTotal=l,console.log("total",l);for(var r=0,o=0,i=0;i<l;i++){var n=t.toRemoveSpacing(a[i].complTime);"null"==n.toLowerCase()||""==n||"N/A"==n||"未完成"==n?r+=1:o+=1}console.log("incoml",r),t.updateIncompl=r,t.updateCompl=o}).then(function(){var a=void 0;a=0==t.updateIncompl&0!=t.updateTotal?1:0,Object(s.a)({url:c+"/source/updatesourceid",method:"post",data:w()({sid:e},t.editForm,{total:t.updateTotal,incomplTotal:t.updateIncompl,complTotal:t.updateCompl,state:a})}).then(function(e){t.editFormVisible=!1,t.search(),t.getCarNumbersBySid(t.sid)}).catch(function(e){console.log(e)})})},handleCarNumberForm:function(){var e=this;this.inputValue&&this.$confirm("是否提交该车号?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var t=e.inputValue;t&&(e.selectedCarNumbers.push(t),Object(s.a)({url:c+"/source/insertsourcecarnumber",method:"post",data:{sid:e.sid,carNumber:e.inputValue}}).then(function(t){e.getTL(),e.getCarNumbersBySid(e.sid),e.inputVisible=!1,e.$message.success("提交成功")}).catch(function(t){e.getTL(),e.editForm={},console.log(t),e.$message.error("请重新提交")})),e.inputValue=""}).catch(function(){e.$message({type:"info",message:"已取消提交"})})},handleClose:function(e){this.carNumberComplForm={},this.carNumberComplTimeVisible=!1},handleSelectedCarNumbers:function(){this.carNumbersVisible=!1},handleCloseNumbers:function(e,t){var a=this;this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:c+"/source/deletesourcecarnumbersid",method:"post",params:{cid:e}}).then(function(e){a.$message({message:"删除成功",type:"success"}),a.getTL()}).catch(function(e){console.log(e)})}).catch(function(){a.$message({type:"info",message:"已取消删除"})})},deleteCarNumber:function(e,t){var a=this;this.$confirm("此操作将永久删除, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:c+"/source/deletesourcecarnumbersid",method:"post",params:{cid:e}}).then(function(e){a.$message({message:"删除成功",type:"success"}),a.getCarNumbersBySid(a.sid)}).then(function(){var e=a.editForm.total;e-=1,console.log(e);var l=void 0,r=void 0,o=void 0,i=void 0,n=a.toRemoveSpacing(t.complTime);"null"==n.toLowerCase()||""==n||"N/A"==n||"未完成"==n?o=0!=e&0==(l=a.editForm.incomplTotal-1)?1:0:e==(r=a.editForm.complTotal-1)?(o=1,console.log(o)):(o=0,console.log(o)),console.log(t),console.log(e,l,r),i=w()({},a.editForm,{total:e,incomplTotal:l,complTotal:r,state:o}),"null"==n.toLowerCase()||""==n||"N/A"==n||"未完成"==n?(i=w()({},a.editForm,{total:e,incomplTotal:l,state:o}),console.log(i)):(i=w()({},a.editForm,{total:e,complTotal:r,state:o}),console.log(i)),Object(s.a)({url:c+"/source/updatesourceid",method:"post",data:w()({sid:a.sid},i)}).then(function(e){a.initPage(),a.getTL(),a.getCarNumbersBySid(a.sid)}).then(function(){Object(s.a)({method:"post",url:c+"/source/selectallsourceinfo",data:{sid:a.sid}}).then(function(e){a.editForm=e.data.data[0],a.initPage(),a.getTL(),a.getCarNumbersBySid(a.sid)})})})}).catch(function(){a.$message({type:"info",message:"已取消删除"})})},handleInputConfirm:function(e){var t=this;this.$confirm("是否提交该车号?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var a=t.inputValue;a&&(t.selectedCarNumbers.push(a),Object(s.a)({url:c+"/source/insertsourcecarnumber",method:"post",data:{sid:e.sid,carNumber:t.inputValue}}).then(function(e){t.inputVisible=!1,t.$message.success("提交成功")}).catch(function(e){console.log(e),t.$message.error("请重新提交")})),t.inputValue=""}).catch(function(){t.$message({type:"info",message:"已取消提交"})})},showInput:function(){var e=this;this.inputVisible=!0,this.$nextTick(function(t){e.$refs.saveTagInput.$refs.input.focus()})},editCarNumber:function(e,t){this.editForm=t,console.log(e,t),this.carNumberComplForm=e,this.sid=t.sid},handleComplTime:function(){var e=this;this.carNumberComplTimeVisible=!1,Object(s.a)({url:c+"/source/updatesourcecarnumber",method:"post",data:this.carNumberComplForm}).then(function(t){e.getTL()})},exportSourceExcel:function(){var e=c+"/source/exportsource?";for(var t in this.pageparm)this.pageparm[t]&&(e+=t+"="+this.pageparm[t]+"&");s.a.get(e).then(function(t){console.log(e),window.location.href=e})},exportSourceFinalExcel:function(){var e=c+"/source/exportsourcefinaltechnologyconcentra?";for(var t in this.pageparm||0==this.pageparm[t])this.pageparm[t]&&(e+=t+"="+this.pageparm[t]+"&");s.a.get(e).then(function(t){console.log(e),window.location.href=e})},handleSourceExceed:function(e,t){this.$message.warning("当前限制选择文件个数，本次选择了 "+e.length+" 个文件，共选择了 "+(e.length+t.length)+" 个文件")},handleSourceSuccess:function(){this.getTL(),this.$message.success("导入成功")},handleError:function(){this.$message.error("导入格式错误，请修改后重新导入！")},handleCarNumbersInfo:function(e){this.carNumbersInfoVisible=!0,this.getCarNumbersBySid(e.sid),this.sid=e.sid,this.editForm=e},deleteCarNumbersInfo:function(e){this.deleteCarNumbersInfoVisible=!0,this.getCarNumbersBySid(e.sid),this.sid=e.sid,this.editForm=e},enditComplTime:function(){this.ComplTimeVisible=!1},editComplTime:function(e){var t=this;Object(s.a)({url:c+"/source/updatesourcecarnumber",method:"post",data:{cid:e.cid,complTime:e.complTime}}).then(function(e){t.getTL(),t.$message.success("提交成功")}).then(function(){t.updateNumber(t.sid)})},deleteSourceInfoBySID:function(e){var t=this;this.$confirm("此操作将永久删除, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:c+"/source/deletesourceinfosid",method:"post",params:{sid:e}}).then(function(e){t.$message.success("删除成功"),t.getTL()}).catch(function(e){t.$message.error("删除失败")})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},changeDimension:function(e,t){var a=this;this.$confirm("是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:" "+c+"/source/changedimension",params:{sid:e,dimension:t}}).then(function(e){a.$message.success("成功"),a.search()}).catch(function(e){a.$message.error("失败")})}).catch(function(){a.$message({type:"info",message:"已取消"})})},rowStyle:function(e){if(1==e.row.dimension)return{background:"antiquewhite"}},rowCarStyle:function(e){if(1==e.row.concern)return{background:"antiquewhite"}},changeCarConcern:function(e,t){var a=this;this.$confirm("是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:" "+c+"/source/changeconcern",params:{cid:e,concern:t}}).then(function(e){a.$message.success("标注成功"),a.getTL(),a.getCarNumbersBySid(a.sid),a.search()}).catch(function(e){a.getTL(),a.getCarNumbersBySid(a.sid),a.search(),a.$message.error("标注失败")})}).catch(function(){a.$message({type:"info",message:"已取消"})})},closeCarNumbersInfoVisible:function(){this.carNumbersInfoVisible=!1,this.carNumbersInfoData=[]}}},Xe={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:6}},[a("div",{staticClass:"grid-content bg-purple"},[a("el-button",{attrs:{size:"small",type:"warning",icon:"el-icon-star-on"},on:{click:function(t){return e.exportSourceFinalExcel()}}},[e._v("导出")])],1)])],1),e._v(" "),a("el-form",{ref:"searchForm",staticClass:"user-search",attrs:{inline:!0,model:e.pageparm}},[a("el-form-item",{attrs:{label:"标注",prop:"dimension"}},[a("el-select",{attrs:{placeholder:"请选择"},on:{change:function(t){return e.changeInput(t)}},model:{value:e.pageparm.dimension,callback:function(t){e.$set(e.pageparm,"dimension",t)},expression:"pageparm.dimension"}},[a("el-option",{attrs:{label:"非重点关注",value:"0"}}),e._v(" "),a("el-option",{attrs:{label:"重点关注",value:"1"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"文号",prop:"motorDocumentNumber"}},[a("el-input",{attrs:{placeholder:"输入文号"},on:{input:function(t){return e.changeInput(t)}},model:{value:e.pageparm.motorDocumentNumber,callback:function(t){e.$set(e.pageparm,"motorDocumentNumber",t)},expression:"pageparm.motorDocumentNumber"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"项目名称",prop:"entryName"}},[a("el-input",{attrs:{placeholder:"输入项目名称"},on:{input:function(t){return e.changeInput(t)}},model:{value:e.pageparm.entryName,callback:function(t){e.$set(e.pageparm,"entryName",t)},expression:"pageparm.entryName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"项目完成情况",prop:"state"}},[a("el-select",{attrs:{placeholder:"请选择项目完成情况"},on:{change:function(t){return e.changeInput(t)}},model:{value:e.pageparm.state,callback:function(t){e.$set(e.pageparm,"state",t)},expression:"pageparm.state"}},[a("el-option",{attrs:{label:"已完成",value:1}}),e._v(" "),a("el-option",{attrs:{label:"未完成",value:0}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"车号",prop:"carNumber"}},[a("el-select",{attrs:{multiple:"",filterable:"",placeholder:"请选择车号"},on:{change:function(t){return e.changeInput(t)}},model:{value:e.carNumbers,callback:function(t){e.carNumbers=t},expression:"carNumbers"}},[a("el-option",{attrs:{label:"2048",value:2048}}),e._v(" "),a("el-option",{attrs:{label:"2049",value:2049}}),e._v(" "),a("el-option",{attrs:{label:"2050",value:2050}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"车号完成情况",prop:"complTime"}},[a("el-select",{attrs:{placeholder:"请选择车号完成情况"},on:{change:function(t){return e.changeInput(t)}},model:{value:e.pageparm.complTime,callback:function(t){e.$set(e.pageparm,"complTime",t)},expression:"pageparm.complTime"}},[a("el-option",{attrs:{label:"已完成",value:"已完成"}}),e._v(" "),a("el-option",{attrs:{label:"未完成",value:"未完成"}})],1)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-search"},on:{click:function(t){return e.search()}}},[e._v("搜索")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-refresh-right"},on:{click:function(t){return e.resetForm("searchForm")}}},[e._v("重置")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-plus"},on:{click:function(t){return e.handleEdit()}}},[e._v("添加")])],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"",height:"650","row-style":e.rowStyle}},[a("el-table-column",{attrs:{type:"index",label:"序号",align:"center",width:"70",index:e.indexMethod,fixed:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"motorDocumentNumber",label:"文号",width:"120",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"entryName",label:"项目名称",width:"200",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"total",label:"总数",align:"center",width:"70"}}),e._v(" "),a("el-table-column",{attrs:{prop:"complTotal",label:"已完成",width:"70",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"incomplTotal",label:"未完成",width:"70",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"carNumbers",label:"车号",align:"center",width:"280"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.sourceCarNumberDto,function(t){return a("div",{key:t.cid,staticStyle:{display:"inline-block"}},["未完成"==t.complTime&0==t.concern?a("el-tag",{attrs:{type:"info"}},[e._v(e._s(t.carNumber))]):"未完成"!=t.complTime&0==t.concern?a("el-tag",{attrs:{type:"success"}},[e._v(e._s(t.carNumber))]):a("el-tag",{attrs:{type:"warning"}},[e._v(e._s(t.carNumber))])],1)})}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"note",label:"备注",align:"center",width:"220"}}),e._v(" "),a("el-table-column",{attrs:{prop:"",label:"操作",width:"180",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("el-button",{attrs:{type:"primary",icon:"el-icon-circle-plus",circle:""},on:{click:function(a){return e.handleCarNumbersInfo(t.row)}}}),e._v(" "),a("el-button",{attrs:{type:"danger",icon:"el-icon-remove",circle:""},on:{click:function(a){return e.deleteCarNumbersInfo(t.row)}}})],1),e._v(" "),a("div",{staticStyle:{"margin-top":"10px"}},[a("el-button",{attrs:{type:"primary",icon:"el-icon-edit",circle:""},on:{click:function(a){return e.handleEdit(t.$index,t.row)}}}),e._v(" "),a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(a){return e.deleteSourceInfoBySID(t.row.sid)}}})],1),e._v(" "),a("div",{staticStyle:{"margin-top":"10px"}},[1==t.row.dimension?a("el-button",{attrs:{type:"warning",icon:"el-icon-warning",circle:""},on:{click:function(a){return e.changeDimension(t.row.sid,0)}}}):a("el-button",{attrs:{icon:"el-icon-warning-outline",circle:""},on:{click:function(a){return e.changeDimension(t.row.sid,1)}}})],1)]}}])})],1),e._v(" "),a("el-dialog",{attrs:{title:e.title,visible:e.editFormVisible,width:"50%"},on:{"update:visible":function(t){e.editFormVisible=t},click:function(t){return e.closeDialog("editForm")}}},[a("el-form",{ref:"editForm",attrs:{"label-width":"120px",model:e.editForm}},[a("el-form-item",{attrs:{label:"文号",prop:"motorDocumentNumber"}},[a("el-input",{attrs:{label:"",placeholder:"请输入文号"},model:{value:e.editForm.motorDocumentNumber,callback:function(t){e.$set(e.editForm,"motorDocumentNumber",t)},expression:"editForm.motorDocumentNumber"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"项目名称",prop:"entryName"}},[a("el-input",{attrs:{type:"textarea","auto-complete":"off",placeholder:"请输入项目名称"},model:{value:e.editForm.entryName,callback:function(t){e.$set(e.editForm,"entryName",t)},expression:"editForm.entryName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"总量",prop:"total"}},[a("el-input-number",{attrs:{"auto-complete":"off",placeholder:"请输入总量"},model:{value:e.editForm.total,callback:function(t){e.$set(e.editForm,"total",t)},expression:"editForm.total"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"已完成",prop:"complTotal"}},[a("el-input-number",{attrs:{"auto-complete":"off",placeholder:"请输入已完成"},model:{value:e.editForm.complTotal,callback:function(t){e.$set(e.editForm,"complTotal",t)},expression:"editForm.complTotal"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"未完成",prop:"incomplTotal"}},[a("el-input-number",{attrs:{"auto-complete":"off",placeholder:"请输入未完成"},model:{value:e.editForm.incomplTotal,callback:function(t){e.$set(e.editForm,"incomplTotal",t)},expression:"editForm.incomplTotal"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"备注",prop:"node"}},[a("el-input",{attrs:{type:"textarea","auto-complete":"off",placeholder:"备注"},model:{value:e.editForm.note,callback:function(t){e.$set(e.editForm,"note",t)},expression:"editForm.note"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){return e.closeDialog("editForm")}}},[e._v("取消")]),e._v(" "),a("el-button",{staticClass:"title",attrs:{size:"small",type:"primary"},on:{click:function(t){return e.handelSource("editForm")}}},[e._v("保存")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"查看车号",visible:e.carNumbersInfoVisible,width:"50%","before-close":e.closeCarNumbersInfoVisible},on:{"update:visible":function(t){e.carNumbersInfoVisible=t}}},[a("div",[a("el-form",{ref:"searchForm",staticClass:"user-search",attrs:{inline:!0,model:e.pageparmcar}},[a("el-form-item",{attrs:{label:"",prop:""}},[a("el-select",{attrs:{multiple:"",placeholder:"请选择车号"},model:{value:e.selectLongCarNumberList,callback:function(t){e.selectLongCarNumberList=t},expression:"selectLongCarNumberList"}},[a("el-option",{attrs:{label:"2048",value:2048}}),e._v(" "),a("el-option",{attrs:{label:"2049",value:2049}}),e._v(" "),a("el-option",{attrs:{label:"2050",value:2050}})],1)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-search"},on:{click:function(t){return e.insertLongCarNumber()}}},[e._v("添加")])],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.carNumbersInfoData,border:"",height:"500","row-style":e.rowCarStyle}},[a("el-table-column",{attrs:{type:"index",label:"序号",align:"center",width:"70",index:e.indexMethod,fixed:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"carNumber",label:"车号",width:"180",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"complTime",label:"完成时间",width:"240",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{ref:"saveTagInput",staticClass:"input-new-tag",attrs:{type:"textarea"},on:{blur:function(a){return e.editComplTime(t.row)}},model:{value:t.row.complTime,callback:function(a){e.$set(t.row,"complTime",a)},expression:"scope.row.complTime"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"",label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[1==t.row.concern?a("el-button",{attrs:{type:"warning",icon:"el-icon-warning",circle:""},on:{click:function(a){return e.changeCarConcern(t.row.cid,0)}}}):a("el-button",{attrs:{icon:"el-icon-warning-outline",circle:""},on:{click:function(a){return e.changeCarConcern(t.row.cid,1)}}})]}}])})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){return e.closeCarNumbersInfoVisible()}}},[e._v("取 消")])],1)]),e._v(" "),a("el-dialog",{attrs:{title:"删除车号",visible:e.deleteCarNumbersInfoVisible,width:"50%","before-close":function(){e.deleteCarNumbersInfoVisible=!1}},on:{"update:visible":function(t){e.deleteCarNumbersInfoVisible=t}}},[a("div",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.carNumbersInfoData,border:"",height:"500","row-style":e.rowCarStyle}},[a("el-table-column",{attrs:{type:"index",label:"序号",align:"center",width:"70",index:e.indexMethod,fixed:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"carNumber",label:"车号",width:"180",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"complTime",label:"完成时间",width:"240",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{ref:"saveTagInput",staticClass:"input-new-tag",attrs:{type:"textarea",disabled:""},model:{value:t.row.complTime,callback:function(a){e.$set(t.row,"complTime",a)},expression:"scope.row.complTime"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"",label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(a){return e.deleteCarNumber(t.row.cid,t.row)}}})]}}])})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.deleteCarNumbersInfoVisible=!1}}},[e._v("取 消")])],1)])],1)},staticRenderFns:[]};var Ze=a("VU/8")(Ke,Xe,!1,function(e){a("Jylj")},"data-v-5110030e",null).exports,Je={name:"Fault",data:function(){return{baseURL:c,tableData:[],editFormVisible:!1,title:"编辑",editForm:{},rules:{name:[{required:!0,message:"请输入班组名",trigger:"blur"}]},loading:!0,pageparm:{}}},created:function(){this.getFault()},methods:{getFault:function(){var e=this;Object(s.a)({url:c+"/teams/selectall"}).then(function(t){e.tableData=t.data.data,e.loading=!1}).catch(function(e){console.log(e)})},handleEdit:function(e,t){this.editFormVisible=!0,void 0!=t&&"undefined"!=t?(this.title="修改",this.editForm=t):this.title="添加"},handelFault:function(){var e=this;"添加"==this.title?Object(s.a)({url:c+"/teams/insertteams",method:"post",data:this.editForm}).then(function(t){e.$message({message:e.title+"成功",type:"success"}),e.editFormVisible=!1,e.editForm={},e.getFault()}).catch(function(t){console.log(t),e.$message({message:e.title+"失败",type:"error"}),e.editFormVisible=!1,e.editForm={},e.getFault()}):Object(s.a)({url:c+"/teams/insertteams",method:"post",data:this.editForm}).then(function(t){e.editFormVisible=!1,e.editForm={},e.initPage(),e.getFault()}).catch(function(e){console.log(e)})}}},et={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{staticClass:"user-search",attrs:{inline:!0,model:e.pageparm}},[a("el-form-item",[a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-plus"},on:{click:function(t){return e.handleEdit()}}},[e._v("添加")])],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"50%"},attrs:{data:e.tableData,border:""}},[a("el-table-column",{attrs:{prop:"name",label:"班组",align:"center"}})],1),e._v(" "),a("el-dialog",{attrs:{title:e.title,visible:e.editFormVisible,width:"50%"},on:{"update:visible":function(t){e.editFormVisible=t},click:function(t){return e.closeDialog("editForm")}}},[a("el-form",{ref:"editForm",attrs:{"label-width":"120px",model:e.editForm,rules:e.rules}},[a("el-form-item",{attrs:{label:"班组",prop:"name"}},[a("el-input",{attrs:{label:"",placeholder:"请输入班组名"},model:{value:e.editForm.name,callback:function(t){e.$set(e.editForm,"name",t)},expression:"editForm.name"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){return e.closeDialog("editForm")}}},[e._v("取消")]),e._v(" "),a("el-button",{staticClass:"title",attrs:{size:"small",type:"primary"},on:{click:function(t){return e.handelFault("editForm")}}},[e._v("保存")])],1)],1)],1)},staticRenderFns:[]};var tt=a("VU/8")(Je,et,!1,function(e){a("7o1t")},"data-v-1c47ec52",null).exports,at={name:"Fault",data:function(){return{baseURL:c,tableData:[],editFormVisible:!1,title:"编辑",editForm:{},rules:{name:[{required:!0,message:"请输入班组名",trigger:"blur"}]},loading:!0,pageparm:{}}},created:function(){this.getFault()},methods:{getFault:function(){var e=this;Object(s.a)({url:c+"/teams/selectall"}).then(function(t){e.tableData=t.data.data,e.loading=!1}).catch(function(e){console.log(e)})},handleEdit:function(e,t){this.editFormVisible=!0,void 0!=t&&"undefined"!=t?(this.title="修改",this.editForm=t):this.title="添加"},handelFault:function(){var e=this;"添加"==this.title?Object(s.a)({url:c+"/teams/insertteams",method:"post",data:this.editForm}).then(function(t){e.$message({message:e.title+"成功",type:"success"}),e.editFormVisible=!1,e.editForm={},e.getFault()}).catch(function(t){console.log(t),e.$message({message:e.title+"失败",type:"error"}),e.editFormVisible=!1,e.editForm={},e.getFault()}):Object(s.a)({url:c+"/teams/insertteams",method:"post",data:this.editForm}).then(function(t){e.editFormVisible=!1,e.editForm={},e.initPage(),e.getFault()}).catch(function(e){console.log(e)})}}},lt={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"50%"},attrs:{data:e.tableData,border:""}},[a("el-table-column",{attrs:{prop:"name",label:"班组",align:"center"}})],1),e._v(" "),a("el-dialog",{attrs:{title:e.title,visible:e.editFormVisible,width:"50%"},on:{"update:visible":function(t){e.editFormVisible=t},click:function(t){return e.closeDialog("editForm")}}},[a("el-form",{ref:"editForm",attrs:{"label-width":"120px",model:e.editForm,rules:e.rules}},[a("el-form-item",{attrs:{label:"班组",prop:"name"}},[a("el-input",{attrs:{label:"",placeholder:"请输入班组名"},model:{value:e.editForm.name,callback:function(t){e.$set(e.editForm,"name",t)},expression:"editForm.name"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){return e.closeDialog("editForm")}}},[e._v("取消")]),e._v(" "),a("el-button",{staticClass:"title",attrs:{size:"small",type:"primary"},on:{click:function(t){return e.handelFault("editForm")}}},[e._v("保存")])],1)],1)],1)},staticRenderFns:[]};var rt=a("VU/8")(at,lt,!1,function(e){a("5i3/")},"data-v-ad7c94d8",null).exports,ot={name:"qualitySquare",data:function(){var e;return e={baseURL:c,carNumberList:S,classCarNumbers:R,squareCarNumberList:Ve,twoCarNumberList:Be,eightCarNumberList:Le,selectSquareCarNumberList:[],sid:0,carNumbers:[],tableData:[],loading:!1,pageparm:{type:1,pageNo:1,pageSize:1e5},pageparmcar:{},editFormVisible:!1,title:"编辑",editForm:{},total:0},x()(e,"loading",!1),x()(e,"carNumbersVisible",!1),x()(e,"props",{multiple:!0}),x()(e,"selectedCarNumbers",[]),x()(e,"inputVisible",!1),x()(e,"inputValue",""),x()(e,"carNumberComplTimeVisible",!1),x()(e,"carNumberComplForm",{}),x()(e,"carNumbersBySid",[]),x()(e,"carNumbersInfoVisible",!1),x()(e,"carNumbersInfoData",[]),x()(e,"ComplTimeVisible",!0),x()(e,"deleteCarNumbersInfoVisible",!1),x()(e,"selectLongCarNumberList",[]),x()(e,"updateTotal",0),x()(e,"updateIncompl",0),x()(e,"updateCompl",0),x()(e,"updateIncomplTwo",0),x()(e,"updateIncomplEight",0),x()(e,"updateComplTwo",0),x()(e,"updateComplEight",0),x()(e,"span",[]),x()(e,"index",null),e},computed:{indexMethod:function(){return(this.pageparm.pageNo-1)*this.pageparm.pageSize+1}},created:function(){this.getQS()},methods:{rowStyle:function(e){if(1==e.row.dimension)return{background:"antiquewhite"}},search:function(){var e=this;this.carNumbers.length&&(this.pageparm.carNumbers=this.carNumbers),this.loading=!0,Object(s.a)({method:"post",url:c+"/source/selectallsourceinfo",data:this.pageparm}).then(function(t){var a=t.data.data;a=a.map(function(t){return t.sourceCarNumberDto.sort(e.compare("carNumber")),t}),e.tableData=a,e.loading=!1,e.$message.success("搜索成功")}).catch(function(t){e.initPage(),e.$message.error("搜索失败"),console.log(t)})},resetForm:function(e){this.$refs[e].resetFields(),this.carNumbers=[],this.pageparm.carNumbers&&delete this.pageparm.carNumbers},initPage:function(){this.pageparm={pageNo:1,pageSize:1e5,type:1}},getQS:function(){var e=this;Object(s.a)({url:c+"/source/selectallsourceinfo",method:"post",data:this.pageparm}).then(function(t){var a=t.data.data;a=a.map(function(t){return t.sourceCarNumberDto.sort(e.compare("carNumber")),t}),e.tableData=a,e.loading=!1}).catch(function(e){console.log(e)})},compare:function(e){return function(t,a){return t[e]-a[e]}},handleEdit:function(e,t){this.editFormVisible=!0,void 0!=t&&"undefined"!=t?(this.title="修改",this.editForm=t):(this.title="添加",this.editForm={})},changeResult:function(){this.editForm.result=""},handelSource:function(){var e=this;this.$refs.editForm.validate(function(t){if(!t)return console.log("提交失败"),!1;"添加"==e.title?Object(s.a)({url:c+"/source/insertsource",method:"post",data:e.editForm}).then(function(t){e.$message({message:e.title+"成功",type:"success"}),e.editFormVisible=!1,e.editForm={},e.getQS()}).catch(function(t){console.log(t),e.$message({message:e.title+"失败",type:"error"}),e.editFormVisible=!1,e.editForm={}}):Object(s.a)({url:c+"/source/updatesourceid",method:"post",data:e.editForm}).then(function(t){e.editFormVisible=!1,e.editForm={},e.$message.success("修改成功")}).catch(function(t){console.log(t),e.$message.error("请重新提交")})})},callFather:function(e){this.pageparm.pageNo=e.pageNo,this.pageparm.pageSize=e.pageSize},closeDialog:function(){this.editFormVisible=!1,this.editForm={}},handleCarNumbers:function(e){this.editForm=e,this.sid=e.sid,this.getCarNumbersBySid(e.sid),this.carNumbersVisible=!0},getCarNumbersBySid:function(e){var t=this;Object(s.a)({method:"post",url:c+"/source/selectallsourceinfo",data:w()({sid:e},this.pageparm)}).then(function(e){t.carNumbersBySid=e.data.data[0].sourceCarNumberDto,t.carNumbersInfoData=e.data.data[0].sourceCarNumberDto,t.carNumbersInfoData.sort(t.compare("carNumber"))}).catch(function(e){})},insertLongCarNumber:function(){var e=this;this.$confirm("是否提交该车号?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){if(e.selectSquareCarNumberList.length){for(var t=0;t<e.selectSquareCarNumberList.length;t++)Object(s.a)({url:c+"/source/insertsourcecarnumber",method:"post",data:{sid:e.sid,carNumber:e.selectSquareCarNumberList[t]}}).then(function(t){e.getQS(),e.getCarNumbersBySid(e.sid)}).catch(function(t){e.getQS(),e.getCarNumbersBySid(e.sid),console.log(t),e.$message.error("请重新提交")});e.selectSquareCarNumberList=[]}else e.$message.warning("请选择车号")}).then(function(){e.updateNumber(e.sid)}).catch(function(){e.$message({type:"info",message:"已取消提交"})})},toRemoveSpacing:function(e){if("string"==typeof e)var t=e.replace(/[\t\r\f\n\s]*/g,"");return t},updateNumber:function(e){var t=this;Object(s.a)({method:"post",url:c+"/source/selectallsourceinfo",data:{sid:e}}).then(function(e){var a=e.data.data[0].sourceCarNumberDto,l=a.length;t.updateTotal=l;for(var r=0,o=0,i=0,n=0,s=0,c=0,u=0;u<l;u++){var m=t.toRemoveSpacing(a[u].complTime);"null"==m.toLowerCase()||""==m||"N/A"==m||"未完成"==m?(r+=1,Be.includes(a[u].carNumber)?i+=1:n+=1):(o+=1,Be.includes(a[u].carNumber)?s+=1:c+=1)}t.updateIncompl=r,t.updateCompl=o,t.updateComplEight=c,t.updateComplTwo=s,t.updateIncomplTwo=i,t.updateIncomplEight=n}).then(function(){var a=void 0;a=0==t.updateIncompl&0!=t.updateTotal?1:0,Object(s.a)({url:c+"/source/updatesourceid",method:"post",data:w()({sid:e},t.editForm,{total:t.updateTotal,incomplTotal:t.updateIncompl,complTotal:t.updateCompl,complEight:t.updateComplEight,complTwo:t.updateComplTwo,incomplEight:t.updateIncomplEight,incomplTwo:t.updateIncomplTwo,state:a})}).then(function(e){t.editFormVisible=!1,t.search(),t.getCarNumbersBySid(t.sid)}).catch(function(e){console.log(e)})})},handleCarNumberForm:function(){var e=this;this.inputValue&&this.$confirm("是否提交该车号?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var t=e.inputValue;t&&(e.selectedCarNumbers.push(t),Object(s.a)({url:c+"/source/insertsourcecarnumber",method:"post",data:{sid:e.sid,carNumber:e.inputValue}}).then(function(t){e.getQS(),e.getCarNumbersBySid(e.sid),e.inputVisible=!1,e.$message.success("提交成功")}).catch(function(t){e.getQS(),e.editForm={},console.log(t),e.$message.error("请重新提交")})),e.inputValue=""}).catch(function(){e.$message({type:"info",message:"已取消提交"})})},handleClose:function(){this.carNumberComplForm={},this.carNumberComplTimeVisible=!1},handleSelectedCarNumbers:function(){this.carNumbersVisible=!1},handleCloseNumbers:function(e,t){var a=this;this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:c+"/source/deletesourcecarnumbersid",method:"post",params:{cid:e}}).then(function(e){a.$message({message:"删除成功",type:"success"}),a.getQS()}).catch(function(e){console.log(e)})}).catch(function(){a.$message({type:"info",message:"已取消删除"})})},deleteCarNumber:function(e,t){var a=this;this.$confirm("此操作将永久删除, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:c+"/source/deletesourcecarnumbersid",method:"post",params:{cid:e}}).then(function(e){a.$message({message:"删除成功",type:"success"}),a.getCarNumbersBySid(a.sid)}).then(function(){var e=a.editForm.total;e-=1,console.log(e);var l=void 0,r=void 0,o=void 0,i=void 0,n=a.toRemoveSpacing(t.complTime),u=void 0,m=void 0,p=void 0,d=void 0;"null"==n.toLowerCase()||""==n||"N/A"==n||"未完成"==n?(o=0!=e&0==(l=a.editForm.incomplTotal-1)?1:0,Be.includes(t.carNumber)?u=a.editForm.incomplTwo-1:m=a.editForm.incomplEight-1):(e==(r=a.editForm.complTotal-1)?(o=1,console.log(o)):(o=0,console.log(o)),Be.includes(t.carNumber)?p=a.editForm.complTwo-1:d=a.editForm.complEight-1),i=w()({},a.editForm,{total:e,incomplTotal:l,complTotal:r,state:o}),i="null"==n.toLowerCase()||""==n||"N/A"==n||"未完成"==n?Be.includes(t.carNumber)?w()({},a.editForm,{total:e,incomplTotal:l,incomplTwo:u,state:o}):w()({},a.editForm,{total:e,incomplTotal:l,incomplEight:m,state:o}):Be.includes(t.carNumber)?w()({},a.editForm,{total:e,complTotal:r,complTwo:p,state:o}):w()({},a.editForm,{total:e,complTotal:r,complEight:d,state:o}),Object(s.a)({url:c+"/source/updatesourceid",method:"post",data:w()({sid:a.sid},i)}).then(function(e){a.initPage(),a.getQS()}).then(function(){Object(s.a)({method:"post",url:c+"/source/selectallsourceinfo",data:{sid:a.sid}}).then(function(e){a.editForm=e.data.data[0],console.log(a.editForm),a.initPage(),a.getQS(),a.getCarNumbersBySid(a.sid)})})})}).catch(function(){a.$message({type:"info",message:"已取消删除"})})},handleInputConfirm:function(e){var t=this;this.$confirm("是否提交该车号?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var a=t.inputValue;a&&(t.selectedCarNumbers.push(a),Object(s.a)({url:c+"/source/insertsourcecarnumber",method:"post",data:{sid:e.sid,carNumber:t.inputValue}}).then(function(e){t.inputVisible=!1,t.$message.success("提交成功")}).catch(function(e){console.log(e),t.$message.error("请重新提交")})),t.inputValue=""}).catch(function(){t.$message({type:"info",message:"已取消提交"})})},showInput:function(){var e=this;this.inputVisible=!0,this.$nextTick(function(t){e.$refs.saveTagInput.$refs.input.focus()})},editCarNumber:function(e,t){this.carNumberComplForm=e},handleComplTime:function(){var e=this;this.carNumberComplTimeVisible=!1,Object(s.a)({url:c+"/source/updatesourcecarnumber",method:"post",data:this.carNumberComplForm}).then(function(t){e.getQS()}).catch(function(e){})},exportSourceExcel:function(){var e=c+"/source/exportsource?";for(var t in this.pageparm)this.pageparm[t]&&(e+=t+"="+this.pageparm[t]+"&");s.a.get(e).then(function(t){window.location.href=e})},exportSourceFinalExcel:function(){var e=c+"/source/exportsourcefinalqualitysquare?";for(var t in this.pageparm||0==this.pageparm[t])this.pageparm[t]&&(e+=t+"="+this.pageparm[t]+"&");s.a.get(e).then(function(t){window.location.href=e})},handleSourceExceed:function(e,t){this.$message.warning("当前限制选择文件个数，本次选择了 "+e.length+" 个文件，共选择了 "+(e.length+t.length)+" 个文件")},handleSourceSuccess:function(){this.getQS(),this.$message.success("导入成功")},handleError:function(){this.$message.error("导入格式错误，请修改后重新导入！")},handleCarNumbersInfo:function(e){this.carNumbersInfoVisible=!0,this.getCarNumbersBySid(e.sid),this.sid=e.sid,this.editForm=e},deleteCarNumbersInfo:function(e){this.deleteCarNumbersInfoVisible=!0,this.getCarNumbersBySid(e.sid),this.sid=e.sid,this.editForm=e},enditComplTime:function(){this.ComplTimeVisible=!1},editComplTime:function(e){var t=this;Object(s.a)({url:c+"/source/updatesourcecarnumber",method:"post",data:{cid:e.cid,complTime:e.complTime}}).then(function(e){t.$message.success("提交成功"),t.getQS()}).then(function(){t.updateNumber(t.sid)})},deleteSourceInfoBySID:function(e){var t=this;Object(s.a)({url:c+"/source/deletesourceinfosid",method:"post",params:{sid:e}}).then(function(e){t.$message.success("删除成功"),t.getQS()}).catch(function(e){t.$message.error("删除失败")})},changeDimension:function(e,t){var a=this;this.$confirm("是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:" "+c+"/source/changedimension",params:{sid:e,dimension:t}}).then(function(e){a.$message.success("成功"),a.search()}).catch(function(e){a.$message.error("失败")})}).catch(function(){a.$message({type:"info",message:"已取消"})})},rowCarStyle:function(e){if(1==e.row.concern)return{background:"antiquewhite"}},changeCarConcern:function(e,t){var a=this;this.$confirm("是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:" "+c+"/source/changeconcern",params:{cid:e,concern:t}}).then(function(e){a.$message.success("标注成功"),a.getQS(),a.getCarNumbersBySid(a.sid),a.search()}).catch(function(e){a.getQS(),a.getCarNumbersBySid(a.sid),a.$message.error("标注失败")})}).catch(function(){a.$message({type:"info",message:"已取消"})})},closeCarNumbersInfoVisible:function(){this.carNumbersInfoVisible=!1,this.carNumbersInfoData=[]}}},it={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:6}},[a("div",{staticClass:"grid-content bg-purple"},[a("el-button",{attrs:{size:"small",type:"warning",icon:"el-icon-star-on"},on:{click:function(t){return e.exportSourceFinalExcel()}}},[e._v("导出")])],1)])],1),e._v(" "),a("el-form",{ref:"searchForm",staticClass:"user-search",attrs:{inline:!0,model:e.pageparm}},[a("el-form-item",{attrs:{label:"标注",prop:"dimension"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.pageparm.dimension,callback:function(t){e.$set(e.pageparm,"dimension",t)},expression:"pageparm.dimension"}},[a("el-option",{attrs:{label:"非重点关注",value:"0"}}),e._v(" "),a("el-option",{attrs:{label:"重点关注",value:"1"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"批次",prop:"batch"}},[a("el-input",{attrs:{placeholder:"输入批次"},model:{value:e.pageparm.batch,callback:function(t){e.$set(e.pageparm,"batch",t)},expression:"pageparm.batch"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"总公司文号",prop:"headDocumentNumber"}},[a("el-input",{attrs:{placeholder:"输入总公司文号"},model:{value:e.pageparm.headDocumentNumber,callback:function(t){e.$set(e.pageparm,"headDocumentNumber",t)},expression:"pageparm.headDocumentNumber"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"路局文号",prop:"roadDocumentNumber"}},[a("el-input",{attrs:{placeholder:"输入路局文号"},model:{value:e.pageparm.roadDocumentNumber,callback:function(t){e.$set(e.pageparm,"roadDocumentNumber",t)},expression:"pageparm.roadDocumentNumber"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"申请单编号",prop:"applicNumber"}},[a("el-input",{attrs:{placeholder:"输入申请单编号"},model:{value:e.pageparm.applicNumber,callback:function(t){e.$set(e.pageparm,"applicNumber",t)},expression:"pageparm.applicNumber"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"项目名称",prop:"entryName"}},[a("el-input",{attrs:{placeholder:"输入项目名称"},model:{value:e.pageparm.entryName,callback:function(t){e.$set(e.pageparm,"entryName",t)},expression:"pageparm.entryName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"项目完成情况",prop:"state"}},[a("el-select",{attrs:{placeholder:"请选择项目完成情况"},model:{value:e.pageparm.state,callback:function(t){e.$set(e.pageparm,"state",t)},expression:"pageparm.state"}},[a("el-option",{attrs:{label:"已完成",value:1}}),e._v(" "),a("el-option",{attrs:{label:"未完成",value:0}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"修程",prop:"repairProcedure"}},[a("el-input",{attrs:{placeholder:"输入修程"},model:{value:e.pageparm.repairProcedure,callback:function(t){e.$set(e.pageparm,"repairProcedure",t)},expression:"pageparm.repairProcedure"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"车号",prop:"carNumber"}},[a("el-select",{attrs:{multiple:"",filterable:"",placeholder:"请选择车号"},model:{value:e.carNumbers,callback:function(t){e.carNumbers=t},expression:"carNumbers"}},e._l(e.squareCarNumberList,function(e){return a("el-option",{key:e.value,attrs:{label:e.value,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"车号完成情况",prop:"complTime"}},[a("el-select",{attrs:{placeholder:"请选择车号完成情况"},model:{value:e.pageparm.complTime,callback:function(t){e.$set(e.pageparm,"complTime",t)},expression:"pageparm.complTime"}},[a("el-option",{attrs:{label:"已完成",value:"已完成"}}),e._v(" "),a("el-option",{attrs:{label:"未完成",value:"未完成"}})],1)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-search"},on:{click:function(t){return e.search()}}},[e._v("搜索")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-refresh-right"},on:{click:function(t){return e.resetForm("searchForm")}}},[e._v("重置")])],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"",height:"650","row-style":e.rowStyle}},[a("el-table-column",{attrs:{type:"index",label:"序号",align:"center",width:"70",index:e.indexMethod,fixed:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"batch",label:"批次",width:"80",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"headDocumentNumber",label:"总公司文号",width:"120",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"roadDocumentNumber",label:"路局文号",width:"120",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"applicNumber",label:"申请单编号",width:"120",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"entryName",label:"项目名称",width:"200",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"repairProcedure",label:"修程",width:"200",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"total",label:"总数",align:"center",width:"70"}}),e._v(" "),a("el-table-column",{attrs:{prop:"complEight",label:"CRH380A",width:"90",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"complTwo",label:"CRH2A",width:"90",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"complTotal",label:"已完成",width:"70",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"incomplEight",label:"CRH380A",width:"90",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"incomplTwo",label:"CRH2A",width:"90",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"incomplTotal",label:"未完成",width:"70",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"carNumbers",label:"车号",align:"center",width:"280"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.sourceCarNumberDto,function(t){return a("div",{key:t.cid,staticStyle:{display:"inline-block"}},["未完成"==t.complTime&0==t.concern?a("el-tag",{attrs:{type:"info"}},[e._v(e._s(t.carNumber))]):"未完成"!=t.complTime&0==t.concern?a("el-tag",{attrs:{type:"success"}},[e._v(e._s(t.carNumber))]):a("el-tag",{attrs:{type:"warning"}},[e._v(e._s(t.carNumber))])],1)})}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"note",label:"备注",align:"center",width:"220"}}),e._v(" "),a("el-table-column",{attrs:{prop:"",label:"查看车号信息",width:"180",align:"center",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("el-button",{attrs:{type:"primary",icon:"el-icon-circle-plus",circle:""},on:{click:function(a){return e.handleCarNumbersInfo(t.row)}}})],1)]}}])})],1),e._v(" "),a("el-dialog",{attrs:{title:"查看车号",visible:e.carNumbersInfoVisible,width:"50%","before-close":e.closeCarNumbersInfoVisible},on:{"update:visible":function(t){e.carNumbersInfoVisible=t}}},[a("div",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.carNumbersInfoData,border:"",height:"500","row-style":e.rowCarStyle}},[a("el-table-column",{attrs:{type:"index",label:"序号",align:"center",width:"70",index:e.indexMethod,fixed:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"carNumber",label:"车号",width:"180",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"complTime",label:"完成时间",width:"240",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{ref:"saveTagInput",staticClass:"input-new-tag",attrs:{disabled:"",type:"textarea"},on:{blur:function(a){return e.editComplTime(t.row)}},model:{value:t.row.complTime,callback:function(a){e.$set(t.row,"complTime",a)},expression:"scope.row.complTime"}})]}}])})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){return e.closeCarNumbersInfoVisible()}}},[e._v("取 消")])],1)])],1)},staticRenderFns:[]};var nt=a("VU/8")(ot,it,!1,function(e){a("vIe/")},"data-v-545c9522",null).exports,st={name:"qualitylong",inject:["reload"],data:function(){var e;return e={baseURL:c,carNumberList:S,longCarNumberList:qe,selectLongCarNumberList:[],classCarNumbers:R,sid:0,carNumbers:[],tableData:[],loading:!1,pageparm:{type:2,pageNo:1,pageSize:1e5},pageparmcar:{},editFormVisible:!1,title:"编辑",editForm:{type:2},total:0},x()(e,"loading",!1),x()(e,"carNumbersVisible",!1),x()(e,"props",{multiple:!0}),x()(e,"selectedCarNumbers",[]),x()(e,"inputVisible",!1),x()(e,"inputValue",""),x()(e,"carNumberComplTimeVisible",!1),x()(e,"carNumberComplForm",{}),x()(e,"carNumbersBySid",[]),x()(e,"carNumbersInfoVisible",!1),x()(e,"carNumbersInfoData",[]),x()(e,"ComplTimeVisible",!0),x()(e,"updateTotal",0),x()(e,"updateIncompl",0),x()(e,"updateCompl",0),x()(e,"deleteCarNumbersInfoVisible",!1),e},computed:{indexMethod:function(){return(this.pageparm.pageNo-1)*this.pageparm.pageSize+1}},created:function(){this.getQL()},methods:{search:function(){var e=this;this.carNumbers.length&&(this.pageparm.carNumbers=this.carNumbers),this.loading=!0,Object(s.a)({method:"post",url:c+"/source/selectallsourceinfo",data:this.pageparm}).then(function(t){var a=t.data.data;a=a.map(function(t){return t.sourceCarNumberDto.sort(e.compare("carNumber")),t}),e.tableData=a,e.loading=!1,e.$message.success("搜索成功")}).catch(function(t){e.initPage(),e.$message.error("搜索失败"),console.log(t)})},resetForm:function(e){this.$refs[e].resetFields(),this.carNumbers=[],this.pageparm.carNumbers&&delete this.pageparm.carNumbers},initPage:function(){this.pageparm={pageNo:1,pageSize:1e5,type:2}},getQL:function(){var e=this;Object(s.a)({url:c+"/source/selectallsourceinfo",method:"post",data:this.pageparm}).then(function(t){var a=t.data.data;a=a.map(function(t){return t.sourceCarNumberDto.sort(e.compare("carNumber")),t}),e.tableData=a,e.loading=!1}).catch(function(e){console.log(e)})},compare:function(e){return function(t,a){return t[e]-a[e]}},handleEdit:function(e,t){this.editFormVisible=!0,void 0!=t&&"undefined"!=t?(this.title="修改",this.editForm=t):(this.title="添加",this.editForm={})},changeResult:function(){this.editForm.result=""},handelSource:function(){var e=this;this.$refs.editForm.validate(function(t){if(!t)return console.log("提交失败"),!1;"添加"==e.title?Object(s.a)({url:c+"/source/insertsource",method:"post",data:w()({},e.editForm,{type:2})}).then(function(t){e.$message({message:e.title+"成功",type:"success"}),e.editFormVisible=!1,e.editForm={type:2},e.getQL()}).catch(function(t){console.log(t),e.$message({message:e.title+"失败",type:"error"}),e.editFormVisible=!1,e.editForm={type:2}}):Object(s.a)({url:c+"/source/updatesourceid",method:"post",data:e.editForm}).then(function(t){e.editFormVisible=!1,e.editForm={},e.$message.success("修改成功")}).catch(function(t){console.log(t),e.$message.error("请重新提交")})})},closeDialog:function(){this.editFormVisible=!1,this.editForm={}},handleCarNumbers:function(e){this.editForm=e,this.sid=e.sid,this.getCarNumbersBySid(e.sid),this.carNumbersVisible=!0},getCarNumbersBySid:function(e){var t=this;Object(s.a)({method:"post",url:c+"/source/selectallsourceinfo",data:w()({sid:e},this.pageparm)}).then(function(e){t.carNumbersBySid=e.data.data[0].sourceCarNumberDto,t.carNumbersInfoData=e.data.data[0].sourceCarNumberDto,t.carNumbersInfoData.sort(t.compare("carNumber"))}).catch(function(e){})},insertLongCarNumber:function(){var e=this;this.$confirm("是否提交该车号?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){if(e.selectLongCarNumberList.length){for(var t=0;t<e.selectLongCarNumberList.length;t++)Object(s.a)({url:c+"/source/insertsourcecarnumber",method:"post",data:{sid:e.sid,carNumber:e.selectLongCarNumberList[t]}}).then(function(t){e.getQL(),e.getCarNumbersBySid(e.sid)}).catch(function(t){e.getQL(),e.editForm={},console.log(t),e.$message.error("请重新提交")});e.selectLongCarNumberList=[]}else e.$message.warning("请选择车号")}).then(function(){e.updateNumber(e.sid)}).catch(function(){e.$message({type:"info",message:"已取消提交"})})},toRemoveSpacing:function(e){if("string"==typeof e)var t=e.replace(/[\t\r\f\n\s]*/g,"");return t},updateNumber:function(e){var t=this;Object(s.a)({method:"post",url:c+"/source/selectallsourceinfo",data:{sid:e}}).then(function(e){console.log(e.data.data[0].sourceCarNumberDto);var a=e.data.data[0].sourceCarNumberDto,l=e.data.data[0].sourceCarNumberDto.length;t.updateTotal=l,console.log("total",l);for(var r=0,o=0,i=0;i<l;i++){var n=t.toRemoveSpacing(a[i].complTime);"null"==n.toLowerCase()||""==n||"N/A"==n||"未完成"==n?r+=1:o+=1}console.log("incoml",r),t.updateIncompl=r,t.updateCompl=o}).then(function(){var a=void 0;a=0==t.updateIncompl&0!=t.updateTotal?1:0,Object(s.a)({url:c+"/source/updatesourceid",method:"post",data:w()({sid:e},t.editForm,{total:t.updateTotal,incomplTotal:t.updateIncompl,complTotal:t.updateCompl,state:a})}).then(function(e){t.editFormVisible=!1,t.search(),t.getCarNumbersBySid(t.sid)}).catch(function(e){console.log(e)})})},handleCarNumberForm:function(){var e=this;this.inputValue&&this.$confirm("是否提交该车号?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var t=e.inputValue;t&&(e.selectedCarNumbers.push(t),Object(s.a)({url:c+"/source/insertsourcecarnumber",method:"post",data:{sid:e.sid,carNumber:e.inputValue}}).then(function(t){e.getQL(),e.getCarNumbersBySid(e.sid),e.inputVisible=!1,e.$message.success("提交成功")}).catch(function(t){e.getQL(),e.editForm={},console.log(t),e.$message.error("请重新提交")})),e.inputValue=""}).catch(function(){e.$message({type:"info",message:"已取消提交"})})},deleteCarNumbersInfo:function(e){this.deleteCarNumbersInfoVisible=!0,this.getCarNumbersBySid(e.sid),this.sid=e.sid,this.editForm=e},handleClose:function(e){this.carNumberComplForm={},this.carNumberComplTimeVisible=!1},handleSelectedCarNumbers:function(){this.carNumbersVisible=!1},handleCloseNumbers:function(e,t){var a=this;this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:c+"/source/deletesourcecarnumbersid",method:"post",params:{cid:e}}).then(function(e){a.$message({message:"删除成功",type:"success"}),a.getQL()}).catch(function(e){console.log(e)})}).catch(function(){a.$message({type:"info",message:"已取消删除"})})},deleteCarNumber:function(e,t){var a=this;this.$confirm("此操作将永久删除, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:c+"/source/deletesourcecarnumbersid",method:"post",params:{cid:e}}).then(function(e){a.$message({message:"删除成功",type:"success"}),a.getCarNumbersBySid(a.sid)}).then(function(){var e=a.editForm.total;e-=1,console.log(e);var l=void 0,r=void 0,o=void 0,i=void 0,n=a.toRemoveSpacing(t.complTime);"null"==n.toLowerCase()||""==n||"N/A"==n||"未完成"==n?o=0!=e&0==(l=a.editForm.incomplTotal-1)?1:0:e==(r=a.editForm.complTotal-1)?(o=1,console.log(o)):(o=0,console.log(o)),console.log(t),console.log(e,l,r),i=w()({},a.editForm,{total:e,incomplTotal:l,complTotal:r,state:o}),"null"==n.toLowerCase()||""==n||"N/A"==n||"未完成"==n?(i=w()({},a.editForm,{total:e,incomplTotal:l,state:o}),console.log(i)):(i=w()({},a.editForm,{total:e,complTotal:r,state:o}),console.log(i)),Object(s.a)({url:c+"/source/updatesourceid",method:"post",data:w()({sid:a.sid},i)}).then(function(e){a.initPage(),a.getQL(),a.getCarNumbersBySid(a.sid)}).then(function(){Object(s.a)({method:"post",url:c+"/source/selectallsourceinfo",data:{sid:a.sid}}).then(function(e){a.editForm=e.data.data[0],console.log(a.editForm),a.initPage(),a.getQL(),a.getCarNumbersBySid(a.sid)})})})}).catch(function(){a.$message({type:"info",message:"已取消删除"})})},handleInputConfirm:function(e){var t=this;this.$confirm("是否提交该车号?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var a=t.inputValue;a&&(t.selectedCarNumbers.push(a),Object(s.a)({url:c+"/source/insertsourcecarnumber",method:"post",data:{sid:e.sid,carNumber:t.inputValue}}).then(function(e){t.inputVisible=!1,t.$message.success("提交成功")}).catch(function(e){console.log(e),t.$message.error("请重新提交")})),t.inputValue=""}).catch(function(){t.$message({type:"info",message:"已取消提交"})})},showInput:function(){var e=this;this.inputVisible=!0,this.$nextTick(function(t){e.$refs.saveTagInput.$refs.input.focus()})},editCarNumber:function(e,t){this.carNumberComplForm=e},handleComplTime:function(){var e=this;this.carNumberComplTimeVisible=!1,Object(s.a)({url:c+"/source/updatesourcecarnumber",method:"post",data:this.carNumberComplForm}).then(function(t){e.getQL()}).catch(function(e){})},exportSourceExcel:function(){var e=c+"/source/exportsource?";for(var t in this.pageparm)this.pageparm[t]&&(e+=t+"="+this.pageparm[t]+"&");s.a.get(e).then(function(t){console.log(e),window.location.href=e})},exportSourceFinalExcel:function(){var e=c+"/source/exportsourcefinalqualitylong?";for(var t in this.pageparm)(this.pageparm[t]||0==this.pageparm[t])&&(e+=t+"="+this.pageparm[t]+"&");s.a.get(e).then(function(t){window.location.href=e})},handleSourceExceed:function(e,t){this.$message.warning("当前限制选择文件个数，本次选择了 "+e.length+" 个文件，共选择了 "+(e.length+t.length)+" 个文件")},handleSourceSuccess:function(){this.getQL(),this.$message.success("导入成功")},handleError:function(){this.$message.error("导入格式错误，请修改后重新导入！")},handleCarNumbersInfo:function(e){this.carNumbersInfoVisible=!0,this.getCarNumbersBySid(e.sid),this.sid=e.sid,this.editForm=e},enditComplTime:function(){this.ComplTimeVisible=!1},editComplTime:function(e){var t=this;Object(s.a)({url:c+"/source/updatesourcecarnumber",method:"post",data:{cid:e.cid,complTime:e.complTime}}).then(function(e){t.$message.success("提交成功")}).then(function(){t.updateNumber(t.sid)})},deleteSourceInfoBySID:function(e){var t=this;Object(s.a)({url:c+"/source/deletesourceinfosid",method:"post",params:{sid:e}}).then(function(e){t.$message.success("删除成功"),t.getQL()}).catch(function(e){t.$message.error("删除失败")})},changeDimension:function(e,t){var a=this;this.$confirm("是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:" "+c+"/source/changedimension",params:{sid:e,dimension:t}}).then(function(e){a.$message.success("成功"),a.search()}).catch(function(e){a.$message.error("失败")})}).catch(function(){a.$message({type:"info",message:"已取消"})})},rowStyle:function(e){if(1==e.row.dimension)return{background:"antiquewhite"}},rowCarStyle:function(e){if(1==e.row.concern)return{background:"antiquewhite"}},changeCarConcern:function(e,t){var a=this;this.$confirm("是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:" "+c+"/source/changeconcern",params:{cid:e,concern:t}}).then(function(e){a.$message.success("标注成功"),a.getQL(),a.getCarNumbersBySid(a.sid),a.search()}).catch(function(e){a.getQL(),a.getCarNumbersBySid(a.sid),a.$message.error("标注失败")})}).catch(function(){a.$message({type:"info",message:"已取消"})})},closeCarNumbersInfoVisible:function(){this.carNumbersInfoVisible=!1,this.carNumbersInfoData=[]}}},ct={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:6}},[a("div",{staticClass:"grid-content bg-purple"},[a("el-button",{attrs:{size:"small",type:"warning",icon:"el-icon-star-on"},on:{click:function(t){return e.exportSourceFinalExcel()}}},[e._v("导出")])],1)])],1),e._v(" "),a("el-form",{ref:"searchForm",staticClass:"user-search",attrs:{inline:!0,model:e.pageparm}},[a("el-form-item",{attrs:{label:"标注",prop:"dimension"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.pageparm.dimension,callback:function(t){e.$set(e.pageparm,"dimension",t)},expression:"pageparm.dimension"}},[a("el-option",{attrs:{label:"非重点关注",value:"0"}}),e._v(" "),a("el-option",{attrs:{label:"重点关注",value:"1"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"批次",prop:"batch"}},[a("el-input",{attrs:{placeholder:"输入批次"},model:{value:e.pageparm.batch,callback:function(t){e.$set(e.pageparm,"batch",t)},expression:"pageparm.batch"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"总公司文号",prop:"headDocumentNumber"}},[a("el-input",{attrs:{placeholder:"输入总公司文号"},model:{value:e.pageparm.headDocumentNumber,callback:function(t){e.$set(e.pageparm,"headDocumentNumber",t)},expression:"pageparm.headDocumentNumber"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"路局文号",prop:"roadDocumentNumber"}},[a("el-input",{attrs:{placeholder:"输入路局文号"},model:{value:e.pageparm.roadDocumentNumber,callback:function(t){e.$set(e.pageparm,"roadDocumentNumber",t)},expression:"pageparm.roadDocumentNumber"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"申请单编号",prop:"applicNumber"}},[a("el-input",{attrs:{placeholder:"输入申请单编号"},model:{value:e.pageparm.applicNumber,callback:function(t){e.$set(e.pageparm,"applicNumber",t)},expression:"pageparm.applicNumber"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"项目名称",prop:"entryName"}},[a("el-input",{attrs:{placeholder:"输入项目名称"},model:{value:e.pageparm.entryName,callback:function(t){e.$set(e.pageparm,"entryName",t)},expression:"pageparm.entryName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"项目完成情况",prop:"state"}},[a("el-select",{attrs:{placeholder:"请选择项目完成情况"},model:{value:e.pageparm.state,callback:function(t){e.$set(e.pageparm,"state",t)},expression:"pageparm.state"}},[a("el-option",{attrs:{label:"已完成",value:1}}),e._v(" "),a("el-option",{attrs:{label:"未完成",value:0}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"修程",prop:"repairProcedure"}},[a("el-input",{attrs:{placeholder:"输入修程"},model:{value:e.pageparm.repairProcedure,callback:function(t){e.$set(e.pageparm,"repairProcedure",t)},expression:"pageparm.repairProcedure"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"车号",prop:"carNumber"}},[a("el-select",{attrs:{multiple:"",filterable:"",placeholder:"请选择车号"},model:{value:e.carNumbers,callback:function(t){e.carNumbers=t},expression:"carNumbers"}},e._l(e.longCarNumberList,function(e){return a("el-option",{key:e.value,attrs:{label:e.value,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"车号完成情况",prop:"complTime"}},[a("el-select",{attrs:{placeholder:"请选择车号完成情况"},model:{value:e.pageparm.complTime,callback:function(t){e.$set(e.pageparm,"complTime",t)},expression:"pageparm.complTime"}},[a("el-option",{attrs:{label:"已完成",value:"已完成"}}),e._v(" "),a("el-option",{attrs:{label:"未完成",value:"未完成"}})],1)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-search"},on:{click:function(t){return e.search()}}},[e._v("搜索")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-refresh-right"},on:{click:function(t){return e.resetForm("searchForm")}}},[e._v("重置")])],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"",height:"650","row-style":e.rowStyle}},[a("el-table-column",{attrs:{type:"index",label:"序号",align:"center",width:"70",index:e.indexMethod,fixed:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"batch",label:"批次",width:"80",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"headDocumentNumber",label:"总公司文号",width:"120",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"roadDocumentNumber",label:"路局文号",width:"120",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"applicNumber",label:"申请单编号",width:"120",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"entryName",label:"项目名称",width:"200",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"repairProcedure",label:"修程",width:"200",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"total",label:"总数",align:"center",width:"70"}}),e._v(" "),a("el-table-column",{attrs:{prop:"complTotal",label:"已完成",width:"70",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"incomplTotal",label:"未完成",width:"70",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"carNumbers",label:"车号",align:"center",width:"280"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.sourceCarNumberDto,function(t){return a("div",{key:t.cid,staticStyle:{display:"inline-block"}},["未完成"==t.complTime&0==t.concern?a("el-tag",{attrs:{type:"info"}},[e._v(e._s(t.carNumber))]):"未完成"!=t.complTime&0==t.concern?a("el-tag",{attrs:{type:"success"}},[e._v(e._s(t.carNumber))]):a("el-tag",{attrs:{type:"warning"}},[e._v(e._s(t.carNumber))])],1)})}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"note",label:"备注",align:"center",width:"220"}}),e._v(" "),a("el-table-column",{attrs:{prop:"",label:"查看车号信息",width:"180",align:"center",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("el-button",{attrs:{type:"primary",icon:"el-icon-circle-plus",circle:""},on:{click:function(a){return e.handleCarNumbersInfo(t.row)}}})],1)]}}])})],1),e._v(" "),a("el-dialog",{attrs:{title:"查看车号",visible:e.carNumbersInfoVisible,width:"50%","before-close":e.closeCarNumbersInfoVisible},on:{"update:visible":function(t){e.carNumbersInfoVisible=t}}},[a("div",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.carNumbersInfoData,border:"",height:"500","row-style":e.rowCarStyle}},[a("el-table-column",{attrs:{type:"index",label:"序号",align:"center",width:"70",index:e.indexMethod,fixed:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"carNumber",label:"车号",width:"180",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"complTime",label:"完成时间",width:"240",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{ref:"saveTagInput",staticClass:"input-new-tag",attrs:{disabled:"",type:"textarea"},on:{blur:function(a){return e.editComplTime(t.row)}},model:{value:t.row.complTime,callback:function(a){e.$set(t.row,"complTime",a)},expression:"scope.row.complTime"}})]}}])})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.closeCarNumbersInfoVisible}},[e._v("取 消")])],1)])],1)},staticRenderFns:[]};var ut=a("VU/8")(st,ct,!1,function(e){a("oeTE")},"data-v-15102a02",null).exports,mt={name:"techSquare",data:function(){var e;return e={baseURL:c,carNumberList:S,classCarNumbers:R,squareCarNumberList:Ve,selectSquareCarNumberList:[],sid:0,carNumbers:[],tableData:[],loading:!1,pageparm:{type:3,pageNo:1,pageSize:1e5},pageparmcar:{},editFormVisible:!1,title:"编辑",editForm:{type:3},total:0},x()(e,"loading",!1),x()(e,"carNumbersVisible",!1),x()(e,"props",{multiple:!0}),x()(e,"selectedCarNumbers",[]),x()(e,"inputVisible",!1),x()(e,"inputValue",""),x()(e,"carNumberComplTimeVisible",!1),x()(e,"carNumberComplForm",{}),x()(e,"carNumbersBySid",[]),x()(e,"carNumbersInfoVisible",!1),x()(e,"carNumbersInfoData",[]),x()(e,"ComplTimeVisible",!0),x()(e,"updateTotal",0),x()(e,"updateIncompl",0),x()(e,"updateCompl",0),x()(e,"deleteCarNumbersInfoVisible",!1),e},computed:{indexMethod:function(){return(this.pageparm.pageNo-1)*this.pageparm.pageSize+1}},created:function(){this.getTS()},methods:{search:function(){var e=this;this.carNumbers.length&&(this.pageparm.carNumbers=this.carNumbers),this.loading=!0,Object(s.a)({method:"post",url:c+"/source/selectallsourceinfo",data:this.pageparm}).then(function(t){var a=t.data.data;a=a.map(function(t){return t.sourceCarNumberDto.sort(e.compare("carNumber")),t}),e.tableData=a,e.loading=!1,e.$message.success("搜索成功")}).catch(function(t){e.initPage(),e.getFault(),e.$message.error("搜索失败"),console.log(t)})},resetForm:function(e){this.$refs[e].resetFields(),this.carNumbers=[],this.pageparm.carNumbers&&delete this.pageparm.carNumbers},initPage:function(){this.pageparm={pageNo:1,pageSize:1e5,type:3}},getTS:function(){var e=this;Object(s.a)({url:c+"/source/selectallsourceinfo",method:"post",data:this.pageparm}).then(function(t){var a=t.data.data;a=a.map(function(t){return t.sourceCarNumberDto.sort(e.compare("carNumber")),t}),e.tableData=a,e.loading=!1}).catch(function(e){console.log(e)})},compare:function(e){return function(t,a){return t[e]-a[e]}},handleEdit:function(e,t){this.editFormVisible=!0,void 0!=t&&"undefined"!=t?(this.title="修改",this.editForm=t):(this.title="添加",this.editForm={})},changeResult:function(){this.editForm.result=""},handelSource:function(){var e=this;this.$refs.editForm.validate(function(t){if(!t)return console.log("提交失败"),!1;"添加"==e.title?Object(s.a)({url:c+"/source/insertsource",method:"post",data:w()({},e.editForm,{type:3})}).then(function(t){e.$message({message:e.title+"成功",type:"success"}),e.editFormVisible=!1,e.editForm={type:3},e.getTS()}).catch(function(t){console.log(t),e.$message({message:e.title+"失败",type:"error"}),e.editFormVisible=!1,e.editForm={type:3}}):Object(s.a)({url:c+"/source/updatesourceid",method:"post",data:e.editForm}).then(function(t){e.editFormVisible=!1,e.editForm={},e.$message.success("修改成功")}).catch(function(t){console.log(t),e.$message.error("请重新提交")})})},callFather:function(e){this.pageparm.pageNo=e.pageNo,this.pageparm.pageSize=e.pageSize},closeDialog:function(){this.editFormVisible=!1,this.editForm={}},handleCarNumbers:function(e){this.editForm=e,this.sid=e.sid,this.getCarNumbersBySid(e.sid),this.carNumbersVisible=!0},getCarNumbersBySid:function(e){var t=this;Object(s.a)({method:"post",url:c+"/source/selectallsourceinfo",data:w()({sid:e},this.pageparm)}).then(function(e){t.carNumbersBySid=e.data.data[0].sourceCarNumberDto,t.carNumbersInfoData=e.data.data[0].sourceCarNumberDto,t.carNumbersInfoData.sort(t.compare("carNumber")),console.log(t.carNumbersInfoData)}).catch(function(e){})},insertLongCarNumber:function(){var e=this;this.$confirm("是否提交该车号?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){if(e.selectSquareCarNumberList.length){for(var t=0;t<e.selectSquareCarNumberList.length;t++)Object(s.a)({url:c+"/source/insertsourcecarnumber",method:"post",data:{sid:e.sid,carNumber:e.selectSquareCarNumberList[t]}}).then(function(t){e.getTS(),e.getCarNumbersBySid(e.sid)}).catch(function(t){e.getTS(),e.editForm={},console.log(t),e.$message.error("请重新提交")});e.selectSquareCarNumberList=[]}else e.$message.warning("请选择车号")}).then(function(){e.updateNumber(e.sid)}).catch(function(){e.$message({type:"info",message:"已取消提交"})})},handleCarNumberForm:function(){var e=this;this.inputValue&&this.$confirm("是否提交该车号?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var t=e.inputValue;t&&(e.selectedCarNumbers.push(t),Object(s.a)({url:c+"/source/insertsourcecarnumber",method:"post",data:{sid:e.sid,carNumber:e.inputValue}}).then(function(t){e.getTS(),e.getCarNumbersBySid(e.sid),e.inputVisible=!1,e.$message.success("提交成功")}).catch(function(t){e.getTS(),e.editForm={},console.log(t),e.$message.error("请重新提交")})),e.inputValue=""}).catch(function(){e.$message({type:"info",message:"已取消提交"})})},handleClose:function(){this.carNumberComplForm={},this.carNumberComplTimeVisible=!1},handleSelectedCarNumbers:function(){this.carNumbersVisible=!1},handleCloseNumbers:function(e,t){var a=this;console.log(e),this.$confirm("此操作将永久删除, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:c+"/source/deletesourcecarnumbersid",method:"post",params:{cid:e}}).then(function(e){a.$message({message:"删除成功",type:"success"}),a.getTS()}).catch(function(e){console.log(e)})}).catch(function(){a.$message({type:"info",message:"已取消删除"})})},deleteCarNumber:function(e,t){var a=this;this.$confirm("此操作将永久删除, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:c+"/source/deletesourcecarnumbersid",method:"post",params:{cid:e}}).then(function(e){a.$message({message:"删除成功",type:"success"}),a.getCarNumbersBySid(a.sid)}).then(function(){var e=a.editForm.total;e-=1,console.log(e);var l=void 0,r=void 0,o=void 0,i=void 0,n=a.toRemoveSpacing(t.complTime);"null"==n.toLowerCase()||""==n||"N/A"==n||"未完成"==n?o=0!=e&0==(l=a.editForm.incomplTotal-1)?1:0:e==(r=a.editForm.complTotal-1)?(o=1,console.log(o)):(o=0,console.log(o)),console.log(t),console.log(e,l,r),i=w()({},a.editForm,{total:e,incomplTotal:l,complTotal:r,state:o}),"null"==n.toLowerCase()||""==n||"N/A"==n||"未完成"==n?(i=w()({},a.editForm,{total:e,incomplTotal:l,state:o}),console.log(i)):(i=w()({},a.editForm,{total:e,complTotal:r,state:o}),console.log(i)),Object(s.a)({url:c+"/source/updatesourceid",method:"post",data:w()({sid:a.sid},i)}).then(function(e){a.initPage(),a.getTS(),a.getCarNumbersBySid(a.sid)}).then(function(){Object(s.a)({method:"post",url:c+"/source/selectallsourceinfo",data:{sid:a.sid}}).then(function(e){a.editForm=e.data.data[0],console.log(a.editForm),a.initPage(),a.getTS(),a.getCarNumbersBySid(a.sid)})})})}).catch(function(){a.$message({type:"info",message:"已取消删除"})})},deleteCarNumbersInfo:function(e){this.deleteCarNumbersInfoVisible=!0,this.getCarNumbersBySid(e.sid),this.sid=e.sid,this.editForm=e},handleInputConfirm:function(e){var t=this;this.$confirm("是否提交该车号?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var a=t.inputValue;a&&(t.selectedCarNumbers.push(a),Object(s.a)({url:c+"/source/insertsourcecarnumber",method:"post",data:{sid:e.sid,carNumber:t.inputValue}}).then(function(e){t.inputVisible=!1,t.$message.success("提交成功")}).catch(function(e){console.log(e),t.$message.error("请重新提交")})),t.inputValue=""}).catch(function(){t.$message({type:"info",message:"已取消提交"})})},showInput:function(){var e=this;this.inputVisible=!0,this.$nextTick(function(t){e.$refs.saveTagInput.$refs.input.focus()})},editCarNumber:function(e,t){this.carNumberComplForm=e,this.sid=t.sid},handleComplTime:function(){var e=this;this.carNumberComplTimeVisible=!1,Object(s.a)({url:c+"/source/updatesourcecarnumber",method:"post",data:this.carNumberComplForm}).then(function(t){e.getTS()}).then(function(){})},exportSourceExcel:function(){var e=c+"/source/exportsource?";for(var t in this.pageparm)this.pageparm[t]&&(e+=t+"="+this.pageparm[t]+"&");s.a.get(e).then(function(t){window.location.href=e})},exportSourceFinalExcel:function(){var e=c+"/source/exportsourcefinaltechnologysquare?";for(var t in this.pageparm||0==this.pageparm[t])this.pageparm[t]&&(e+=t+"="+this.pageparm[t]+"&");s.a.get(e).then(function(t){window.location.href=e})},handleSourceExceed:function(e,t){this.$message.warning("当前限制选择文件个数，本次选择了 "+e.length+" 个文件，共选择了 "+(e.length+t.length)+" 个文件")},handleSourceSuccess:function(){this.getTS(),this.$message.success("导入成功")},handleError:function(){this.getFault(),this.$message.error("导入格式错误，请修改后重新导入！")},handleCarNumbersInfo:function(e){this.carNumbersInfoVisible=!0,this.getCarNumbersBySid(e.sid),this.sid=e.sid,this.editForm=e},enditComplTime:function(){this.ComplTimeVisible=!1},editComplTime:function(e){var t=this;Object(s.a)({url:c+"/source/updatesourcecarnumber",method:"post",data:{cid:e.cid,complTime:e.complTime}}).then(function(e){t.search(),t.$message.success("提交成功")}).then(function(){t.updateNumber(t.sid)})},deleteSourceInfoBySID:function(e){var t=this;Object(s.a)({url:c+"/source/deletesourceinfosid",method:"post",params:{sid:e}}).then(function(e){t.$message.success("删除成功"),t.getTS()}).catch(function(e){t.$message.error("删除失败")})},toRemoveSpacing:function(e){if("string"==typeof e)var t=e.replace(/[\t\r\f\n\s]*/g,"");return t},updateNumber:function(e){var t=this;Object(s.a)({method:"post",url:c+"/source/selectallsourceinfo",data:{sid:e}}).then(function(e){console.log(e.data.data[0].sourceCarNumberDto);var a=e.data.data[0].sourceCarNumberDto,l=e.data.data[0].sourceCarNumberDto.length;t.updateTotal=l,console.log("total",l);for(var r=0,o=0,i=0;i<l;i++){var n=t.toRemoveSpacing(a[i].complTime);"null"==n.toLowerCase()||""==n||"N/A"==n||"未完成"==n?r+=1:o+=1}console.log("incoml",r),t.updateIncompl=r,t.updateCompl=o}).then(function(){delete t.editForm.total,delete t.editForm.complTotal,delete t.editForm.incompl;var a=void 0;a=0==t.updateIncompl&0!=t.updateTotal?1:0,Object(s.a)({url:c+"/source/updatesourceid",method:"post",data:w()({sid:e},t.editForm,{total:t.updateTotal,incomplTotal:t.updateIncompl,complTotal:t.updateCompl,state:a})}).then(function(e){t.editFormVisible=!1,t.search(),t.getCarNumbersBySid(t.sid)}).catch(function(e){console.log(e)})})},changeDimension:function(e,t){var a=this;this.$confirm("是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:" "+c+"/source/changedimension",params:{sid:e,dimension:t}}).then(function(e){a.$message.success("成功"),a.search()}).catch(function(e){a.$message.error("失败")})}).catch(function(){a.$message({type:"info",message:"已取消"})})},rowStyle:function(e){if(1==e.row.dimension)return{background:"antiquewhite"}},rowCarStyle:function(e){if(1==e.row.concern)return{background:"antiquewhite"}},changeCarConcern:function(e,t){var a=this;this.$confirm("是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:" "+c+"/source/changeconcern",params:{cid:e,concern:t}}).then(function(e){a.$message.success("标注成功"),a.getTS(),a.getCarNumbersBySid(a.sid),a.search()}).catch(function(e){a.getTS(),a.getCarNumbersBySid(a.sid),a.$message.error("标注失败")})}).catch(function(){a.$message({type:"info",message:"已取消"})})},closeCarNumbersInfoVisible:function(){this.carNumbersInfoVisible=!1,this.carNumbersInfoData=[]}}},pt={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:6}},[a("div",{staticClass:"grid-content bg-purple"},[a("el-button",{attrs:{size:"small",type:"warning",icon:"el-icon-star-on"},on:{click:function(t){return e.exportSourceFinalExcel()}}},[e._v("导出")])],1)])],1),e._v(" "),a("el-form",{ref:"searchForm",staticClass:"user-search",attrs:{inline:!0,model:e.pageparm}},[a("el-form-item",{attrs:{label:"标注",prop:"dimension"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.pageparm.dimension,callback:function(t){e.$set(e.pageparm,"dimension",t)},expression:"pageparm.dimension"}},[a("el-option",{attrs:{label:"非重点关注",value:"0"}}),e._v(" "),a("el-option",{attrs:{label:"重点关注",value:"1"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"文号",prop:"motorDocumentNumber"}},[a("el-input",{attrs:{placeholder:"输入文号"},model:{value:e.pageparm.motorDocumentNumber,callback:function(t){e.$set(e.pageparm,"motorDocumentNumber",t)},expression:"pageparm.motorDocumentNumber"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"项目名称",prop:"entryName"}},[a("el-input",{attrs:{placeholder:"输入项目名称"},model:{value:e.pageparm.entryName,callback:function(t){e.$set(e.pageparm,"entryName",t)},expression:"pageparm.entryName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"项目完成情况",prop:"state"}},[a("el-select",{attrs:{placeholder:"请选择项目完成情况"},model:{value:e.pageparm.state,callback:function(t){e.$set(e.pageparm,"state",t)},expression:"pageparm.state"}},[a("el-option",{attrs:{label:"已完成",value:1}}),e._v(" "),a("el-option",{attrs:{label:"未完成",value:0}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"车号",prop:"carNumber"}},[a("el-select",{attrs:{multiple:"",filterable:"",placeholder:"请选择车号"},model:{value:e.carNumbers,callback:function(t){e.carNumbers=t},expression:"carNumbers"}},e._l(e.squareCarNumberList,function(e){return a("el-option",{key:e.value,attrs:{label:e.value,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"车号完成情况",prop:"complTime"}},[a("el-select",{attrs:{placeholder:"请选择车号完成情况"},model:{value:e.pageparm.complTime,callback:function(t){e.$set(e.pageparm,"complTime",t)},expression:"pageparm.complTime"}},[a("el-option",{attrs:{label:"已完成",value:"已完成"}}),e._v(" "),a("el-option",{attrs:{label:"未完成",value:"未完成"}})],1)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-search"},on:{click:function(t){return e.search()}}},[e._v("搜索")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-refresh-right"},on:{click:function(t){return e.resetForm("searchForm")}}},[e._v("重置")])],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"",height:"650","row-style":e.rowStyle}},[a("el-table-column",{attrs:{type:"index",label:"序号",align:"center",width:"70",index:e.indexMethod,fixed:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"motorDocumentNumber",label:"文号",width:"120",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"entryName",label:"项目名称",width:"200",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"total",label:"总数",align:"center",width:"70"}}),e._v(" "),a("el-table-column",{attrs:{prop:"complTotal",label:"已完成",width:"70",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"incomplTotal",label:"未完成",width:"70",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"carNumbers",label:"车号",align:"center",width:"280"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.sourceCarNumberDto,function(t){return a("div",{key:t.cid,staticStyle:{display:"inline-block"}},["未完成"==t.complTime&0==t.concern?a("el-tag",{attrs:{type:"info"}},[e._v(e._s(t.carNumber))]):"未完成"!=t.complTime&0==t.concern?a("el-tag",{attrs:{type:"success"}},[e._v(e._s(t.carNumber))]):a("el-tag",{attrs:{type:"warning"}},[e._v(e._s(t.carNumber))])],1)})}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"note",label:"备注",align:"center",width:"220"}}),e._v(" "),a("el-table-column",{attrs:{prop:"",label:"查看车号信息",width:"180",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("el-button",{attrs:{type:"primary",icon:"el-icon-circle-plus",circle:""},on:{click:function(a){return e.handleCarNumbersInfo(t.row)}}})],1)]}}])})],1),e._v(" "),a("el-dialog",{attrs:{title:"查看车号",visible:e.carNumbersInfoVisible,width:"50%","before-close":e.closeCarNumbersInfoVisible},on:{"update:visible":function(t){e.carNumbersInfoVisible=t}}},[a("div",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.carNumbersInfoData,border:"",height:"500","row-style":e.rowCarStyle}},[a("el-table-column",{attrs:{type:"index",label:"序号",align:"center",width:"70",index:e.indexMethod,fixed:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"carNumber",label:"车号",width:"180",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"complTime",label:"完成时间",width:"240",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{ref:"saveTagInput",staticClass:"input-new-tag",attrs:{disabled:"",type:"textarea"},on:{blur:function(a){return e.editComplTime(t.row)}},model:{value:t.row.complTime,callback:function(a){e.$set(t.row,"complTime",a)},expression:"scope.row.complTime"}})]}}])})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){return e.closeCarNumbersInfoVisible()}}},[e._v("取 消")])],1)])],1)},staticRenderFns:[]};var dt=a("VU/8")(mt,pt,!1,function(e){a("kuU9")},"data-v-32895f0e",null).exports,ht={name:"techlong",data:function(){var e;return e={baseURL:c,longCarNumberList:qe,carNumberList:S,classCarNumbers:R,selectLongCarNumberList:[],sid:0,carNumbers:[],tableData:[],loading:!1,pageparm:{type:4,pageNo:1,pageSize:1e5},pageparmcar:{},editFormVisible:!1,title:"编辑",editForm:{type:4},total:0},x()(e,"loading",!1),x()(e,"carNumbersVisible",!1),x()(e,"props",{multiple:!0}),x()(e,"selectedCarNumbers",[]),x()(e,"inputVisible",!1),x()(e,"inputValue",""),x()(e,"carNumberComplTimeVisible",!1),x()(e,"carNumberComplForm",{}),x()(e,"carNumbersBySid",[]),x()(e,"carNumbersInfoVisible",!1),x()(e,"carNumbersInfoData",[]),x()(e,"ComplTimeVisible",!0),x()(e,"updateTotal",0),x()(e,"updateIncompl",0),x()(e,"updateCompl",0),x()(e,"deleteCarNumbersInfoVisible",!1),e},computed:{indexMethod:function(){return(this.pageparm.pageNo-1)*this.pageparm.pageSize+1}},created:function(){this.getTL()},methods:{search:function(){var e=this;this.carNumbers.length&&(this.pageparm.carNumbers=this.carNumbers),this.loading=!0,Object(s.a)({method:"post",url:c+"/source/selectallsourceinfo",data:this.pageparm}).then(function(t){var a=t.data.data;a=a.map(function(t){return t.sourceCarNumberDto.sort(e.compare("carNumber")),t}),e.tableData=a,e.loading=!1,e.$message.success("搜索成功")}).catch(function(t){e.initPage(),e.$message.error("搜索失败"),console.log(t)})},resetForm:function(e){this.$refs[e].resetFields(),this.carNumbers=[],this.pageparm.carNumbers&&delete this.pageparm.carNumbers},initPage:function(){this.pageparm={pageNo:1,pageSize:1e5,type:4}},getTL:function(){var e=this;Object(s.a)({url:c+"/source/selectallsourceinfo",method:"post",data:this.pageparm}).then(function(t){var a=t.data.data;a=a.map(function(t){return t.sourceCarNumberDto.sort(e.compare("carNumber")),t}),e.tableData=a,e.loading=!1}).catch(function(e){console.log(e)})},compare:function(e){return function(t,a){return t[e]-a[e]}},handleEdit:function(e,t){this.editFormVisible=!0,void 0!=t&&"undefined"!=t?(this.title="修改",this.editForm=t):(this.title="添加",this.editForm={})},changeResult:function(){this.editForm.result=""},handelSource:function(){var e=this;this.$refs.editForm.validate(function(t){if(!t)return console.log("提交失败"),!1;"添加"==e.title?Object(s.a)({url:c+"/source/insertsource",method:"post",data:w()({},e.editForm,{type:4})}).then(function(t){e.$message({message:e.title+"成功",type:"success"}),e.editFormVisible=!1,e.editForm={type:4},e.getTL()}).catch(function(t){console.log(t),e.$message({message:e.title+"失败",type:"error"}),e.editFormVisible=!1,e.editForm={type:4}}):Object(s.a)({url:c+"/source/updatesourceid",method:"post",data:e.editForm}).then(function(t){e.editFormVisible=!1,e.editForm={},e.$message.success("修改成功")}).catch(function(t){console.log(t),e.$message.error("请重新提交")})})},closeDialog:function(){this.editFormVisible=!1,this.editForm={}},handleCarNumbers:function(e){this.editForm=e,this.sid=e.sid,this.getCarNumbersBySid(e.sid),this.carNumbersVisible=!0},getCarNumbersBySid:function(e){var t=this;Object(s.a)({method:"post",url:c+"/source/selectallsourceinfo",data:w()({sid:e},this.pageparm)}).then(function(e){t.carNumbersBySid=e.data.data[0].sourceCarNumberDto,t.carNumbersInfoData=e.data.data[0].sourceCarNumberDto,console.log(t.carNumbersInfoData),t.carNumbersInfoData.sort(t.compare("carNumber")),console.log(t.carNumbersInfoData)}).catch(function(e){})},insertLongCarNumber:function(){var e=this;this.$confirm("是否提交该车号?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){if(e.selectLongCarNumberList.length){for(var t=0;t<e.selectLongCarNumberList.length;t++)Object(s.a)({url:c+"/source/insertsourcecarnumber",method:"post",data:{sid:e.sid,carNumber:e.selectLongCarNumberList[t]}}).then(function(t){e.getTL(),e.getCarNumbersBySid(e.sid)}).catch(function(t){e.getTL(),e.getCarNumbersBySid(e.sid),console.log(t),e.$message.error("请重新提交")});e.selectLongCarNumberList=[]}else e.$message.warning("请选择车号")}).then(function(){e.updateNumber(e.sid)}).catch(function(){e.$message({type:"info",message:"已取消提交"})})},toRemoveSpacing:function(e){if("string"==typeof e)var t=e.replace(/[\t\r\f\n\s]*/g,"");return t},updateNumber:function(e){var t=this;Object(s.a)({method:"post",url:c+"/source/selectallsourceinfo",data:{sid:e}}).then(function(e){var a=e.data.data[0].sourceCarNumberDto;console.log(e.data.data[0].sourceCarNumberDto);var l=a.length;console.log(l),t.updateTotal=l,console.log("total",l);for(var r=0,o=0,i=0;i<l;i++){var n=t.toRemoveSpacing(a[i].complTime);"null"==n.toLowerCase()||""==n||"N/A"==n||"未完成"==n?r+=1:o+=1}console.log("incoml",r),t.updateIncompl=r,t.updateCompl=o}).then(function(){var a=void 0;a=0==t.updateIncompl&0!=t.updateTotal?1:0,Object(s.a)({url:c+"/source/updatesourceid",method:"post",data:w()({sid:e},t.editForm,{total:t.updateTotal,incomplTotal:t.updateIncompl,complTotal:t.updateCompl,state:a})}).then(function(e){t.editFormVisible=!1,t.search(),t.getCarNumbersBySid(t.sid)}).catch(function(e){console.log(e)})})},handleCarNumberForm:function(){var e=this;this.inputValue&&this.$confirm("是否提交该车号?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var t=e.inputValue;t&&(e.selectedCarNumbers.push(t),Object(s.a)({url:c+"/source/insertsourcecarnumber",method:"post",data:{sid:e.sid,carNumber:e.inputValue}}).then(function(t){e.getTL(),e.getCarNumbersBySid(e.sid),e.inputVisible=!1,e.$message.success("提交成功")}).catch(function(t){e.getTL(),e.editForm={},console.log(t),e.$message.error("请重新提交")})),e.inputValue=""}).catch(function(){e.$message({type:"info",message:"已取消提交"})})},handleClose:function(e){this.carNumberComplForm={},this.carNumberComplTimeVisible=!1},handleSelectedCarNumbers:function(){this.carNumbersVisible=!1},handleCloseNumbers:function(e,t){var a=this;this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:c+"/source/deletesourcecarnumbersid",method:"post",params:{cid:e}}).then(function(e){a.$message({message:"删除成功",type:"success"}),a.getTL()}).catch(function(e){console.log(e)})}).catch(function(){a.$message({type:"info",message:"已取消删除"})})},deleteCarNumber:function(e,t){var a=this;this.$confirm("此操作将永久删除, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:c+"/source/deletesourcecarnumbersid",method:"post",params:{cid:e}}).then(function(e){a.$message({message:"删除成功",type:"success"}),a.getCarNumbersBySid(a.sid)}).then(function(){var e=a.editForm.total;e-=1,console.log(e);var l=void 0,r=void 0,o=void 0,i=void 0,n=a.toRemoveSpacing(t.complTime);"null"==n.toLowerCase()||""==n||"N/A"==n||"未完成"==n?o=0!=e&0==(l=a.editForm.incomplTotal-1)?1:0:e==(r=a.editForm.complTotal-1)?(o=1,console.log(o)):(o=0,console.log(o)),console.log(t),console.log(e,l,r),i=w()({},a.editForm,{total:e,incomplTotal:l,complTotal:r,state:o}),"null"==n.toLowerCase()||""==n||"N/A"==n||"未完成"==n?(i=w()({},a.editForm,{total:e,incomplTotal:l,state:o}),console.log(i)):(i=w()({},a.editForm,{total:e,complTotal:r,state:o}),console.log(i)),Object(s.a)({url:c+"/source/updatesourceid",method:"post",data:w()({sid:a.sid},i)}).then(function(e){a.initPage(),a.getTL(),a.getCarNumbersBySid(a.sid)}).then(function(){Object(s.a)({method:"post",url:c+"/source/selectallsourceinfo",data:{sid:a.sid}}).then(function(e){a.editForm=e.data.data[0],a.initPage(),a.getTL(),a.getCarNumbersBySid(a.sid)})})})}).catch(function(){a.$message({type:"info",message:"已取消删除"})})},handleInputConfirm:function(e){var t=this;this.$confirm("是否提交该车号?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var a=t.inputValue;a&&(t.selectedCarNumbers.push(a),Object(s.a)({url:c+"/source/insertsourcecarnumber",method:"post",data:{sid:e.sid,carNumber:t.inputValue}}).then(function(e){t.inputVisible=!1,t.$message.success("提交成功")}).catch(function(e){console.log(e),t.$message.error("请重新提交")})),t.inputValue=""}).catch(function(){t.$message({type:"info",message:"已取消提交"})})},showInput:function(){var e=this;this.inputVisible=!0,this.$nextTick(function(t){e.$refs.saveTagInput.$refs.input.focus()})},editCarNumber:function(e,t){this.editForm=t,console.log(e,t),this.carNumberComplForm=e,this.sid=t.sid},handleComplTime:function(){var e=this;this.carNumberComplTimeVisible=!1,Object(s.a)({url:c+"/source/updatesourcecarnumber",method:"post",data:this.carNumberComplForm}).then(function(t){e.getTL()})},exportSourceExcel:function(){var e=c+"/source/exportsource?";for(var t in this.pageparm)this.pageparm[t]&&(e+=t+"="+this.pageparm[t]+"&");s.a.get(e).then(function(t){console.log(e),window.location.href=e})},exportSourceFinalExcel:function(){var e=c+"/source/exportsourcefinaltechnologylong?";for(var t in this.pageparm||0==this.pageparm[t])this.pageparm[t]&&(e+=t+"="+this.pageparm[t]+"&");s.a.get(e).then(function(t){console.log(e),window.location.href=e})},handleSourceExceed:function(e,t){this.$message.warning("当前限制选择文件个数，本次选择了 "+e.length+" 个文件，共选择了 "+(e.length+t.length)+" 个文件")},handleSourceSuccess:function(){this.getTL(),this.$message.success("导入成功")},handleError:function(){this.$message.error("导入格式错误，请修改后重新导入！")},handleCarNumbersInfo:function(e){this.carNumbersInfoVisible=!0,this.getCarNumbersBySid(e.sid),this.sid=e.sid,this.editForm=e},deleteCarNumbersInfo:function(e){this.deleteCarNumbersInfoVisible=!0,this.getCarNumbersBySid(e.sid),this.sid=e.sid,this.editForm=e},enditComplTime:function(){this.ComplTimeVisible=!1},editComplTime:function(e){var t=this;Object(s.a)({url:c+"/source/updatesourcecarnumber",method:"post",data:{cid:e.cid,complTime:e.complTime}}).then(function(e){t.getTL(),t.$message.success("提交成功")}).then(function(){t.updateNumber(t.sid)})},deleteSourceInfoBySID:function(e){var t=this;Object(s.a)({url:c+"/source/deletesourceinfosid",method:"post",params:{sid:e}}).then(function(e){t.$message.success("删除成功"),t.getTL()}).catch(function(e){t.$message.error("删除失败")})},changeDimension:function(e,t){var a=this;this.$confirm("是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:" "+c+"/source/changedimension",params:{sid:e,dimension:t}}).then(function(e){a.$message.success("成功"),a.search()}).catch(function(e){a.$message.error("失败")})}).catch(function(){a.$message({type:"info",message:"已取消"})})},rowStyle:function(e){if(1==e.row.dimension)return{background:"antiquewhite"}},rowCarStyle:function(e){if(1==e.row.concern)return{background:"antiquewhite"}},changeCarConcern:function(e,t){var a=this;this.$confirm("是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:" "+c+"/source/changeconcern",params:{cid:e,concern:t}}).then(function(e){a.$message.success("标注成功"),a.getTL(),a.getCarNumbersBySid(a.sid),a.search()}).catch(function(e){a.getTL(),a.getCarNumbersBySid(a.sid),a.search(),a.$message.error("标注失败")})}).catch(function(){a.$message({type:"info",message:"已取消"})})},closeCarNumbersInfoVisible:function(){this.carNumbersInfoVisible=!1,this.carNumbersInfoData=[]}}},gt={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:6}},[a("div",{staticClass:"grid-content bg-purple"},[a("el-button",{attrs:{size:"small",type:"warning",icon:"el-icon-star-on"},on:{click:function(t){return e.exportSourceFinalExcel()}}},[e._v("导出")])],1)])],1),e._v(" "),a("el-form",{ref:"searchForm",staticClass:"user-search",attrs:{inline:!0,model:e.pageparm}},[a("el-form-item",{attrs:{label:"标注",prop:"dimension"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.pageparm.dimension,callback:function(t){e.$set(e.pageparm,"dimension",t)},expression:"pageparm.dimension"}},[a("el-option",{attrs:{label:"非重点关注",value:"0"}}),e._v(" "),a("el-option",{attrs:{label:"重点关注",value:"1"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"文号",prop:"motorDocumentNumber"}},[a("el-input",{attrs:{placeholder:"输入文号"},model:{value:e.pageparm.motorDocumentNumber,callback:function(t){e.$set(e.pageparm,"motorDocumentNumber",t)},expression:"pageparm.motorDocumentNumber"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"项目名称",prop:"entryName"}},[a("el-input",{attrs:{placeholder:"输入项目名称"},model:{value:e.pageparm.entryName,callback:function(t){e.$set(e.pageparm,"entryName",t)},expression:"pageparm.entryName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"项目完成情况",prop:"state"}},[a("el-select",{attrs:{placeholder:"请选择项目完成情况"},model:{value:e.pageparm.state,callback:function(t){e.$set(e.pageparm,"state",t)},expression:"pageparm.state"}},[a("el-option",{attrs:{label:"已完成",value:1}}),e._v(" "),a("el-option",{attrs:{label:"未完成",value:0}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"车号",prop:"carNumber"}},[a("el-select",{attrs:{multiple:"",filterable:"",placeholder:"请选择车号"},model:{value:e.carNumbers,callback:function(t){e.carNumbers=t},expression:"carNumbers"}},e._l(e.longCarNumberList,function(e){return a("el-option",{key:e.value,attrs:{label:e.value,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"车号完成情况",prop:"complTime"}},[a("el-select",{attrs:{placeholder:"请选择车号完成情况"},model:{value:e.pageparm.complTime,callback:function(t){e.$set(e.pageparm,"complTime",t)},expression:"pageparm.complTime"}},[a("el-option",{attrs:{label:"已完成",value:"已完成"}}),e._v(" "),a("el-option",{attrs:{label:"未完成",value:"未完成"}})],1)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-search"},on:{click:function(t){return e.search()}}},[e._v("搜索")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-refresh-right"},on:{click:function(t){return e.resetForm("searchForm")}}},[e._v("重置")])],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"",height:"650","row-style":e.rowStyle}},[a("el-table-column",{attrs:{type:"index",label:"序号",align:"center",width:"70",index:e.indexMethod,fixed:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"motorDocumentNumber",label:"文号",width:"120",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"entryName",label:"项目名称",width:"200",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"total",label:"总数",align:"center",width:"70"}}),e._v(" "),a("el-table-column",{attrs:{prop:"complTotal",label:"已完成",width:"70",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"incomplTotal",label:"未完成",width:"70",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"carNumbers",label:"车号",align:"center",width:"280"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.sourceCarNumberDto,function(t){return a("div",{key:t.cid,staticStyle:{display:"inline-block"}},["未完成"==t.complTime&0==t.concern?a("el-tag",{attrs:{type:"info"}},[e._v(e._s(t.carNumber))]):"未完成"!=t.complTime&0==t.concern?a("el-tag",{attrs:{type:"success"}},[e._v(e._s(t.carNumber))]):a("el-tag",{attrs:{type:"warning"}},[e._v(e._s(t.carNumber))])],1)})}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"note",label:"备注",align:"center",width:"220"}}),e._v(" "),a("el-table-column",{attrs:{prop:"",label:"查看车号信息",width:"180",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("el-button",{attrs:{type:"primary",icon:"el-icon-circle-plus",circle:""},on:{click:function(a){return e.handleCarNumbersInfo(t.row)}}})],1)]}}])})],1),e._v(" "),a("el-dialog",{attrs:{title:"查看车号",visible:e.carNumbersInfoVisible,width:"50%","before-close":e.closeCarNumbersInfoVisible},on:{"update:visible":function(t){e.carNumbersInfoVisible=t}}},[a("div",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.carNumbersInfoData,border:"",height:"500","row-style":e.rowCarStyle}},[a("el-table-column",{attrs:{type:"index",label:"序号",align:"center",width:"70",index:e.indexMethod,fixed:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"carNumber",label:"车号",width:"180",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"complTime",label:"完成时间",width:"240",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{ref:"saveTagInput",staticClass:"input-new-tag",attrs:{disabled:"",type:"textarea"},on:{blur:function(a){return e.editComplTime(t.row)}},model:{value:t.row.complTime,callback:function(a){e.$set(t.row,"complTime",a)},expression:"scope.row.complTime"}})]}}])})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){return e.closeCarNumbersInfoVisible()}}},[e._v("取 消")])],1)])],1)},staticRenderFns:[]};var ft=a("VU/8")(ht,gt,!1,function(e){a("7ltE")},"data-v-245ccfc6",null).exports,bt={name:"qualityConcentra",inject:["reload"],data:function(){var e;return e={baseURL:c,carNumberList:S,longCarNumberList:qe,selectLongCarNumberList:[],classCarNumbers:R,sid:0,carNumbers:[],tableData:[],loading:!1,pageparm:{type:5,pageNo:1,pageSize:1e5},pageparmcar:{},editFormVisible:!1,title:"编辑",editForm:{type:5},total:0},x()(e,"loading",!1),x()(e,"carNumbersVisible",!1),x()(e,"props",{multiple:!0}),x()(e,"selectedCarNumbers",[]),x()(e,"inputVisible",!1),x()(e,"inputValue",""),x()(e,"carNumberComplTimeVisible",!1),x()(e,"carNumberComplForm",{}),x()(e,"carNumbersBySid",[]),x()(e,"carNumbersInfoVisible",!1),x()(e,"carNumbersInfoData",[]),x()(e,"ComplTimeVisible",!0),x()(e,"updateTotal",0),x()(e,"updateIncompl",0),x()(e,"updateCompl",0),x()(e,"deleteCarNumbersInfoVisible",!1),e},computed:{indexMethod:function(){return(this.pageparm.pageNo-1)*this.pageparm.pageSize+1}},created:function(){this.getQL()},methods:{search:function(){var e=this;this.carNumbers.length&&(this.pageparm.carNumbers=this.carNumbers),this.loading=!0,Object(s.a)({method:"post",url:c+"/source/selectallsourceinfo",data:this.pageparm}).then(function(t){var a=t.data.data;a=a.map(function(t){return t.sourceCarNumberDto.sort(e.compare("carNumber")),t}),e.tableData=a,e.loading=!1,e.$message.success("搜索成功")}).catch(function(t){e.initPage(),e.$message.error("搜索失败"),console.log(t)})},resetForm:function(e){this.$refs[e].resetFields(),this.carNumbers=[],this.pageparm.carNumbers&&delete this.pageparm.carNumbers},initPage:function(){this.pageparm={pageNo:1,pageSize:1e5,type:5}},getQL:function(){var e=this;Object(s.a)({url:c+"/source/selectallsourceinfo",method:"post",data:this.pageparm}).then(function(t){var a=t.data.data;a=a.map(function(t){return t.sourceCarNumberDto.sort(e.compare("carNumber")),t}),e.tableData=a,e.loading=!1}).catch(function(e){console.log(e)})},compare:function(e){return function(t,a){return t[e]-a[e]}},handleEdit:function(e,t){this.editFormVisible=!0,void 0!=t&&"undefined"!=t?(this.title="修改",this.editForm=t):(this.title="添加",this.editForm={})},changeResult:function(){this.editForm.result=""},handelSource:function(){var e=this;this.$refs.editForm.validate(function(t){if(!t)return console.log("提交失败"),!1;"添加"==e.title?Object(s.a)({url:c+"/source/insertsource",method:"post",data:w()({},e.editForm,{type:5})}).then(function(t){e.$message({message:e.title+"成功",type:"success"}),e.editFormVisible=!1,e.editForm={type:5},e.getQL()}).catch(function(t){console.log(t),e.$message({message:e.title+"失败",type:"error"}),e.editFormVisible=!1,e.editForm={type:5}}):Object(s.a)({url:c+"/source/updatesourceid",method:"post",data:e.editForm}).then(function(t){e.editFormVisible=!1,e.editForm={},e.$message.success("修改成功")}).catch(function(t){console.log(t),e.$message.error("请重新提交")})})},closeDialog:function(){this.editFormVisible=!1,this.editForm={}},handleCarNumbers:function(e){this.editForm=e,this.sid=e.sid,this.getCarNumbersBySid(e.sid),this.carNumbersVisible=!0},getCarNumbersBySid:function(e){var t=this;Object(s.a)({method:"post",url:c+"/source/selectallsourceinfo",data:w()({sid:e},this.pageparm)}).then(function(e){t.carNumbersBySid=e.data.data[0].sourceCarNumberDto,t.carNumbersInfoData=e.data.data[0].sourceCarNumberDto,t.carNumbersInfoData.sort(t.compare("carNumber"))}).catch(function(e){})},insertLongCarNumber:function(){var e=this;this.$confirm("是否提交该车号?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){if(e.selectLongCarNumberList.length){for(var t=0;t<e.selectLongCarNumberList.length;t++)Object(s.a)({url:c+"/source/insertsourcecarnumber",method:"post",data:{sid:e.sid,carNumber:e.selectLongCarNumberList[t]}}).then(function(t){e.getQL(),e.getCarNumbersBySid(e.sid)}).catch(function(t){e.getQL(),e.editForm={},console.log(t),e.$message.error("请重新提交")});e.selectLongCarNumberList=[]}else e.$message.warning("请选择车号")}).then(function(){e.updateNumber(e.sid)}).catch(function(){e.$message({type:"info",message:"已取消提交"})})},toRemoveSpacing:function(e){if("string"==typeof e)var t=e.replace(/[\t\r\f\n\s]*/g,"");return t},updateNumber:function(e){var t=this;Object(s.a)({method:"post",url:c+"/source/selectallsourceinfo",data:{sid:e}}).then(function(e){console.log(e.data.data[0].sourceCarNumberDto);var a=e.data.data[0].sourceCarNumberDto,l=e.data.data[0].sourceCarNumberDto.length;t.updateTotal=l,console.log("total",l);for(var r=0,o=0,i=0;i<l;i++){var n=t.toRemoveSpacing(a[i].complTime);"null"==n.toLowerCase()||""==n||"N/A"==n||"未完成"==n?r+=1:o+=1}console.log("incoml",r),t.updateIncompl=r,t.updateCompl=o}).then(function(){var a=void 0;a=0==t.updateIncompl&0!=t.updateTotal?1:0,Object(s.a)({url:c+"/source/updatesourceid",method:"post",data:w()({sid:e},t.editForm,{total:t.updateTotal,incomplTotal:t.updateIncompl,complTotal:t.updateCompl,state:a})}).then(function(e){t.editFormVisible=!1,t.search(),t.getCarNumbersBySid(t.sid)}).catch(function(e){console.log(e)})})},handleCarNumberForm:function(){var e=this;this.inputValue&&this.$confirm("是否提交该车号?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var t=e.inputValue;t&&(e.selectedCarNumbers.push(t),Object(s.a)({url:c+"/source/insertsourcecarnumber",method:"post",data:{sid:e.sid,carNumber:e.inputValue}}).then(function(t){e.getQL(),e.getCarNumbersBySid(e.sid),e.inputVisible=!1,e.$message.success("提交成功")}).catch(function(t){e.getQL(),e.editForm={},console.log(t),e.$message.error("请重新提交")})),e.inputValue=""}).catch(function(){e.$message({type:"info",message:"已取消提交"})})},deleteCarNumbersInfo:function(e){this.deleteCarNumbersInfoVisible=!0,this.getCarNumbersBySid(e.sid),this.sid=e.sid,this.editForm=e},handleClose:function(e){this.carNumberComplForm={},this.carNumberComplTimeVisible=!1},handleSelectedCarNumbers:function(){this.carNumbersVisible=!1},handleCloseNumbers:function(e,t){var a=this;this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:c+"/source/deletesourcecarnumbersid",method:"post",params:{cid:e}}).then(function(e){a.$message({message:"删除成功",type:"success"}),a.getQL()}).catch(function(e){console.log(e)})}).catch(function(){a.$message({type:"info",message:"已取消删除"})})},deleteCarNumber:function(e,t){var a=this;this.$confirm("此操作将永久删除, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:c+"/source/deletesourcecarnumbersid",method:"post",params:{cid:e}}).then(function(e){a.$message({message:"删除成功",type:"success"}),a.getCarNumbersBySid(a.sid)}).then(function(){var e=a.editForm.total;e-=1,console.log(e);var l=void 0,r=void 0,o=void 0,i=void 0,n=a.toRemoveSpacing(t.complTime);"null"==n.toLowerCase()||""==n||"N/A"==n||"未完成"==n?o=0!=e&0==(l=a.editForm.incomplTotal-1)?1:0:e==(r=a.editForm.complTotal-1)?(o=1,console.log(o)):(o=0,console.log(o)),console.log(t),console.log(e,l,r),i=w()({},a.editForm,{total:e,incomplTotal:l,complTotal:r,state:o}),"null"==n.toLowerCase()||""==n||"N/A"==n||"未完成"==n?(i=w()({},a.editForm,{total:e,incomplTotal:l,state:o}),console.log(i)):(i=w()({},a.editForm,{total:e,complTotal:r,state:o}),console.log(i)),Object(s.a)({url:c+"/source/updatesourceid",method:"post",data:w()({sid:a.sid},i)}).then(function(e){a.initPage(),a.getQL(),a.getCarNumbersBySid(a.sid)}).then(function(){Object(s.a)({method:"post",url:c+"/source/selectallsourceinfo",data:{sid:a.sid}}).then(function(e){a.editForm=e.data.data[0],console.log(a.editForm),a.initPage(),a.getQL(),a.getCarNumbersBySid(a.sid)})})})}).catch(function(){a.$message({type:"info",message:"已取消删除"})})},handleInputConfirm:function(e){var t=this;this.$confirm("是否提交该车号?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var a=t.inputValue;a&&(t.selectedCarNumbers.push(a),Object(s.a)({url:c+"/source/insertsourcecarnumber",method:"post",data:{sid:e.sid,carNumber:t.inputValue}}).then(function(e){t.inputVisible=!1,t.$message.success("提交成功")}).catch(function(e){console.log(e),t.$message.error("请重新提交")})),t.inputValue=""}).catch(function(){t.$message({type:"info",message:"已取消提交"})})},showInput:function(){var e=this;this.inputVisible=!0,this.$nextTick(function(t){e.$refs.saveTagInput.$refs.input.focus()})},editCarNumber:function(e,t){this.carNumberComplForm=e},handleComplTime:function(){var e=this;this.carNumberComplTimeVisible=!1,Object(s.a)({url:c+"/source/updatesourcecarnumber",method:"post",data:this.carNumberComplForm}).then(function(t){e.getQL()}).catch(function(e){})},exportSourceExcel:function(){var e=c+"/source/exportsource?";for(var t in this.pageparm)this.pageparm[t]&&(e+=t+"="+this.pageparm[t]+"&");s.a.get(e).then(function(t){console.log(e),window.location.href=e})},exportSourceFinalExcel:function(){var e=c+"/source/exportsourcefinalqualityconcentra?";for(var t in this.pageparm)(this.pageparm[t]||0==this.pageparm[t])&&(e+=t+"="+this.pageparm[t]+"&");s.a.get(e).then(function(t){window.location.href=e})},handleSourceExceed:function(e,t){this.$message.warning("当前限制选择文件个数，本次选择了 "+e.length+" 个文件，共选择了 "+(e.length+t.length)+" 个文件")},handleSourceSuccess:function(){this.getQL(),this.$message.success("导入成功")},handleError:function(){this.$message.error("导入格式错误，请修改后重新导入！")},handleCarNumbersInfo:function(e){this.carNumbersInfoVisible=!0,this.getCarNumbersBySid(e.sid),this.sid=e.sid,this.editForm=e},enditComplTime:function(){this.ComplTimeVisible=!1},editComplTime:function(e){var t=this;Object(s.a)({url:c+"/source/updatesourcecarnumber",method:"post",data:{cid:e.cid,complTime:e.complTime}}).then(function(e){t.$message.success("提交成功")}).then(function(){t.updateNumber(t.sid)})},deleteSourceInfoBySID:function(e){var t=this;Object(s.a)({url:c+"/source/deletesourceinfosid",method:"post",params:{sid:e}}).then(function(e){t.$message.success("删除成功"),t.getQL()}).catch(function(e){t.$message.error("删除失败")})},changeDimension:function(e,t){var a=this;this.$confirm("是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:" "+c+"/source/changedimension",params:{sid:e,dimension:t}}).then(function(e){a.$message.success("成功"),a.search()}).catch(function(e){a.$message.error("失败")})}).catch(function(){a.$message({type:"info",message:"已取消"})})},rowStyle:function(e){if(1==e.row.dimension)return{background:"antiquewhite"}},rowCarStyle:function(e){if(1==e.row.concern)return{background:"antiquewhite"}},changeCarConcern:function(e,t){var a=this;this.$confirm("是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:" "+c+"/source/changeconcern",params:{cid:e,concern:t}}).then(function(e){a.$message.success("标注成功"),a.getQL(),a.getCarNumbersBySid(a.sid),a.search()}).catch(function(e){a.getQL(),a.getCarNumbersBySid(a.sid),a.$message.error("标注失败")})}).catch(function(){a.$message({type:"info",message:"已取消"})})},closeCarNumbersInfoVisible:function(){this.carNumbersInfoVisible=!1,this.carNumbersInfoData=[]}}},vt={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:6}},[a("div",{staticClass:"grid-content bg-purple"},[a("el-button",{attrs:{size:"small",type:"warning",icon:"el-icon-star-on"},on:{click:function(t){return e.exportSourceFinalExcel()}}},[e._v("导出")])],1)])],1),e._v(" "),a("el-form",{ref:"searchForm",staticClass:"user-search",attrs:{inline:!0,model:e.pageparm}},[a("el-form-item",{attrs:{label:"标注",prop:"dimension"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.pageparm.dimension,callback:function(t){e.$set(e.pageparm,"dimension",t)},expression:"pageparm.dimension"}},[a("el-option",{attrs:{label:"非重点关注",value:"0"}}),e._v(" "),a("el-option",{attrs:{label:"重点关注",value:"1"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"批次",prop:"batch"}},[a("el-input",{attrs:{placeholder:"输入批次"},model:{value:e.pageparm.batch,callback:function(t){e.$set(e.pageparm,"batch",t)},expression:"pageparm.batch"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"总公司文号",prop:"headDocumentNumber"}},[a("el-input",{attrs:{placeholder:"输入总公司文号"},model:{value:e.pageparm.headDocumentNumber,callback:function(t){e.$set(e.pageparm,"headDocumentNumber",t)},expression:"pageparm.headDocumentNumber"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"路局文号",prop:"roadDocumentNumber"}},[a("el-input",{attrs:{placeholder:"输入路局文号"},model:{value:e.pageparm.roadDocumentNumber,callback:function(t){e.$set(e.pageparm,"roadDocumentNumber",t)},expression:"pageparm.roadDocumentNumber"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"申请单编号",prop:"applicNumber"}},[a("el-input",{attrs:{placeholder:"输入申请单编号"},model:{value:e.pageparm.applicNumber,callback:function(t){e.$set(e.pageparm,"applicNumber",t)},expression:"pageparm.applicNumber"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"项目名称",prop:"entryName"}},[a("el-input",{attrs:{placeholder:"输入项目名称"},model:{value:e.pageparm.entryName,callback:function(t){e.$set(e.pageparm,"entryName",t)},expression:"pageparm.entryName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"项目完成情况",prop:"state"}},[a("el-select",{attrs:{placeholder:"请选择项目完成情况"},model:{value:e.pageparm.state,callback:function(t){e.$set(e.pageparm,"state",t)},expression:"pageparm.state"}},[a("el-option",{attrs:{label:"已完成",value:1}}),e._v(" "),a("el-option",{attrs:{label:"未完成",value:0}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"车号",prop:"carNumber"}},[a("el-select",{attrs:{multiple:"",filterable:"",placeholder:"请选择车号"},model:{value:e.carNumbers,callback:function(t){e.carNumbers=t},expression:"carNumbers"}},[a("el-option",{attrs:{label:"2048",value:2048}}),e._v(" "),a("el-option",{attrs:{label:"2049",value:2049}}),e._v(" "),a("el-option",{attrs:{label:"2050",value:2050}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"车号完成情况",prop:"complTime"}},[a("el-select",{attrs:{placeholder:"请选择车号完成情况"},model:{value:e.pageparm.complTime,callback:function(t){e.$set(e.pageparm,"complTime",t)},expression:"pageparm.complTime"}},[a("el-option",{attrs:{label:"已完成",value:"已完成"}}),e._v(" "),a("el-option",{attrs:{label:"未完成",value:"未完成"}})],1)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-search"},on:{click:function(t){return e.search()}}},[e._v("搜索")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-refresh-right"},on:{click:function(t){return e.resetForm("searchForm")}}},[e._v("重置")])],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"",height:"650","row-style":e.rowStyle}},[a("el-table-column",{attrs:{type:"index",label:"序号",align:"center",width:"70",index:e.indexMethod,fixed:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"batch",label:"批次",width:"80",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"headDocumentNumber",label:"总公司文号",width:"120",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"roadDocumentNumber",label:"路局文号",width:"120",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"applicNumber",label:"申请单编号",width:"120",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"entryName",label:"项目名称",width:"200",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"total",label:"总数",align:"center",width:"70"}}),e._v(" "),a("el-table-column",{attrs:{prop:"complTotal",label:"已完成",width:"70",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"incomplTotal",label:"未完成",width:"70",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"carNumbers",label:"车号",align:"center",width:"280"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.sourceCarNumberDto,function(t){return a("div",{key:t.cid,staticStyle:{display:"inline-block"}},["未完成"==t.complTime&0==t.concern?a("el-tag",{attrs:{type:"info"}},[e._v(e._s(t.carNumber))]):"未完成"!=t.complTime&0==t.concern?a("el-tag",{attrs:{type:"success"}},[e._v(e._s(t.carNumber))]):a("el-tag",{attrs:{type:"warning"}},[e._v(e._s(t.carNumber))])],1)})}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"note",label:"备注",align:"center",width:"220"}}),e._v(" "),a("el-table-column",{attrs:{prop:"",label:"查看车号信息",width:"180",align:"center",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("el-button",{attrs:{type:"primary",icon:"el-icon-circle-plus",circle:""},on:{click:function(a){return e.handleCarNumbersInfo(t.row)}}})],1)]}}])})],1),e._v(" "),a("el-dialog",{attrs:{title:"查看车号",visible:e.carNumbersInfoVisible,width:"50%","before-close":e.closeCarNumbersInfoVisible},on:{"update:visible":function(t){e.carNumbersInfoVisible=t}}},[a("div",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.carNumbersInfoData,border:"",height:"500","row-style":e.rowCarStyle}},[a("el-table-column",{attrs:{type:"index",label:"序号",align:"center",width:"70",index:e.indexMethod,fixed:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"carNumber",label:"车号",width:"180",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"complTime",label:"完成时间",width:"240",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{ref:"saveTagInput",staticClass:"input-new-tag",attrs:{disabled:"",type:"textarea"},on:{blur:function(a){return e.editComplTime(t.row)}},model:{value:t.row.complTime,callback:function(a){e.$set(t.row,"complTime",a)},expression:"scope.row.complTime"}})]}}])})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.closeCarNumbersInfoVisible}},[e._v("取 消")])],1)])],1)},staticRenderFns:[]};var _t=a("VU/8")(bt,vt,!1,function(e){a("Zbei")},"data-v-10499fb6",null).exports,yt={name:"techlong",data:function(){var e;return e={baseURL:c,longCarNumberList:qe,carNumberList:S,classCarNumbers:R,selectLongCarNumberList:[],sid:0,carNumbers:[],tableData:[],loading:!1,pageparm:{type:6,pageNo:1,pageSize:1e5},pageparmcar:{},editFormVisible:!1,title:"编辑",editForm:{type:6},total:0},x()(e,"loading",!1),x()(e,"carNumbersVisible",!1),x()(e,"props",{multiple:!0}),x()(e,"selectedCarNumbers",[]),x()(e,"inputVisible",!1),x()(e,"inputValue",""),x()(e,"carNumberComplTimeVisible",!1),x()(e,"carNumberComplForm",{}),x()(e,"carNumbersBySid",[]),x()(e,"carNumbersInfoVisible",!1),x()(e,"carNumbersInfoData",[]),x()(e,"ComplTimeVisible",!0),x()(e,"updateTotal",0),x()(e,"updateIncompl",0),x()(e,"updateCompl",0),x()(e,"deleteCarNumbersInfoVisible",!1),e},computed:{indexMethod:function(){return(this.pageparm.pageNo-1)*this.pageparm.pageSize+1}},created:function(){this.getTL()},methods:{search:function(){var e=this;this.carNumbers.length&&(this.pageparm.carNumbers=this.carNumbers),this.loading=!0,Object(s.a)({method:"post",url:c+"/source/selectallsourceinfo",data:this.pageparm}).then(function(t){var a=t.data.data;a=a.map(function(t){return t.sourceCarNumberDto.sort(e.compare("carNumber")),t}),e.tableData=a,e.loading=!1,e.$message.success("搜索成功")}).catch(function(t){e.initPage(),e.$message.error("搜索失败"),console.log(t)})},resetForm:function(e){this.$refs[e].resetFields(),this.carNumbers=[],this.pageparm.carNumbers&&delete this.pageparm.carNumbers},initPage:function(){this.pageparm={pageNo:1,pageSize:1e5,type:6}},getTL:function(){var e=this;Object(s.a)({url:c+"/source/selectallsourceinfo",method:"post",data:this.pageparm}).then(function(t){var a=t.data.data;a=a.map(function(t){return t.sourceCarNumberDto.sort(e.compare("carNumber")),t}),e.tableData=a,e.loading=!1}).catch(function(e){console.log(e)})},compare:function(e){return function(t,a){return t[e]-a[e]}},handleEdit:function(e,t){this.editFormVisible=!0,void 0!=t&&"undefined"!=t?(this.title="修改",this.editForm=t):(this.title="添加",this.editForm={})},changeResult:function(){this.editForm.result=""},handelSource:function(){var e=this;this.$refs.editForm.validate(function(t){if(!t)return console.log("提交失败"),!1;"添加"==e.title?Object(s.a)({url:c+"/source/insertsource",method:"post",data:w()({},e.editForm,{type:6})}).then(function(t){e.$message({message:e.title+"成功",type:"success"}),e.editFormVisible=!1,e.editForm={type:6},e.getTL()}).catch(function(t){console.log(t),e.$message({message:e.title+"失败",type:"error"}),e.editFormVisible=!1,e.editForm={type:6}}):Object(s.a)({url:c+"/source/updatesourceid",method:"post",data:e.editForm}).then(function(t){e.editFormVisible=!1,e.editForm={},e.$message.success("修改成功")}).catch(function(t){console.log(t),e.$message.error("请重新提交")})})},closeDialog:function(){this.editFormVisible=!1,this.editForm={}},handleCarNumbers:function(e){this.editForm=e,this.sid=e.sid,this.getCarNumbersBySid(e.sid),this.carNumbersVisible=!0},getCarNumbersBySid:function(e){var t=this;Object(s.a)({method:"post",url:c+"/source/selectallsourceinfo",data:w()({sid:e},this.pageparm)}).then(function(e){t.carNumbersBySid=e.data.data[0].sourceCarNumberDto,t.carNumbersInfoData=e.data.data[0].sourceCarNumberDto,console.log(t.carNumbersInfoData),t.carNumbersInfoData.sort(t.compare("carNumber")),console.log(t.carNumbersInfoData)}).catch(function(e){})},insertLongCarNumber:function(){var e=this;this.$confirm("是否提交该车号?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){if(e.selectLongCarNumberList.length){for(var t=0;t<e.selectLongCarNumberList.length;t++)Object(s.a)({url:c+"/source/insertsourcecarnumber",method:"post",data:{sid:e.sid,carNumber:e.selectLongCarNumberList[t]}}).then(function(t){e.getTL(),e.getCarNumbersBySid(e.sid)}).catch(function(t){e.getTL(),e.getCarNumbersBySid(e.sid),console.log(t),e.$message.error("请重新提交")});e.selectLongCarNumberList=[]}else e.$message.warning("请选择车号")}).then(function(){e.updateNumber(e.sid)}).catch(function(){e.$message({type:"info",message:"已取消提交"})})},toRemoveSpacing:function(e){if("string"==typeof e)var t=e.replace(/[\t\r\f\n\s]*/g,"");return t},updateNumber:function(e){var t=this;Object(s.a)({method:"post",url:c+"/source/selectallsourceinfo",data:{sid:e}}).then(function(e){var a=e.data.data[0].sourceCarNumberDto;console.log(e.data.data[0].sourceCarNumberDto);var l=a.length;console.log(l),t.updateTotal=l,console.log("total",l);for(var r=0,o=0,i=0;i<l;i++){var n=t.toRemoveSpacing(a[i].complTime);"null"==n.toLowerCase()||""==n||"N/A"==n||"未完成"==n?r+=1:o+=1}console.log("incoml",r),t.updateIncompl=r,t.updateCompl=o}).then(function(){var a=void 0;a=0==t.updateIncompl&0!=t.updateTotal?1:0,Object(s.a)({url:c+"/source/updatesourceid",method:"post",data:w()({sid:e},t.editForm,{total:t.updateTotal,incomplTotal:t.updateIncompl,complTotal:t.updateCompl,state:a})}).then(function(e){t.editFormVisible=!1,t.search(),t.getCarNumbersBySid(t.sid)}).catch(function(e){console.log(e)})})},handleCarNumberForm:function(){var e=this;this.inputValue&&this.$confirm("是否提交该车号?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var t=e.inputValue;t&&(e.selectedCarNumbers.push(t),Object(s.a)({url:c+"/source/insertsourcecarnumber",method:"post",data:{sid:e.sid,carNumber:e.inputValue}}).then(function(t){e.getTL(),e.getCarNumbersBySid(e.sid),e.inputVisible=!1,e.$message.success("提交成功")}).catch(function(t){e.getTL(),e.editForm={},console.log(t),e.$message.error("请重新提交")})),e.inputValue=""}).catch(function(){e.$message({type:"info",message:"已取消提交"})})},handleClose:function(e){this.carNumberComplForm={},this.carNumberComplTimeVisible=!1},handleSelectedCarNumbers:function(){this.carNumbersVisible=!1},handleCloseNumbers:function(e,t){var a=this;this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:c+"/source/deletesourcecarnumbersid",method:"post",params:{cid:e}}).then(function(e){a.$message({message:"删除成功",type:"success"}),a.getTL()}).catch(function(e){console.log(e)})}).catch(function(){a.$message({type:"info",message:"已取消删除"})})},deleteCarNumber:function(e,t){var a=this;this.$confirm("此操作将永久删除, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:c+"/source/deletesourcecarnumbersid",method:"post",params:{cid:e}}).then(function(e){a.$message({message:"删除成功",type:"success"}),a.getCarNumbersBySid(a.sid)}).then(function(){var e=a.editForm.total;e-=1,console.log(e);var l=void 0,r=void 0,o=void 0,i=void 0,n=a.toRemoveSpacing(t.complTime);"null"==n.toLowerCase()||""==n||"N/A"==n||"未完成"==n?o=0!=e&0==(l=a.editForm.incomplTotal-1)?1:0:e==(r=a.editForm.complTotal-1)?(o=1,console.log(o)):(o=0,console.log(o)),console.log(t),console.log(e,l,r),i=w()({},a.editForm,{total:e,incomplTotal:l,complTotal:r,state:o}),"null"==n.toLowerCase()||""==n||"N/A"==n||"未完成"==n?(i=w()({},a.editForm,{total:e,incomplTotal:l,state:o}),console.log(i)):(i=w()({},a.editForm,{total:e,complTotal:r,state:o}),console.log(i)),Object(s.a)({url:c+"/source/updatesourceid",method:"post",data:w()({sid:a.sid},i)}).then(function(e){a.initPage(),a.getTL(),a.getCarNumbersBySid(a.sid)}).then(function(){Object(s.a)({method:"post",url:c+"/source/selectallsourceinfo",data:{sid:a.sid}}).then(function(e){a.editForm=e.data.data[0],a.initPage(),a.getTL(),a.getCarNumbersBySid(a.sid)})})})}).catch(function(){a.$message({type:"info",message:"已取消删除"})})},handleInputConfirm:function(e){var t=this;this.$confirm("是否提交该车号?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var a=t.inputValue;a&&(t.selectedCarNumbers.push(a),Object(s.a)({url:c+"/source/insertsourcecarnumber",method:"post",data:{sid:e.sid,carNumber:t.inputValue}}).then(function(e){t.inputVisible=!1,t.$message.success("提交成功")}).catch(function(e){console.log(e),t.$message.error("请重新提交")})),t.inputValue=""}).catch(function(){t.$message({type:"info",message:"已取消提交"})})},showInput:function(){var e=this;this.inputVisible=!0,this.$nextTick(function(t){e.$refs.saveTagInput.$refs.input.focus()})},editCarNumber:function(e,t){this.editForm=t,console.log(e,t),this.carNumberComplForm=e,this.sid=t.sid},handleComplTime:function(){var e=this;this.carNumberComplTimeVisible=!1,Object(s.a)({url:c+"/source/updatesourcecarnumber",method:"post",data:this.carNumberComplForm}).then(function(t){e.getTL()})},exportSourceExcel:function(){var e=c+"/source/exportsource?";for(var t in this.pageparm)this.pageparm[t]&&(e+=t+"="+this.pageparm[t]+"&");s.a.get(e).then(function(t){console.log(e),window.location.href=e})},exportSourceFinalExcel:function(){var e=c+"/source/exportsourcefinaltechnologyconcentra?";for(var t in this.pageparm||0==this.pageparm[t])this.pageparm[t]&&(e+=t+"="+this.pageparm[t]+"&");s.a.get(e).then(function(t){console.log(e),window.location.href=e})},handleSourceExceed:function(e,t){this.$message.warning("当前限制选择文件个数，本次选择了 "+e.length+" 个文件，共选择了 "+(e.length+t.length)+" 个文件")},handleSourceSuccess:function(){this.getTL(),this.$message.success("导入成功")},handleError:function(){this.$message.error("导入格式错误，请修改后重新导入！")},handleCarNumbersInfo:function(e){this.carNumbersInfoVisible=!0,this.getCarNumbersBySid(e.sid),this.sid=e.sid,this.editForm=e},deleteCarNumbersInfo:function(e){this.deleteCarNumbersInfoVisible=!0,this.getCarNumbersBySid(e.sid),this.sid=e.sid,this.editForm=e},enditComplTime:function(){this.ComplTimeVisible=!1},editComplTime:function(e){var t=this;Object(s.a)({url:c+"/source/updatesourcecarnumber",method:"post",data:{cid:e.cid,complTime:e.complTime}}).then(function(e){t.getTL(),t.$message.success("提交成功")}).then(function(){t.updateNumber(t.sid)})},deleteSourceInfoBySID:function(e){var t=this;Object(s.a)({url:c+"/source/deletesourceinfosid",method:"post",params:{sid:e}}).then(function(e){t.$message.success("删除成功"),t.getTL()}).catch(function(e){t.$message.error("删除失败")})},changeDimension:function(e,t){var a=this;this.$confirm("是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:" "+c+"/source/changedimension",params:{sid:e,dimension:t}}).then(function(e){a.$message.success("成功"),a.search()}).catch(function(e){a.$message.error("失败")})}).catch(function(){a.$message({type:"info",message:"已取消"})})},rowStyle:function(e){if(1==e.row.dimension)return{background:"antiquewhite"}},rowCarStyle:function(e){if(1==e.row.concern)return{background:"antiquewhite"}},changeCarConcern:function(e,t){var a=this;this.$confirm("是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:" "+c+"/source/changeconcern",params:{cid:e,concern:t}}).then(function(e){a.$message.success("标注成功"),a.getTL(),a.getCarNumbersBySid(a.sid),a.search()}).catch(function(e){a.getTL(),a.getCarNumbersBySid(a.sid),a.search(),a.$message.error("标注失败")})}).catch(function(){a.$message({type:"info",message:"已取消"})})},closeCarNumbersInfoVisible:function(){this.carNumbersInfoVisible=!1,this.carNumbersInfoData=[]}}},Nt={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:6}},[a("div",{staticClass:"grid-content bg-purple"},[a("el-button",{attrs:{size:"small",type:"warning",icon:"el-icon-star-on"},on:{click:function(t){return e.exportSourceFinalExcel()}}},[e._v("导出")])],1)])],1),e._v(" "),a("el-form",{ref:"searchForm",staticClass:"user-search",attrs:{inline:!0,model:e.pageparm}},[a("el-form-item",{attrs:{label:"标注",prop:"dimension"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.pageparm.dimension,callback:function(t){e.$set(e.pageparm,"dimension",t)},expression:"pageparm.dimension"}},[a("el-option",{attrs:{label:"非重点关注",value:"0"}}),e._v(" "),a("el-option",{attrs:{label:"重点关注",value:"1"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"文号",prop:"motorDocumentNumber"}},[a("el-input",{attrs:{placeholder:"输入文号"},model:{value:e.pageparm.motorDocumentNumber,callback:function(t){e.$set(e.pageparm,"motorDocumentNumber",t)},expression:"pageparm.motorDocumentNumber"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"项目名称",prop:"entryName"}},[a("el-input",{attrs:{placeholder:"输入项目名称"},model:{value:e.pageparm.entryName,callback:function(t){e.$set(e.pageparm,"entryName",t)},expression:"pageparm.entryName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"项目完成情况",prop:"state"}},[a("el-select",{attrs:{placeholder:"请选择项目完成情况"},model:{value:e.pageparm.state,callback:function(t){e.$set(e.pageparm,"state",t)},expression:"pageparm.state"}},[a("el-option",{attrs:{label:"已完成",value:1}}),e._v(" "),a("el-option",{attrs:{label:"未完成",value:0}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"车号",prop:"carNumber"}},[a("el-select",{attrs:{multiple:"",filterable:"",placeholder:"请选择车号"},model:{value:e.carNumbers,callback:function(t){e.carNumbers=t},expression:"carNumbers"}},[a("el-option",{attrs:{label:"2048",value:2048}}),e._v(" "),a("el-option",{attrs:{label:"2049",value:2049}}),e._v(" "),a("el-option",{attrs:{label:"2050",value:2050}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"车号完成情况",prop:"complTime"}},[a("el-select",{attrs:{placeholder:"请选择车号完成情况"},model:{value:e.pageparm.complTime,callback:function(t){e.$set(e.pageparm,"complTime",t)},expression:"pageparm.complTime"}},[a("el-option",{attrs:{label:"已完成",value:"已完成"}}),e._v(" "),a("el-option",{attrs:{label:"未完成",value:"未完成"}})],1)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-search"},on:{click:function(t){return e.search()}}},[e._v("搜索")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-refresh-right"},on:{click:function(t){return e.resetForm("searchForm")}}},[e._v("重置")])],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"",height:"650","row-style":e.rowStyle}},[a("el-table-column",{attrs:{type:"index",label:"序号",align:"center",width:"70",index:e.indexMethod,fixed:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"motorDocumentNumber",label:"文号",width:"120",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"entryName",label:"项目名称",width:"200",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"total",label:"总数",align:"center",width:"70"}}),e._v(" "),a("el-table-column",{attrs:{prop:"complTotal",label:"已完成",width:"70",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"incomplTotal",label:"未完成",width:"70",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"carNumbers",label:"车号",align:"center",width:"280"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.sourceCarNumberDto,function(t){return a("div",{key:t.cid,staticStyle:{display:"inline-block"}},["未完成"==t.complTime&0==t.concern?a("el-tag",{attrs:{type:"info"}},[e._v(e._s(t.carNumber))]):"未完成"!=t.complTime&0==t.concern?a("el-tag",{attrs:{type:"success"}},[e._v(e._s(t.carNumber))]):a("el-tag",{attrs:{type:"warning"}},[e._v(e._s(t.carNumber))])],1)})}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"note",label:"备注",align:"center",width:"220"}}),e._v(" "),a("el-table-column",{attrs:{prop:"",label:"查看车号信息",width:"180",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("el-button",{attrs:{type:"primary",icon:"el-icon-circle-plus",circle:""},on:{click:function(a){return e.handleCarNumbersInfo(t.row)}}})],1)]}}])})],1),e._v(" "),a("el-dialog",{attrs:{title:"查看车号",visible:e.carNumbersInfoVisible,width:"50%","before-close":e.closeCarNumbersInfoVisible},on:{"update:visible":function(t){e.carNumbersInfoVisible=t}}},[a("div",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.carNumbersInfoData,border:"",height:"500","row-style":e.rowCarStyle}},[a("el-table-column",{attrs:{type:"index",label:"序号",align:"center",width:"70",index:e.indexMethod,fixed:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"carNumber",label:"车号",width:"180",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"complTime",label:"完成时间",width:"240",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{ref:"saveTagInput",staticClass:"input-new-tag",attrs:{disabled:"",type:"textarea"},on:{blur:function(a){return e.editComplTime(t.row)}},model:{value:t.row.complTime,callback:function(a){e.$set(t.row,"complTime",a)},expression:"scope.row.complTime"}})]}}])})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){return e.closeCarNumbersInfoVisible()}}},[e._v("取 消")])],1)])],1)},staticRenderFns:[]};var Ft=a("VU/8")(yt,Nt,!1,function(e){a("O8oN")},"data-v-7d5d6e9e",null).exports,wt={name:"Metering",components:{Pagination:T},data:function(){return{baseURL:c,toolData:[],editFormVisible:!1,title:"编辑",editForm:{},rules:{name:[{required:!0,message:"请输入名称",trigger:"blur"}],number:[{required:!0,message:"请输入编号",trigger:"blur"}],survey:[{required:!0,message:"请输入量程",trigger:"blur"}],position:[{required:!0,message:"请输入存放位置",trigger:"blur"}],currentime:[{required:!0,message:"请选择当前日期",trigger:"blur"}],becometime:[{required:!0,message:"请选择到期日期",trigger:"blur"}],note:[{required:!0,message:"请输入备注",trigger:"blur"}]},loading:!0,pageparm:{pageNo:1,pageSize:1e5,type:1},total:0,currentTimeList:[],becomeTimeList:[],typeVisible:!1,options:[{value:"0",label:"小于等于15天"},{value:"1",label:"小于30天"}],multipleSelection:[]}},created:function(){this.getTool()},computed:{indexMethod:function(){return(this.pageparm.pageNo-1)*this.pageparm.pageSize+1}},methods:{resetForm:function(e){this.becomeTimeList=[],delete this.pageparm.startBecometime,delete this.pageparm.endBecometime,this.$refs[e].resetFields()},rowStyle:function(e){return parseInt(e.row.nextday)<=15?{background:"rgb(236 207 203)",padding:"3px"}:{padding:"3px"}},getYMDHMS:function(e){var t=new Date(e);return t.getFullYear()+"-"+(t.getMonth()+1).toString().padStart(2,"0")+"-"+t.getDate().toString().padStart(2,"0")},getDaysDiff:function(e){var t=new Date(e).getTime()-Date.now();return Math.round(t/864e5)},getTool:function(){var e=this;this.becomeTimeList.length&&(this.pageparm.startBecometime=this.getYMDHMS(new Date(this.becomeTimeList[0].toString())),this.pageparm.endBecometime=this.getYMDHMS(new Date(this.becomeTimeList[1].toString()))),Object(s.a)({url:c+"/tool/selecttool",method:"post",data:this.pageparm}).then(function(t){e.total=t.data.data.size,e.toolData=t.data.data.list,e.toolData=e.toolData.map(function(t){return t.currentime=e.getYMDHMS(t.currentime),t.becometime=e.getYMDHMS(t.becometime),t}),e.rowStyle(),e.loading=!1}).catch(function(e){console.log(e)})},handleEdit:function(e,t){this.editFormVisible=!0,void 0!=t&&"undefined"!=t?(this.title="修改",this.editForm=t):this.title="添加"},closeDialog:function(){this.editForm={},this.editFormVisible=!1},handelTool:function(){var e=this;this.editForm.type=1,this.$refs.editForm.validate(function(t){t&&("添加"==e.title?(e.editForm.currentime=e.getYMDHMS(Date.now()),Object(s.a)({url:c+"/tool/inserttool",method:"post",data:e.editForm}).then(function(t){e.$message({message:e.title+"成功",type:"success"}),e.editFormVisible=!1,e.editForm={},e.getTool()}).catch(function(t){console.log(t),e.$message({message:e.title+"失败",type:"error"}),e.editFormVisible=!1,e.editForm={},e.getTool()})):Object(s.a)({url:c+"/tool/updatetoolid",method:"post",data:e.editForm}).then(function(t){e.$message({message:e.title+"成功",type:"success"}),e.editFormVisible=!1,e.editForm={},e.getTool()}).catch(function(e){console.log(e)}))})},callFather:function(e){this.pageparm.pageNo=e.pageNo,this.pageparm.pageSize=e.pageSize,this.getTool(),document.querySelector(".el-main").scrollTo(0,0)},handleRemove:function(e,t){console.log(e,t)},handlePreview:function(e){console.log(e)},handleExceed:function(e,t){this.$message.warning("当前限制选择文件个数，本次选择了 "+e.length+" 个文件，共选择了 "+(e.length+t.length)+" 个文件")},beforeRemove:function(e,t){return this.$confirm("确定移除 "+e.name+"？")},handleSuccess:function(){this.getTool(),this.$message.success("导入成功")},handleError:function(){this.getTool(),this.$message.error("导入格式错误，请修改后重新导入！")},deleteById:function(e){var t=this;this.$confirm("此操作将永久删除, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:c+"/tool/deletetoolid",params:{id:e.id}}).then(function(e){t.$message({message:"删除成功",type:"success"}),t.getTool()}).catch(function(e){console.log(e)})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},changeType:function(e,t){var a=this,l=2==t?"绝缘":"仪器";this.$confirm("此操作将该数据转移到"+l+"列表, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:c+"/tool/changetooltype",params:{id:e,type:t}}).then(function(e){a.$message({message:"已转移到"+l+"列表",type:"success"}),a.getTool()}).catch(function(e){console.log(e)})}).catch(function(){a.$message({type:"info",message:"已取消转移"})})},exportExcel:function(){this.becomeTimeList.length&&(this.pageparm.startBecometime=this.getYMDHMS(new Date(this.becomeTimeList[0].toString())),this.pageparm.endBecometime=this.getYMDHMS(new Date(this.becomeTimeList[1].toString())));var e=c+"/tool/export?";for(var t in this.pageparm)this.pageparm[t]&&(e+=t+"="+this.pageparm[t]+"&");console.log(e),s.a.get(e).then(function(t){console.log(e),window.location.href=e})},handleSelectionChange:function(e){this.multipleSelection=e},toggleSelection:function(){var e=this,t=this.multipleSelection.length;if(this.multipleSelection.length){var a=[];this.multipleSelection.map(function(e){a.push(e.id)}),console.log(a),this.$confirm("此操作将永久删除已选中的"+t+"条数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:c+"/tool/deleteids",method:"post",data:{ids:a}}).then(function(t){e.$message({message:"删除成功",type:"success"}),e.getTool()}).catch(function(e){console.log(e)})}).catch(function(){e.$message({type:"info",message:"已取消删除"})})}else this.$message({message:"没有选择数据，请重新选择！",type:"warning"})}}},kt={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[[a("el-upload",{staticClass:"upload-demo",attrs:{action:e.baseURL+"/tool/import","on-preview":e.handlePreview,"on-remove":e.handleRemove,"before-remove":e.beforeRemove,multiple:"","on-exceed":e.handleExceed,"on-success":e.handleSuccess,"on-error":e.handleError}},[a("el-button",{attrs:{size:"small",type:"warning",icon:"el-icon-star-on"}},[e._v("导入")])],1),e._v(" "),a("br"),a("br"),e._v(" "),a("el-form",{ref:"searchForm",staticClass:"user-search",attrs:{inline:!0,model:e.pageparm}},[a("el-form-item",{attrs:{label:"名称：",prop:"name"}},[a("el-input",{attrs:{size:"small",placeholder:"输入计量用品名称"},model:{value:e.pageparm.name,callback:function(t){e.$set(e.pageparm,"name",t)},expression:"pageparm.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"编号：",prop:"number"}},[a("el-input",{attrs:{size:"small",placeholder:"输入计量用品编号"},model:{value:e.pageparm.number,callback:function(t){e.$set(e.pageparm,"number",t)},expression:"pageparm.number"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"量程：",prop:"survey"}},[a("el-input",{attrs:{size:"small",placeholder:"输入计量用品量程"},model:{value:e.pageparm.survey,callback:function(t){e.$set(e.pageparm,"survey",t)},expression:"pageparm.survey"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"存放位置：",prop:"position"}},[a("el-input",{attrs:{size:"small",placeholder:"输入存放位置"},model:{value:e.pageparm.position,callback:function(t){e.$set(e.pageparm,"position",t)},expression:"pageparm.position"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"到期日期："}},[a("el-col",{attrs:{span:11}},[a("el-date-picker",{attrs:{size:"small",type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.becomeTimeList,callback:function(t){e.becomeTimeList=t},expression:"becomeTimeList"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"距离下次送检日期：",prop:"nextday"}},[a("el-select",{attrs:{size:"small",placeholder:"请选择下次送检天数"},model:{value:e.pageparm.nextday,callback:function(t){e.$set(e.pageparm,"nextday",t)},expression:"pageparm.nextday"}},e._l(e.options,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"备注：",prop:"note"}},[a("el-input",{attrs:{size:"small",placeholder:"输入备注"},model:{value:e.pageparm.note,callback:function(t){e.$set(e.pageparm,"note",t)},expression:"pageparm.note"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-search"},on:{click:function(t){return e.getTool()}}},[e._v("搜索")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-refresh-right"},on:{click:function(t){return e.resetForm("searchForm")}}},[e._v("重置")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-plus"},on:{click:function(t){return e.handleEdit()}}},[e._v("添加")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"warning",icon:"el-icon-star-off"},on:{click:function(t){return e.exportExcel()}}},[e._v("导出")])],1)],1),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.toolData,stripe:"",height:"800","cell-style":e.rowStyle},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{ref:"multipleTable",attrs:{type:"selection",width:"55"}}),e._v(" "),a("el-table-column",{attrs:{type:"index",label:"序号",align:"center",width:"70",index:e.indexMethod,fixed:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"名称",width:"",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"number",label:"编号",width:"",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"survey",label:"量程",width:"",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                    "+e._s("null"==t.row.survey?"":t.row.survey)+"\n                ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"position",label:"存放位置",width:"",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"currentime",label:"当前日期",width:"",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"becometime",label:"到期日期",width:"",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"nextday",label:"距离下次送检日期",width:"",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"note",label:"备注",width:"",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                    "+e._s("null"==t.row.note?"":t.row.note)+"\n                ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"",label:"操作",width:"130",align:"center","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",icon:"el-icon-edit",circle:""},on:{click:function(a){return e.handleEdit(t.$index,t.row)}}}),e._v(" "),a("el-button",{attrs:{type:"text",icon:"el-icon-delete",circle:""},on:{click:function(a){return e.deleteById(t.row)}}}),e._v(" "),a("el-popover",{attrs:{placement:"top-start",title:"",width:"",trigger:"click"}},[a("el-button",{attrs:{type:"text",icon:"",circle:""},on:{click:function(a){return e.changeType(t.row.id,2)}}},[a("i",{staticClass:"el-icon-top"}),e._v("绝缘\n                        ")]),e._v(" "),a("el-button",{attrs:{type:"text",icon:"",circle:""},on:{click:function(a){return e.changeType(t.row.id,3)}}},[a("i",{staticClass:"el-icon-top"}),e._v("仪器\n                        ")]),e._v(" "),a("el-button",{attrs:{slot:"reference",type:"text",circle:""},slot:"reference"},[a("i",{staticClass:"el-icon-top",staticStyle:{padding:"9px"}})])],1)]}}])})],1),e._v(" "),a("div",{staticClass:"bottom"},[a("Pagination",{attrs:{"child-msg":e.pageparm,total:e.total},on:{callFather:e.callFather}}),e._v(" "),a("el-button",{attrs:{size:"small",type:"danger"},on:{click:function(t){return e.toggleSelection()}}},[e._v("删除")])],1),e._v(" "),a("el-dialog",{attrs:{title:e.title,visible:e.editFormVisible,width:"40%","close-on-click-modal":!1},on:{"update:visible":function(t){e.editFormVisible=t}}},[a("el-form",{ref:"editForm",attrs:{"label-width":"120px",model:e.editForm,rules:e.rules}},[a("el-form-item",{attrs:{label:"名称",prop:"name"}},[a("el-input",{attrs:{"auto-complete":"off",placeholder:"请输入名称"},model:{value:e.editForm.name,callback:function(t){e.$set(e.editForm,"name",t)},expression:"editForm.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"编号",prop:"number"}},[a("el-input",{attrs:{"auto-complete":"off",placeholder:"请输入编号"},model:{value:e.editForm.number,callback:function(t){e.$set(e.editForm,"number",t)},expression:"editForm.number"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"量程",prop:"survey"}},[a("el-input",{attrs:{"auto-complete":"off",placeholder:"请输入量程"},model:{value:e.editForm.survey,callback:function(t){e.$set(e.editForm,"survey",t)},expression:"editForm.survey"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"存放位置",prop:"position"}},[a("el-input",{attrs:{"auto-complete":"off",placeholder:"请输入存放位置"},model:{value:e.editForm.position,callback:function(t){e.$set(e.editForm,"position",t)},expression:"editForm.position"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"到期日期",prop:"becometime"}},[a("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",type:"date",placeholder:"选择日期"},model:{value:e.editForm.becometime,callback:function(t){e.$set(e.editForm,"becometime",t)},expression:"editForm.becometime"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"备注",prop:"note"}},[a("el-input",{attrs:{size:"small","auto-complete":"off",placeholder:"请输入备注"},model:{value:e.editForm.note,callback:function(t){e.$set(e.editForm,"note",t)},expression:"editForm.note"}})],1)],1),e._v(" "),a("span",{staticStyle:{color:"brown","font-size":"12px"}},[e._v("若无需说明 请填写“无”")]),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){return e.closeDialog("editForm")}}},[e._v("取消")]),e._v(" "),a("el-button",{staticClass:"title",attrs:{size:"small",type:"primary"},on:{click:function(t){return e.handelTool("editForm")}}},[e._v("保存")])],1)],1)]],2)},staticRenderFns:[]};var xt=a("VU/8")(wt,kt,!1,function(e){a("WEA+")},"data-v-43e631b0",null).exports,$t={name:"Metering",components:{Pagination:T},data:function(){return{baseURL:c,toolData:[],editFormVisible:!1,title:"编辑",editForm:{},rules:{name:[{required:!0,message:"请输入类型",trigger:"blur"}],number:[{required:!0,message:"请输入编号",trigger:"blur"}],currentime:[{required:!0,message:"请选择当前日期",trigger:"blur"}],becometime:[{required:!0,message:"请选择到期日期",trigger:"blur"}],note:[{required:!0,message:"请输入备注",trigger:"blur"}]},loading:!0,pageparm:{pageNo:1,pageSize:1e5,type:3},total:0,currentTimeList:[],becomeTimeList:[],typeVisible:!1,options:[{value:"0",label:"小于等于15天"},{value:"1",label:"小于30天"}],multipleSelection:[]}},created:function(){this.getTool()},computed:{indexMethod:function(){return(this.pageparm.pageNo-1)*this.pageparm.pageSize+1}},methods:{resetForm:function(e){this.becomeTimeList=[],delete this.pageparm.startBecometime,delete this.pageparm.endBecometime,this.$refs[e].resetFields()},rowStyle:function(e){return parseInt(e.row.nextday)<=15?{background:"rgb(236 207 203)",padding:"3px"}:{padding:"3px"}},getYMDHMS:function(e){var t=new Date(e);return t.getFullYear()+"-"+(t.getMonth()+1).toString().padStart(2,"0")+"-"+t.getDate().toString().padStart(2,"0")},getDaysDiff:function(e){var t=new Date(e).getTime()-Date.now();return Math.round(t/864e5)},getTool:function(){var e=this;this.becomeTimeList.length&&(this.pageparm.startBecometime=this.getYMDHMS(new Date(this.becomeTimeList[0].toString())),this.pageparm.endBecometime=this.getYMDHMS(new Date(this.becomeTimeList[1].toString()))),Object(s.a)({url:c+"/tool/selecttool",method:"post",data:this.pageparm}).then(function(t){e.total=t.data.data.size,e.toolData=t.data.data.list,e.toolData=e.toolData.map(function(t){return t.currentime=e.getYMDHMS(t.currentime),t.becometime=e.getYMDHMS(t.becometime),t}),e.rowStyle(),e.loading=!1}).catch(function(e){console.log(e)})},handleEdit:function(e,t){this.editFormVisible=!0,void 0!=t&&"undefined"!=t?(this.title="修改",this.editForm=t):this.title="添加"},closeDialog:function(){this.editForm={},this.editFormVisible=!1},handelTool:function(){var e=this;this.editForm.type=3,this.$refs.editForm.validate(function(t){t&&("添加"==e.title?(e.editForm.currentime=e.getYMDHMS(Date.now()),Object(s.a)({url:c+"/tool/inserttool",method:"post",data:e.editForm}).then(function(t){e.$message({message:e.title+"成功",type:"success"}),e.editFormVisible=!1,e.editForm={},e.getTool()}).catch(function(t){console.log(t),e.$message({message:e.title+"失败",type:"error"}),e.editFormVisible=!1,e.editForm={},e.getTool()})):Object(s.a)({url:c+"/tool/updatetoolid",method:"post",data:e.editForm}).then(function(t){e.$message({message:e.title+"成功",type:"success"}),e.editFormVisible=!1,e.editForm={},e.getTool()}).catch(function(e){console.log(e)}))})},callFather:function(e){this.pageparm.pageNo=e.pageNo,this.pageparm.pageSize=e.pageSize,this.getTool(),document.querySelector(".el-main").scrollTo(0,0)},handleRemove:function(e,t){console.log(e,t)},handlePreview:function(e){console.log(e)},handleExceed:function(e,t){this.$message.warning("当前限制选择文件个数，本次选择了 "+e.length+" 个文件，共选择了 "+(e.length+t.length)+" 个文件")},beforeRemove:function(e,t){return this.$confirm("确定移除 "+e.name+"？")},handleSuccess:function(){this.getTool(),this.$message.success("导入成功")},handleError:function(){this.getTool(),this.$message.error("导入格式错误，请修改后重新导入！")},deleteById:function(e){var t=this;this.$confirm("此操作将永久删除, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:c+"/tool/deletetoolid",params:{id:e.id}}).then(function(e){t.$message({message:"删除成功",type:"success"}),t.getTool()}).catch(function(e){console.log(e)})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},changeType:function(e,t){var a=this,l=1==t?"计量":"绝缘";this.$confirm("此操作将该数据转移到"+l+"列表, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:c+"/tool/changetooltype",params:{id:e,type:t}}).then(function(e){a.$message({message:"已转移到"+l+"列表",type:"success"}),a.getTool()}).catch(function(e){console.log(e)})}).catch(function(){a.$message({type:"info",message:"已取消转移"})})},exportExcel:function(){this.becomeTimeList.length&&(this.pageparm.startBecometime=this.getYMDHMS(new Date(this.becomeTimeList[0].toString())),this.pageparm.endBecometime=this.getYMDHMS(new Date(this.becomeTimeList[1].toString())));var e=c+"/tool/exportsecure?";for(var t in this.pageparm)this.pageparm[t]&&(e+=t+"="+this.pageparm[t]+"&");console.log(e),s.a.get(e).then(function(t){console.log(e),window.location.href=e})},handleSelectionChange:function(e){this.multipleSelection=e},toggleSelection:function(){var e=this,t=this.multipleSelection.length;if(this.multipleSelection.length){var a=[];this.multipleSelection.map(function(e){a.push(e.id)}),console.log(a),this.$confirm("此操作将永久删除已选中的"+t+"条数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:c+"/tool/deleteids",method:"post",data:{ids:a}}).then(function(t){e.$message({message:"删除成功",type:"success"}),e.getTool()}).catch(function(e){console.log(e)})}).catch(function(){e.$message({type:"info",message:"已取消删除"})})}else this.$message({message:"没有选择数据，请重新选择！",type:"warning"})}}},Ct={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[[a("el-upload",{staticClass:"upload-demo",attrs:{action:e.baseURL+"/tool/import","on-preview":e.handlePreview,"on-remove":e.handleRemove,"before-remove":e.beforeRemove,multiple:"","on-exceed":e.handleExceed,"on-success":e.handleSuccess,"on-error":e.handleError}},[a("el-button",{attrs:{size:"small",type:"warning",icon:"el-icon-star-on"}},[e._v("导入")])],1),e._v(" "),a("br"),a("br"),e._v(" "),a("el-form",{ref:"searchForm",staticClass:"user-search",attrs:{inline:!0,model:e.pageparm}},[a("el-form-item",{attrs:{label:"类型：",prop:"name"}},[a("el-input",{attrs:{size:"small",placeholder:"输入仪器用品名称"},model:{value:e.pageparm.name,callback:function(t){e.$set(e.pageparm,"name",t)},expression:"pageparm.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"编号：",prop:"number"}},[a("el-input",{attrs:{size:"small",placeholder:"输入仪器用品编号"},model:{value:e.pageparm.number,callback:function(t){e.$set(e.pageparm,"number",t)},expression:"pageparm.number"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"到期日期："}},[a("el-col",{attrs:{span:11}},[a("el-date-picker",{attrs:{size:"small",type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.becomeTimeList,callback:function(t){e.becomeTimeList=t},expression:"becomeTimeList"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"距离下次送检日期：",prop:"nextday"}},[a("el-select",{attrs:{size:"small",placeholder:"请选择下次送检天数"},model:{value:e.pageparm.nextday,callback:function(t){e.$set(e.pageparm,"nextday",t)},expression:"pageparm.nextday"}},e._l(e.options,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"备注：",prop:"note"}},[a("el-input",{attrs:{size:"small",placeholder:"输入仪器用品备注"},model:{value:e.pageparm.note,callback:function(t){e.$set(e.pageparm,"note",t)},expression:"pageparm.note"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-search"},on:{click:function(t){return e.getTool()}}},[e._v("搜索")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-refresh-right"},on:{click:function(t){return e.resetForm("searchForm")}}},[e._v("重置")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-plus"},on:{click:function(t){return e.handleEdit()}}},[e._v("添加")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"warning",icon:"el-icon-star-off"},on:{click:function(t){return e.exportExcel()}}},[e._v("导出")])],1)],1),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.toolData,stripe:"",height:"800","cell-style":e.rowStyle},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{ref:"multipleTable",attrs:{type:"selection",width:"55"}}),e._v(" "),a("el-table-column",{attrs:{type:"index",label:"序号",align:"center",width:"70",index:e.indexMethod,fixed:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"number",label:"编号",width:"",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"类型",width:"",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"currentime",label:"当前日期",width:"",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"becometime",label:"到期日期",width:"",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"nextday",label:"距离下次送检日期",width:"",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"note",label:"备注",width:"",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                    "+e._s("null"==t.row.note?"":t.row.note)+"\n                ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"",label:"操作",width:"130",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",icon:"el-icon-edit",circle:""},on:{click:function(a){return e.handleEdit(t.$index,t.row)}}}),e._v(" "),a("el-button",{attrs:{type:"text",icon:"el-icon-delete",circle:""},on:{click:function(a){return e.deleteById(t.row)}}}),e._v(" "),a("el-popover",{staticStyle:{"min-width":"100px!important"},attrs:{placement:"top-start",title:"",width:"",trigger:"click"}},[a("el-button",{attrs:{type:"text",icon:"",circle:""},on:{click:function(a){return e.changeType(t.row.id,1)}}},[a("i",{staticClass:"el-icon-top"}),e._v("计量\n                        ")]),e._v(" "),a("el-button",{attrs:{type:"text",icon:"",circle:""},on:{click:function(a){return e.changeType(t.row.id,2)}}},[a("i",{staticClass:"el-icon-top"}),e._v("绝缘\n                        ")]),e._v(" "),a("el-button",{attrs:{slot:"reference",type:"text",circle:""},slot:"reference"},[a("i",{staticClass:"el-icon-top",staticStyle:{padding:"9px"}})])],1)]}}])})],1),e._v(" "),a("div",{staticClass:"bottom"},[a("Pagination",{attrs:{"child-msg":e.pageparm,total:e.total},on:{callFather:e.callFather}}),e._v(" "),a("el-button",{attrs:{size:"small",type:"danger"},on:{click:function(t){return e.toggleSelection()}}},[e._v("删除")])],1),e._v(" "),a("el-dialog",{attrs:{title:e.title,visible:e.editFormVisible,width:"40%","close-on-click-modal":!1},on:{"update:visible":function(t){e.editFormVisible=t}}},[a("el-form",{ref:"editForm",attrs:{"label-width":"120px",model:e.editForm,rules:e.rules}},[a("el-form-item",{attrs:{label:"编号",prop:"number"}},[a("el-input",{attrs:{"auto-complete":"off",placeholder:"请输入编号"},model:{value:e.editForm.number,callback:function(t){e.$set(e.editForm,"number",t)},expression:"editForm.number"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"类型",prop:"name"}},[a("el-input",{attrs:{"auto-complete":"off",placeholder:"请输入名称"},model:{value:e.editForm.name,callback:function(t){e.$set(e.editForm,"name",t)},expression:"editForm.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"到期日期",prop:"becometime"}},[a("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",type:"date",placeholder:"选择日期"},model:{value:e.editForm.becometime,callback:function(t){e.$set(e.editForm,"becometime",t)},expression:"editForm.becometime"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"备注",prop:"note"}},[a("el-input",{attrs:{"auto-complete":"off",placeholder:"请输入备注"},model:{value:e.editForm.note,callback:function(t){e.$set(e.editForm,"note",t)},expression:"editForm.note"}})],1)],1),e._v(" "),a("span",{staticStyle:{color:"brown","font-size":"12px"}},[e._v("若无需说明 请填写“无”")]),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){return e.closeDialog("editForm")}}},[e._v("取消")]),e._v(" "),a("el-button",{staticClass:"title",attrs:{size:"small",type:"primary"},on:{click:function(t){return e.handelTool("editForm")}}},[e._v("保存")])],1)],1)]],2)},staticRenderFns:[]};var Tt=a("VU/8")($t,Ct,!1,function(e){a("BCtq"),a("Fr8O")},"data-v-e61a9a00",null).exports,St={name:"Insulation",components:{Pagination:T},data:function(){return{baseURL:c,toolData:[],editFormVisible:!1,title:"编辑",editForm:{},rules:{name:[{required:!0,message:"请输入名称",trigger:"blur"}],number:[{required:!0,message:"请输入编号",trigger:"blur"}],survey:[{required:!0,message:"请输入量程",trigger:"blur"}],position:[{required:!0,message:"请输入存放位置",trigger:"blur"}],currentime:[{required:!0,message:"请选择当前日期",trigger:"blur"}],becometime:[{required:!0,message:"请选择到期日期",trigger:"blur"}],note:[{required:!0,message:"请输入备注",trigger:"blur"}]},loading:!0,pageparm:{pageNo:1,pageSize:1e5,type:2},total:0,currentTimeList:[],becomeTimeList:[],typeVisible:!1,options:[{value:"0",label:"小于等于15天"},{value:"1",label:"小于30天"}],multipleSelection:[]}},created:function(){this.getTool()},computed:{indexMethod:function(){return(this.pageparm.pageNo-1)*this.pageparm.pageSize+1}},methods:{resetForm:function(e){this.becomeTimeList=[],delete this.pageparm.startBecometime,delete this.pageparm.endBecometime,this.$refs[e].resetFields()},rowStyle:function(e){return parseInt(e.row.nextday)<=15?{background:"rgb(236 207 203)",padding:"3px"}:{padding:"3px"}},getYMDHMS:function(e){var t=new Date(e);return t.getFullYear()+"-"+(t.getMonth()+1).toString().padStart(2,"0")+"-"+t.getDate().toString().padStart(2,"0")},getDaysDiff:function(e){var t=new Date(e).getTime(),a=Math.abs(t-Date.now());return Math.round(a/864e5)},getTool:function(){var e=this;this.becomeTimeList.length&&(this.pageparm.startBecometime=this.getYMDHMS(new Date(this.becomeTimeList[0].toString())),this.pageparm.endBecometime=this.getYMDHMS(new Date(this.becomeTimeList[1].toString()))),Object(s.a)({url:c+"/tool/selecttool",method:"post",data:this.pageparm}).then(function(t){e.total=t.data.data.size,e.toolData=t.data.data.list,e.toolData=e.toolData.map(function(t){return t.currentime=e.getYMDHMS(t.currentime),t.becometime=e.getYMDHMS(t.becometime),t}),e.rowStyle(),e.loading=!1}).catch(function(e){console.log(e)})},handleEdit:function(e,t){this.editFormVisible=!0,void 0!=t&&"undefined"!=t?(this.title="修改",this.editForm=t):this.title="添加"},closeDialog:function(){this.editForm={},this.editFormVisible=!1},handelTool:function(){var e=this;this.editForm.type=2,this.$refs.editForm.validate(function(t){t&&("添加"==e.title?(e.editForm.currentime=e.getYMDHMS(Date.now()),Object(s.a)({url:c+"/tool/inserttool",method:"post",data:e.editForm}).then(function(t){e.$message({message:e.title+"成功",type:"success"}),e.editFormVisible=!1,e.editForm={},e.getTool()}).catch(function(t){console.log(t),e.$message({message:e.title+"失败",type:"error"}),e.editFormVisible=!1,e.editForm={},e.getTool()})):Object(s.a)({url:c+"/tool/updatetoolid",method:"post",data:e.editForm}).then(function(t){e.$message({message:e.title+"成功",type:"success"}),e.editFormVisible=!1,e.editForm={},e.getTool()}).catch(function(e){console.log(e)}))})},callFather:function(e){this.pageparm.pageNo=e.pageNo,this.pageparm.pageSize=e.pageSize,this.getTool(),document.querySelector(".el-main").scrollTo(0,0)},handleRemove:function(e,t){console.log(e,t)},handlePreview:function(e){console.log(e)},handleExceed:function(e,t){this.$message.warning("当前限制选择文件个数，本次选择了 "+e.length+" 个文件，共选择了 "+(e.length+t.length)+" 个文件")},beforeRemove:function(e,t){return this.$confirm("确定移除 "+e.name+"？")},handleSuccess:function(){this.getTool(),this.$message.success("导入成功")},handleError:function(){this.getTool(),this.$message.error("导入格式错误，请修改后重新导入！")},deleteById:function(e){var t=this;this.$confirm("此操作将永久删除, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:c+"/tool/deletetoolid",params:{id:e.id}}).then(function(e){t.$message({message:"删除成功",type:"success"}),t.getTool()}).catch(function(e){console.log(e)})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},changeType:function(e,t){var a=this,l=1==t?"计量":"仪器";this.$confirm("此操作将该数据转移到"+l+"列表, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:c+"/tool/changetooltype",params:{id:e,type:t}}).then(function(e){a.$message({message:"已转移到"+l+"列表",type:"success"}),a.getTool()}).catch(function(e){console.log(e)})}).catch(function(){a.$message({type:"info",message:"已取消转移"})})},exportExcel:function(){this.becomeTimeList.length&&(this.pageparm.startBecometime=this.getYMDHMS(new Date(this.becomeTimeList[0].toString())),this.pageparm.endBecometime=this.getYMDHMS(new Date(this.becomeTimeList[1].toString())));var e=c+"/tool/exportinsulation?";for(var t in this.pageparm)this.pageparm[t]&&(e+=t+"="+this.pageparm[t]+"&");console.log(e),s.a.get(e).then(function(t){console.log(e),window.location.href=e})},handleSelectionChange:function(e){this.multipleSelection=e},toggleSelection:function(){var e=this,t=this.multipleSelection.length;if(this.multipleSelection.length){var a=[];this.multipleSelection.map(function(e){a.push(e.id)}),console.log(a),this.$confirm("此操作将永久删除已选中的"+t+"条数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)({url:c+"/tool/deleteids",method:"post",data:{ids:a}}).then(function(t){e.$message({message:"删除成功",type:"success"}),e.getTool()}).catch(function(e){console.log(e)})}).catch(function(){e.$message({type:"info",message:"已取消删除"})})}else this.$message({message:"没有选择数据，请重新选择！",type:"warning"})}}},Dt={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[[a("el-upload",{staticClass:"upload-demo",attrs:{action:e.baseURL+"/tool/import","on-preview":e.handlePreview,"on-remove":e.handleRemove,"before-remove":e.beforeRemove,multiple:"","on-exceed":e.handleExceed,"on-success":e.handleSuccess,"on-error":e.handleError}},[a("el-button",{attrs:{size:"small",type:"warning",icon:"el-icon-star-on"}},[e._v("导入")])],1),e._v(" "),a("br"),a("br"),e._v(" "),a("el-form",{ref:"searchForm",staticClass:"user-search",attrs:{inline:!0,model:e.pageparm}},[a("el-form-item",{attrs:{label:"名称：",prop:"name"}},[a("el-input",{attrs:{size:"small",placeholder:"输入绝缘用品名称"},model:{value:e.pageparm.name,callback:function(t){e.$set(e.pageparm,"name",t)},expression:"pageparm.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"DC编号：",prop:"number"}},[a("el-input",{attrs:{size:"small",placeholder:"输入绝缘用品DC编号"},model:{value:e.pageparm.number,callback:function(t){e.$set(e.pageparm,"number",t)},expression:"pageparm.number"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"供电编号：",prop:"survey"}},[a("el-input",{attrs:{size:"small",placeholder:"输入绝缘用品供电编号"},model:{value:e.pageparm.survey,callback:function(t){e.$set(e.pageparm,"survey",t)},expression:"pageparm.survey"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"存放位置：",prop:"position"}},[a("el-input",{attrs:{size:"small",placeholder:"输入绝缘用品存放位置"},model:{value:e.pageparm.position,callback:function(t){e.$set(e.pageparm,"position",t)},expression:"pageparm.position"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"到期日期："}},[a("el-col",{attrs:{span:11}},[a("el-date-picker",{attrs:{size:"small",type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.becomeTimeList,callback:function(t){e.becomeTimeList=t},expression:"becomeTimeList"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"距离下次送检日期：",prop:"nextday"}},[a("el-select",{attrs:{placeholder:"请选择下次送检天数"},model:{value:e.pageparm.nextday,callback:function(t){e.$set(e.pageparm,"nextday",t)},expression:"pageparm.nextday"}},e._l(e.options,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"备注：",prop:"note"}},[a("el-input",{attrs:{size:"small",placeholder:"输入绝缘用品备注"},model:{value:e.pageparm.note,callback:function(t){e.$set(e.pageparm,"note",t)},expression:"pageparm.note"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-search"},on:{click:function(t){return e.getTool()}}},[e._v("搜索")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-refresh-right"},on:{click:function(t){return e.resetForm("searchForm")}}},[e._v("重置")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-plus"},on:{click:function(t){return e.handleEdit()}}},[e._v("添加")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"warning",icon:"el-icon-star-off"},on:{click:function(t){return e.exportExcel()}}},[e._v("导出")])],1)],1),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.toolData,stripe:"",height:"800","cell-style":e.rowStyle},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{ref:"multipleTable",attrs:{type:"selection",width:"55"}}),e._v(" "),a("el-table-column",{attrs:{type:"index",label:"序号",align:"center",width:"70",index:e.indexMethod,fixed:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"名称",width:"",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"number",label:"DC编号",width:"",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                    "+e._s("null"==t.row.number?"":t.row.number)+"\n                ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"survey",label:"供电编号",width:"",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                    "+e._s("null"==t.row.survey?"":t.row.survey)+"\n                ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"position",label:"存放位置",width:"",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"currentime",label:"当前日期",width:"",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"becometime",label:"到期日期",width:"",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"nextday",label:"距离下次送检日期",width:"",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"note",label:"备注",width:"",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                    "+e._s("null"==t.row.note?"":t.row.note)+"\n                ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"",label:"操作",width:"130",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",icon:"el-icon-edit",circle:""},on:{click:function(a){return e.handleEdit(t.$index,t.row)}}}),e._v(" "),a("el-button",{attrs:{type:"text",icon:"el-icon-delete",circle:""},on:{click:function(a){return e.deleteById(t.row)}}}),e._v(" "),a("el-popover",{attrs:{placement:"top-start",title:"",width:"",trigger:"click"}},[a("el-button",{attrs:{type:"text",icon:"",circle:""},on:{click:function(a){return e.changeType(t.row.id,1)}}},[a("i",{staticClass:"el-icon-top"}),e._v("计量\n                        ")]),e._v(" "),a("el-button",{attrs:{type:"text",icon:"",circle:""},on:{click:function(a){return e.changeType(t.row.id,3)}}},[a("i",{staticClass:"el-icon-top"}),e._v("仪器\n                        ")]),e._v(" "),a("el-button",{attrs:{slot:"reference",type:"text",circle:""},slot:"reference"},[a("i",{staticClass:"el-icon-top",staticStyle:{padding:"9px"}})])],1)]}}])})],1),e._v(" "),a("div",{staticClass:"bottom"},[a("Pagination",{attrs:{"child-msg":e.pageparm,total:e.total},on:{callFather:e.callFather}}),e._v(" "),a("el-button",{attrs:{size:"small",type:"danger"},on:{click:function(t){return e.toggleSelection()}}},[e._v("删除")])],1),e._v(" "),a("el-dialog",{attrs:{title:e.title,visible:e.editFormVisible,width:"40%","close-on-click-modal":!1},on:{"update:visible":function(t){e.editFormVisible=t}}},[a("el-form",{ref:"editForm",attrs:{"label-width":"120px",model:e.editForm,rules:e.rules}},[a("el-form-item",{attrs:{label:"名称",prop:"name"}},[a("el-input",{attrs:{"auto-complete":"off",placeholder:"请输入名称"},model:{value:e.editForm.name,callback:function(t){e.$set(e.editForm,"name",t)},expression:"editForm.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"DC编号",prop:"number"}},[a("el-input",{attrs:{"auto-complete":"off",placeholder:"请输入DC编号"},model:{value:e.editForm.number,callback:function(t){e.$set(e.editForm,"number",t)},expression:"editForm.number"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"供电编号",prop:"survey"}},[a("el-input",{attrs:{"auto-complete":"off",placeholder:"请输入供电编号"},model:{value:e.editForm.survey,callback:function(t){e.$set(e.editForm,"survey",t)},expression:"editForm.survey"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"存放位置",prop:"position"}},[a("el-input",{attrs:{"auto-complete":"off",placeholder:"请输入存放位置"},model:{value:e.editForm.position,callback:function(t){e.$set(e.editForm,"position",t)},expression:"editForm.position"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"到期日期",prop:"becometime"}},[a("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",type:"date",placeholder:"选择日期"},model:{value:e.editForm.becometime,callback:function(t){e.$set(e.editForm,"becometime",t)},expression:"editForm.becometime"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"备注",prop:"note"}},[a("el-input",{attrs:{size:"small","auto-complete":"off",placeholder:"请输入备注"},model:{value:e.editForm.note,callback:function(t){e.$set(e.editForm,"note",t)},expression:"editForm.note"}})],1)],1),e._v(" "),a("span",{staticStyle:{color:"brown","font-size":"12px"}},[e._v("若无需说明 请填写“无”")]),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){return e.closeDialog("editForm")}}},[e._v("取消")]),e._v(" "),a("el-button",{staticClass:"title",attrs:{size:"small",type:"primary"},on:{click:function(t){return e.handelTool("editForm")}}},[e._v("保存")])],1)],1)]],2)},staticRenderFns:[]};var Vt=a("VU/8")(St,Dt,!1,function(e){a("Yym2")},"data-v-aa78ab26",null).exports;l.default.use(n.a);var Lt=new n.a({routes:[{path:"/",name:"Login",component:p},{path:"/index",name:"Index",component:_,iconCls:"el-icon-tickets",children:[{path:"/tool/metering",name:"计量用品列表",component:xt,meta:{requireAuth:!0,title:"计量用品列表"}},{path:"/tool/insulation",name:"绝缘用品列表",component:Vt,meta:{requireAuth:!0,title:"绝缘用品列表"}},{path:"/tool/secure",name:"仪器用品列表",component:Tt,meta:{requireAuth:!0,title:"仪器用品列表"}},{path:"/technician/fault",name:"故障遗留列表",component:B,meta:{requireAuth:!0,title:"故障遗留列表"}},{path:"/technician/senior",name:"高级修列表",component:M,meta:{requireAuth:!0,title:"高级修列表"}},{path:"/technician/track",name:"故障追踪列表",component:j,meta:{requireAuth:!0,title:"故障追踪列表"}},{path:"/technician/faultcarnumber",name:"故障库",component:P,meta:{requireAuth:!0,title:"故障库"}},{path:"/technician/faultcarnumberdetail",name:"故障库详情",component:Y,meta:{requireAuth:!0,title:"故障库详情"}},{path:"/technician/faultdecoration",name:"车内装饰类故障列表",component:ce,meta:{requireAuth:!0,title:"车内装饰类故障列表"}},{path:"/teams/faultdecorationcheck",name:"车内装饰类故障查看",component:pe,meta:{requireAuth:!0,title:"车内装饰类故障查看"}},{path:"/technician/fault/rich",name:"故障富文本",component:le,meta:{requireAuth:!0,title:"故障编辑"}},{path:"/technician/fault/richcheck",name:"故障富文本查看",component:ie,meta:{requireAuth:!0,title:"故障信息查看"}},{path:"/teams/faultcheck",name:"故障查看",component:ge,meta:{requireAuth:!0,title:"故障查看"}},{path:"/teams/seniorfaultcheck",name:"高级修查看",component:ve,meta:{requireAuth:!0,title:"高级修查看"}},{path:"/teams/trackfaultcheck",name:"故障追踪查看",component:Ne,meta:{requireAuth:!0,title:"故障追踪查看"}},{path:"/special/index",name:"专项列表",component:De,meta:{requireAuth:!0,title:"专项列表"}},{path:"/teams/index",name:"班组管理",component:tt,meta:{requireAuth:!0,title:"班组管理"}},{path:"/teams/check",name:"班组查看",component:rt,meta:{requireAuth:!0,title:"班组管理"}},{path:"/source/qualitysquare",name:"源头质量（四方）",component:Me,meta:{requireAuth:!0,title:"源头质量（四方）"}},{path:"/source/qualitylong",name:"源头质量（长客）",component:Re,meta:{requireAuth:!0,title:"源头质量（长客）"}},{path:"/source/qualityconcent",name:"源头质量（动集）",component:We,meta:{requireAuth:!0,title:"源头质量（动集）"}},{path:"/source/technologysquare",name:"技术改造（四方）",component:Pe,meta:{requireAuth:!0,title:"技术改造（四方）"}},{path:"/source/technologylong",name:"技术改造（长客）",component:Ye,meta:{requireAuth:!0,title:"技术改造（长客）"}},{path:"/source/technologyconcent",name:"技术改造（动集）",component:Ze,meta:{requireAuth:!0,title:"技术改造（动集）"}},{path:"/source/qualitysquarecheck",name:"查看源头质量（四方）",component:nt,meta:{requireAuth:!0,title:"源头质量（四方）"}},{path:"/source/qualitylongcheck",name:"查看源头质量（长客）",component:ut,meta:{requireAuth:!0,title:"源头质量（长客）"}},{path:"/source/qualityconcentcheck",name:"查看源头质量（动集）",component:_t,meta:{requireAuth:!0,title:"源头质量（动集）"}},{path:"/source/technologysquarecheck",name:"查看技术改造（四方）",component:dt,meta:{requireAuth:!0,title:"技术改造（四方）"}},{path:"/source/technologylongcheck",name:"查看技术改造（长客）",component:ft,meta:{requireAuth:!0,title:"技术改造（长客）"}},{path:"/source/technologyconcentcheck",name:"查看技术改造（动集）",component:Ft,meta:{requireAuth:!0,title:"技术改造（动集）"}},{path:"/tedsfault/fault",name:"TEDS故障列表",component:ke,meta:{requireAuth:!0,title:"TEDS故障列表"}},{path:"/tedsfault/senior",name:"TEDS高级修列表",component:Ce,meta:{requireAuth:!0,title:"TEDS高级修列表"}}]}]});Lt.beforeEach(function(e,t,a){var l=e.meta.title||"太原动车所技术管理系统";if(document.title=l,e.meta.requireAuth){var r=localStorage.getItem("roleId");(r=r&&r.trim())?a():a({name:"Login",query:{redirect:e.name}})}else a()});var Bt=Lt,It=a("zL8q"),zt=a.n(It);a("tvR6");l.default.prototype.$axios=s.a,l.default.config.productionTip=!1,l.default.use(zt.a),new l.default({el:"#app",router:Bt,components:{App:i},template:"<App/>"})},O8oN:function(e,t){},RXzw:function(e,t){},RbNT:function(e,t){},T93X:function(e,t){},TwP2:function(e,t){},"WEA+":function(e,t){},XxQX:function(e,t){},Yym2:function(e,t){},Zbei:function(e,t){},ac32:function(e,t){},"dLd/":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAGUUlEQVRoQ+2YdYildRSGn2Pr2t0tdreo2CgqdmN3r93dXdiN3YGCYGC3otiKun/YsSrmquuRZzmz3B13nDsz986O4IHLwHzf/e55z+8973nPF/zHI/7j+fM/gP46wcycGVgPuCEifs7MsSNi+IA/gcycAzgCWAlYPSI+y8z5AQG8OWABZOa8wFHA1sCXwIoR8XElvxpwe0R8PeAAZObCwDHAJsBYwLfAyhHxdmbOA6wNDIqI06XvgAGQmUsBxwLrN/TVj8BqEfFyZs4JrANMWPQ5Y0AAqMRPAdbqJAi/We2IeCIzZwQ2M3FgEuDziLhijALIzBWLKp0TN68/gQ0j4sHMnArYGZgASGAc4JWIuH+MAMjMNYGj5XUXEvwXsE1E3JqZVnvfovqkwK/AuMB9EfFivwLITDXc5lzmX2aHye8VEZdnphU/tO6V9z8VfSYDDnYWtB1AZqoiG1fFF21i6O1RyUuTM6viJj4t8BkwKzAsIg7ueFZbVMgpCWwFHAk4dJqJI5TGAn0+8FXx3n6QPsbvwDcRcXZbAGSm/NweOByYq5ms654zIsLvkJnnAu8BU5RkSqVhpUBTVgNf1VIAxdddirOz9CBxb70sIvas5E8FhgBOYRP/AZgY+AWYHJD3T0XEvS0BkJmDgD1sKmD6Hibu7beU4mRmegJyf76ij9y3qccrEH8AUwOnRcS7fQJQiQ8GDgDU6d7EA6X1wzPTflFejWcBp66Vnw74tE5j/JLQHSJCYCOiR02cmUrYPn1M3N99vKbssJLXvYCnge+BdYGhTlsbtkCYp4D+ighPfGQ0BSAzbR6r7VARRF/ipfI3P2XmKsCFwAmVuBR6AZgBWAT4pGhjD+iLtNCCbQ5AZnqE8tsmk+99jbfKWQ7NzKWB26qHjgeuAxQAB937wDvAbNW8DrLhgouIy7oFUNvPYYDKohq0Ij4qT/95Zi4IPATsWAPLBtZd2hfqv1ba+9V9lUgA5nFNRDzfJYCG7Uctt/tbFU7RjoXEBn0CUAQ0aXfU30uBXYEvgCeBhYAlCpAgbOLdIsI+GZVCmTkRcBGwU6sybniODelC8lbZ4qeAK+u6kqnuq/FaDQfUQYBGzWEmWGlkr04TEct1zm9kE2emOr57fWyiVkTjQqLcWnmTs+p6HRXtcuA8YNUCckNR1+n7clVe4Zg1ItzGRol/qFDZgY1KcfTsvY3GhURb/GjJpGr2cG1etwP7F4gDAfvO/znEpJe78Kt1AtFhN7pt4o4baj9VhbaoSjQLpnEhURpNWClW4x8BtAwrNDxM3q9RQPy9+2qp2bRc6AfAM+4I3Z7A6DLMTEe4iqScamn/LRoXEu30jTVlbUjpokQ+U7TZErgeOK4+Umn2Wh8vqd9yY3OoabVHWoiOBJoaZA0nok126Za7q3eBYoSn91pmqiwqmvdu4AAriXy9CqLdPgdwJz6xZo4gVCPV5jFggTq56RotRK8ANCZc720EYoJy3Bjh6St5/x4CbF4mzQG0eJ3Cd4B6LjU9AZVH/m9Xz3muliALYD9sHBGLja5gPTqBLuhl8g6k8SPirErewXRa2Q+VR8po2FS3kwEthEnaEzatk3gHwF3g2vqem5zKeI9LUURIt39EnwF0fmJmarasnDSyqm8AdwNXV9L2ksmoUq8B+xU4Oa+ECs5rApdiDwLvdpxsr5q4WempdVDDN3fRwsVDATApKaM90POoJkuWdbaBHVBedzpLvQuqH+wdh93giNB69MsJ+D7n3lIu5dKPp7J3OUxtwk2ViZx3ODmdtwXurAb2Za6AlE+be6aIUGr7BYAvn1QQK31BRAzJTLVdKfTdpnbYyjqRTdQKdxhGLYX0MdkNAZf7wyOiy22vHT0ggMZweRGMw8lhNlNVXSBK5IeAk/+uklZfGUpDVUuJXWp0FqLPMtpVX7jcdnHNU7EnPJXXMlMg+p/dqslPKqpdXK/VfRfqadjA9sZooz9OoPMPexLutSNtcWY64HSjyzbQyWHnKR3TeYlpfGB/A7D6XVazXqHrWm8utyqdlu+8xIwpADtGhL3QbdR+4kLjfrBMREilMUYht6lV5H23mffihnZTSB47F9y62hLtBKAVMPlRdthWo2gXgOsjQnPW9mgHACWyqWZtBbqWA2hFUj15xv8AelKtdtz7N3tXKk830y/qAAAAAElFTkSuQmCC"},dxWL:function(e,t){},dyro:function(e,t){},"f/9h":function(e,t){},gQKk:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAA/0lEQVRYR+2W6w2CQBCEZyqRDrQEO9ASLAE7sAO1A+kAK1A7wA6wA61gzSVH4uPgbgMHJrK/l5kv++KIgYMD+2ME+KqAiKQAFpFacyS5e9V2ASwBzCIBFCTzRoBIxrWy4xCOFWhVARFJAEwUg3sjWfrW0Kxg8rkuLhN7M7YKgIzkygcwB3ACcAawJlkoDNSprkNUAVRiBwtyV6sHfBACYGSM+YbkPkBTlRIK8LAAb3dc5VSTHAKQAUhJ9t6CizXufQiHXUNNX+0hMscoNErvIQpV6iqv1SnuAmIE+L0KiIh5lE676K9D4+p9lNpfrIGIEbn3WR7DtUnz92bg7yrwBOSXVCGtUZf9AAAAAElFTkSuQmCC"},hAkL:function(e,t){},jZWA:function(e,t){},kuU9:function(e,t){},oeTE:function(e,t){},oudr:function(e,t){},qnhG:function(e,t){},rWRm:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAA80lEQVRYR+1W2xVBMRCcqYAO6IASqIASdEAHdEALOrg6UAIdUMk4e04+4rivuJL4yH4nO7OzTyKzMTM+CoEPBSTtAKwipeZC8uT7riOwBjCPROBGsmolEAm40W0pwqLAIAUkTQFMAgr3SfLxVRdIWgB4+A7czDgGEDiT3AQRcFEaiM2HJclrAGDn08YUSBoD2AI4eF7SEJBkMlnURsK3pARsZo+yEDBQlwJbTPvkKfCjdkVoatiGTJOCutLN1oZtfeTUsWHU197miH0aNAn7ora9KwSKAk1H6ewXBVbj4955lLoVa5svhlWdZ3kM1NKGf63ACzUdUCHpu3IjAAAAAElFTkSuQmCC"},tuiz:function(e,t){},tvR6:function(e,t){},ujId:function(e,t){},vFDb:function(e,t){},"vIe/":function(e,t){},vyVH:function(e,t){},vyqo:function(e,t){},xRMN:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.fe4e95e45793f683c9e7.js.map